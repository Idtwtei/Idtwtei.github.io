<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ğŸ˜­â¤ï¸âŒ P6792 [SNOI2020] åŒºé—´å’Œ</title>
      <link href="/solutions/P6792/"/>
      <url>/solutions/P6792/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç»´æŠ¤ä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ— $a$ï¼Œæ”¯æŒåŒºé—´å– $\max$ï¼ŒæŸ¥è¯¢åŒºé—´æœ€å¤§å­æ®µå’Œã€‚</p><p>$1 \le n \le 10^5,1 \le q \le 2 \times 10^5,0 \le |a_i|,|x| \le 10^9$ã€‚</p></blockquote><p>éœ€è¦æŒæ¡ <a href="https://idtwtei.github.io/notes/seg_beats/">å‰å¸æœºçº¿æ®µæ ‘</a> å’Œ <a href="https://idtwtei.github.io/notes/KTT/">KTT</a>ã€‚</p><p>å•ç‚¹ä¿®æ”¹ç»´æŠ¤æœ€å¤§å­æ®µå’Œæ˜¯ç®€å•çš„ï¼Œçº¿æ®µæ ‘ç»´æŠ¤ $lm,rm,mx,sum$ åˆ†åˆ«è¡¨ç¤ºæœ€å¤§å‰ç¼€å’Œï¼Œæœ€å¤§åç¼€å’Œï¼Œæœ€å¤§å­æ®µå’Œï¼ŒåŒºé—´å’Œã€‚åˆå¹¶å°±æ˜¯åˆ†è®¨ä¸€ä¸‹ã€‚</p><p>åŒºé—´å– $\max$ï¼Œè¿˜ç»´æŠ¤ä¸€äº›å¤æ‚ä¿¡æ¯ï¼Œè€ƒè™‘å‰å¸æœºçº¿æ®µæ ‘ï¼Œé‚£ä¹ˆåªéœ€è¦è€ƒè™‘åŒºé—´åŒºé—´æœ€å°å€¼æ•´ä½“åŠ  $x$ åä¿¡æ¯çš„ç»´æŠ¤ã€‚</p><p>å‚è€ƒ <a href="https://www.luogu.com.cn/problem/P5693">åŒºé—´åŠ åŒºé—´æœ€å¤§å­æ®µå’Œ</a>ï¼Œç”¨ä¸€æ¬¡å‡½æ•°è¡¨ç¤º $lm,rm,mx,sum$ï¼Œå…¶ä¸­æ–œç‡ä¸ºå¯¹åº”èŒƒå›´å†…æœ€å°å€¼çš„ä¸ªæ•°ã€‚KTT å³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦å¤§æ¦‚æ˜¯ $O(n\log^3n)$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pli pair<span class="string">&lt;LINE,int&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> MP make_pair</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fir first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> sec second</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span><span class="number">+10</span>,INF=<span class="number">1e18</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">chkmin</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> y)</span></span>{ <span class="keyword">return</span> y&lt;x?x=y,<span class="number">1</span>:<span class="number">0</span>; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,a[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">LINE</span>{ <span class="type">int</span> k,b; <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> v)</span></span>{ b+=k*v; } };</span><br><span class="line"><span class="keyword">inline</span> LINE <span class="keyword">operator</span>+(LINE x,LINE y){ <span class="keyword">return</span> (LINE){x.k+y.k,x.b+y.b}; }</span><br><span class="line"><span class="function">pli <span class="title">mer</span><span class="params">(LINE x,LINE y)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(x.k&lt;y.k||(x.k==y.k&amp;&amp;x.b&lt;y.b)) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="keyword">return</span> x.b&gt;=y.b?<span class="built_in">MP</span>(x,INF):<span class="built_in">MP</span>(y,(y.b-x.b)/(x.k-y.k));</span><br><span class="line">}</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ADJ</span>{</span><br><span class="line">LINE lm,rm,mx,sum; <span class="type">int</span> mn,se,tim;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> v)</span></span>{ lm.<span class="built_in">add</span>(v),rm.<span class="built_in">add</span>(v),mx.<span class="built_in">add</span>(v),sum.<span class="built_in">add</span>(v),mn+=v,tim-=v; }</span><br><span class="line">};</span><br><span class="line">ADJ <span class="keyword">operator</span>+(ADJ x,ADJ y){</span><br><span class="line">ADJ res; pli tmp;</span><br><span class="line"><span class="keyword">if</span>(x.mn&lt;y.mn) res.mn=x.mn,res.se=<span class="built_in">min</span>(x.se,y.mn),res.tim=x.tim,y.lm.k=y.rm.k=y.mx.k=y.sum.k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(y.mn&lt;x.mn) res.mn=y.mn,res.se=<span class="built_in">min</span>(y.se,x.mn),res.tim=y.tim,x.lm.k=x.rm.k=x.mx.k=x.sum.k=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> res.mn=x.mn,res.se=<span class="built_in">min</span>(y.se,x.se),res.tim=<span class="built_in">min</span>(x.tim,y.tim);</span><br><span class="line">res.sum=x.sum+y.sum;</span><br><span class="line">tmp=<span class="built_in">mer</span>(x.lm,x.sum+y.lm),res.lm=tmp.fir,<span class="built_in">chkmin</span>(res.tim,tmp.sec);</span><br><span class="line">tmp=<span class="built_in">mer</span>(y.rm,y.sum+x.rm),res.rm=tmp.fir,<span class="built_in">chkmin</span>(res.tim,tmp.sec);</span><br><span class="line">tmp=<span class="built_in">mer</span>(x.mx,y.mx),<span class="built_in">chkmin</span>(res.tim,tmp.sec);</span><br><span class="line">tmp=<span class="built_in">mer</span>(tmp.fir,x.rm+y.lm),res.mx=tmp.fir,<span class="built_in">chkmin</span>(res.tim,tmp.sec);</span><br><span class="line"><span class="keyword">return</span> res;</span><br><span class="line">};</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SMT</span>{</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lc (id&lt;&lt;1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rc (id&lt;&lt;1|1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> mid (l+r&gt;&gt;1)</span></span><br><span class="line">ADJ t[N&lt;&lt;<span class="number">2</span>];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">psu</span><span class="params">(<span class="type">int</span> id)</span></span>{ t[id]=t[lc]+t[rc]; }</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> v)</span></span>{ t[id].<span class="built_in">add</span>(v); }</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">spd</span><span class="params">(<span class="type">int</span> id)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(t[id].mn&gt;t[lc].mn) <span class="built_in">add</span>(lc,t[id].mn-t[lc].mn);</span><br><span class="line"><span class="keyword">if</span>(t[id].mn&gt;t[rc].mn) <span class="built_in">add</span>(rc,t[id].mn-t[rc].mn);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rbui</span><span class="params">(<span class="type">int</span> id)</span></span>{ <span class="keyword">if</span>(t[id].tim&lt;<span class="number">0</span>) <span class="built_in">spd</span>(id),<span class="built_in">rbui</span>(lc),<span class="built_in">rbui</span>(rc),<span class="built_in">psu</span>(id); }</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bui</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(l==r) <span class="keyword">return</span> t[id]={{<span class="number">1</span>,a[l]},{<span class="number">1</span>,a[l]},{<span class="number">1</span>,a[l]},{<span class="number">1</span>,a[l]},a[l],INF,INF},<span class="built_in">void</span>();</span><br><span class="line"><span class="built_in">bui</span>(lc,l,mid),<span class="built_in">bui</span>(rc,mid<span class="number">+1</span>,r),<span class="built_in">psu</span>(id);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> ql,<span class="type">int</span> qr,<span class="type">int</span> v)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(v&lt;=t[id].mn) <span class="keyword">return</span>; <span class="keyword">if</span>(ql&lt;=l&amp;&amp;r&lt;=qr&amp;&amp;t[id].mn&lt;v&amp;&amp;v&lt;t[id].se) <span class="keyword">return</span> <span class="built_in">add</span>(id,v-t[id].mn),<span class="built_in">rbui</span>(id); <span class="built_in">spd</span>(id);</span><br><span class="line"><span class="keyword">if</span>(ql&lt;=mid) <span class="built_in">add</span>(lc,l,mid,ql,qr,v);</span><br><span class="line"><span class="keyword">if</span>(qr&gt;mid) <span class="built_in">add</span>(rc,mid<span class="number">+1</span>,r,ql,qr,v);</span><br><span class="line"><span class="built_in">psu</span>(id);</span><br><span class="line">}</span><br><span class="line"><span class="function">ADJ <span class="title">ask</span><span class="params">(<span class="type">int</span> id,<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> ql,<span class="type">int</span> qr)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(ql&lt;=l&amp;&amp;r&lt;=qr) <span class="keyword">return</span> t[id]; <span class="built_in">spd</span>(id);</span><br><span class="line"><span class="keyword">if</span>(qr&lt;=mid) <span class="keyword">return</span> <span class="built_in">ask</span>(lc,l,mid,ql,qr);</span><br><span class="line"><span class="keyword">if</span>(ql&gt;mid) <span class="keyword">return</span> <span class="built_in">ask</span>(rc,mid<span class="number">+1</span>,r,ql,qr);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">ask</span>(lc,l,mid,ql,qr)+<span class="built_in">ask</span>(rc,mid<span class="number">+1</span>,r,ql,qr);</span><br><span class="line">}</span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> lc</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> rc</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> mid</span></span><br><span class="line">}S;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=rd;</span><br><span class="line"></span><br><span class="line">S.<span class="built_in">bui</span>(<span class="number">1</span>,<span class="number">1</span>,n);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,op,l,r,x;i&lt;=m;++i){</span><br><span class="line">op=rd,l=rd,r=rd; <span class="keyword">if</span>(op==<span class="number">0</span>) x=rd;</span><br><span class="line"><span class="keyword">if</span>(op==<span class="number">0</span>) S.<span class="built_in">add</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r,x);</span><br><span class="line"><span class="keyword">else</span> <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, <span class="built_in">max</span>(<span class="number">0ll</span>,S.<span class="built_in">ask</span>(<span class="number">1</span>,<span class="number">1</span>,n,l,r).mx.b));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">cerr&lt;&lt;<span class="built_in">clock</span>()&lt;&lt;<span class="string">"ms\n"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜±â¤ï¸âŒ LOJ 2731 ã€ŒJOISC 2016 Day 1ã€æ£‹ç›˜æ¸¸æˆ</title>
      <link href="/solutions/LOJ2731/"/>
      <url>/solutions/LOJ2731/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä¸€å¼  $3 \times n$ æ£‹ç›˜ï¼Œæ¯ä¸ªæ ¼å­ä¸Šæ”¾ç½®äº† $0/1$ ä¸ªæ£‹å­ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸€ä¸ªä¸Šä¸‹æˆ–å·¦å³å‡æœ‰æ£‹å­çš„ä½ç½®æ”¾ç½®æ£‹å­ï¼Œæœ€åæ”¾æ»¡æ•´ä¸ªæ£‹ç›˜ï¼Œæ±‚æ”¾ç½®çš„æ–¹æ¡ˆæ•°ï¼Œå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><p>$1 \le n \le 2 \times 10^3$ã€‚</p></blockquote><p>è€ƒè™‘ä»€ä¹ˆæ ·çš„æ£‹ç›˜å¯ä»¥æ”¾æ»¡ï¼Œå››ä¸ªè§’å¿…é¡»æœ‰æ£‹å­ï¼Œç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œåªèƒ½é€šè¿‡å·¦å³æœ‰æ£‹å­çš„æ–¹å¼æ”¾ç½®ï¼Œé‚£ä¹ˆä¸èƒ½æœ‰ä¸¤ä¸ªè¿ç»­çš„ç©ºä½ã€‚æ˜“è¯è¿™æ˜¯å……è¦çš„ã€‚å…ˆåˆ¤æ–­ï¼Œä¸èƒ½æ”¾æ»¡è¾“å‡º $0$ã€‚</p><p>ç¬¬ä¸€è¡Œå’Œç¬¬ä¸‰è¡Œçš„ç©ºä½å¯ä»¥åœ¨ä»»æ„æ—¶åˆ»æ”¾ç½®ï¼Œåªéœ€è€ƒè™‘ä¸­é—´çš„ç©ºä½ã€‚å¯¹äºä¸­é—´æœ‰æ£‹å­çš„ï¼Œå®ƒçš„å·¦å³ä¸¤è¾¹æ˜¯ç‹¬ç«‹çš„ï¼Œåˆ†å¼€è®¡ç®—æœ€åè®¡ç®—æ’åˆ—å³å¯ï¼Œæ‰€ä»¥åªéœ€è€ƒè™‘ä¸­é—´éƒ½æ˜¯ç©ºçš„è¿ç»­æ®µã€‚</p><p>æ˜¾ç„¶è¦ DPï¼Œè€ƒè™‘è®°å½•ä¸­é—´çš„ç©ºä½æ”¾ç½®çš„æ—¶åˆ»å’Œæ”¾ç½®æ–¹å¼ï¼Œè®° $f(i,j,0/1)$ ä¸ºæšä¸¾åˆ°ç¬¬ $i$ åˆ—ï¼Œä¸­é—´çš„ç©ºä½åœ¨ $j$ æ—¶æ”¾ç½®ï¼Œæ”¾ç½®æ–¹å¼ä¸ºä¸Šä¸‹/å·¦å³ã€‚</p><p>è½¬ç§»æœ‰ $0 \gets 0,0 \gets 1,1 \gets 0$ ä¸‰ç§æƒ…å†µï¼Œè®° $c$ ä¸ºç¬¬ $i$ åˆ—ä¸Šä¸‹çš„ç©ºæ ¼æ•°ï¼Œ$cnt_i$ ä¸º $i$ åˆ—åŠä»¥å‰çš„ç©ºæ ¼æ•°ï¼Œä¸ºä¸ç®—é‡å¼ºåˆ¶èƒ½ä¸Šä¸‹æ”¾å°±ä¸Šä¸‹æ”¾ã€‚</p><script type="math/tex; mode=display">f(i,j,0) \gets c! \binom{j-1}{c} \sum f(i-1,j',0) \\f(i,j,0) \gets c! \binom{j-1}{c} \sum_{j'+c \ge j} f(i-1,j',1) \\f(i,j+x,1) \gets c! \binom{j+x-1}{j-1} \binom{cnt_i-j-x}{c-x} \sum_{j' < j} f(i-1,j',0) \quad \texttt{for} \quad x \in [0,c)</script><p>å…¶ä¸­ç¬¬ä¸‰ç§æƒ…å†µçš„æ€è€ƒæ–¹å¼æ˜¯å…ˆæ”¾å…¥ä¸­é—´çš„ç©ºæ ¼ï¼Œå†æ”¾å…¥ä¸Šä¸‹çš„ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e3</span><span class="number">+10</span>,INF=<span class="number">1e9</span>,MOD=<span class="number">1e9</span><span class="number">+7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mod</span><span class="params">(<span class="type">int</span> &amp;x)</span></span>{ <span class="keyword">if</span>(x&gt;=MOD) x-=MOD; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x+=MOD; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y=MOD<span class="number">-2</span>)</span></span>{ <span class="type">int</span> res=<span class="number">1</span>; <span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=<span class="number">1ll</span>*x*x%MOD) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="number">1ll</span>*res*x%MOD; <span class="keyword">return</span> res; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line">    <span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> jc[N*<span class="number">3</span>],fjc[N*<span class="number">3</span>];</span><br><span class="line"><span class="keyword">inline</span> <span class="type">void</span> _init(<span class="type">int</span> n){</span><br><span class="line">    jc[<span class="number">0</span>]=<span class="number">1</span>; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) jc[i]=<span class="number">1ll</span>*jc[i<span class="number">-1</span>]*i%MOD;</span><br><span class="line">    fjc[n]=<span class="built_in">qm</span>(jc[n]); <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;~i;--i) fjc[i]=<span class="number">1ll</span>*fjc[i<span class="number">+1</span>]*(i<span class="number">+1</span>)%MOD;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">C</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span>{ <span class="keyword">return</span> m&gt;n||n&lt;<span class="number">0</span>||m&lt;<span class="number">0</span>?<span class="number">0</span>:<span class="number">1ll</span>*jc[n]*fjc[m]%MOD*fjc[n-m]%MOD; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">P</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span>{ <span class="keyword">return</span> m&gt;n||n&lt;<span class="number">0</span>||m&lt;<span class="number">0</span>?<span class="number">0</span>:<span class="number">1ll</span>*jc[n]*fjc[n-m]%MOD; }</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,all=<span class="number">0</span>,f[N*<span class="number">3</span>][<span class="number">2</span>],g[N*<span class="number">3</span>][<span class="number">2</span>],ans=<span class="number">1</span>,cnt=<span class="number">0</span>; <span class="type">char</span> s[<span class="number">3</span>][N];</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">chk</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(s[<span class="number">0</span>][<span class="number">1</span>]==<span class="string">'x'</span>||s[<span class="number">2</span>][<span class="number">1</span>]==<span class="string">'x'</span>||s[<span class="number">0</span>][n]==<span class="string">'x'</span>||s[<span class="number">2</span>][n]==<span class="string">'x'</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;++i){</span><br><span class="line">        <span class="keyword">if</span>(s[<span class="number">0</span>][i]==<span class="string">'x'</span>&amp;&amp;s[<span class="number">0</span>][i<span class="number">+1</span>]==<span class="string">'x'</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(s[<span class="number">2</span>][i]==<span class="string">'x'</span>&amp;&amp;s[<span class="number">2</span>][i<span class="number">+1</span>]==<span class="string">'x'</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    all=(s[<span class="number">0</span>][i]==<span class="string">'x'</span>)+(s[<span class="number">2</span>][i]==<span class="string">'x'</span>)<span class="number">+1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=all;++j) f[j][<span class="number">0</span>]=f[j][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    f[all][<span class="number">0</span>]=jc[all<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;all;++i) f[i][<span class="number">1</span>]=jc[all<span class="number">-1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=all;++j) <span class="built_in">mod</span>(g[j][<span class="number">0</span>]=g[j<span class="number">-1</span>][<span class="number">0</span>]+f[j][<span class="number">0</span>]),<span class="built_in">mod</span>(g[j][<span class="number">1</span>]=g[j<span class="number">-1</span>][<span class="number">1</span>]+f[j][<span class="number">1</span>]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get</span><span class="params">(<span class="type">int</span> i)</span></span>{</span><br><span class="line">    <span class="type">int</span> c=(s[<span class="number">0</span>][i]==<span class="string">'x'</span>)+(s[<span class="number">2</span>][i]==<span class="string">'x'</span>); all+=c<span class="number">+1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=all;++j) f[j][<span class="number">0</span>]=f[j][<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=c<span class="number">+1</span>;j&lt;=all;++j) <span class="built_in">mod</span>(f[j][<span class="number">0</span>]+=<span class="number">1ll</span>*<span class="built_in">P</span>(j<span class="number">-1</span>,c)*g[all-c<span class="number">-1</span>][<span class="number">0</span>]%MOD);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=c<span class="number">+1</span>;j&lt;=all;++j) <span class="built_in">mod</span>(f[j][<span class="number">0</span>]+=<span class="number">1ll</span>*<span class="built_in">P</span>(j<span class="number">-1</span>,c)*(g[all-c<span class="number">-1</span>][<span class="number">1</span>]-g[j-c<span class="number">-1</span>][<span class="number">1</span>])%MOD);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> x=<span class="number">0</span>;x&lt;c;++x) <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=all-c;++j) <span class="built_in">mod</span>(f[j+x][<span class="number">1</span>]+=<span class="number">1ll</span>*jc[c]*<span class="built_in">C</span>(j+x<span class="number">-1</span>,j<span class="number">-1</span>)%MOD*<span class="built_in">C</span>(all-j-x,c-x)%MOD*g[j<span class="number">-1</span>][<span class="number">0</span>]%MOD);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=all;++j) <span class="built_in">mod</span>(g[j][<span class="number">0</span>]=g[j<span class="number">-1</span>][<span class="number">0</span>]+f[j][<span class="number">0</span>]),<span class="built_in">mod</span>(g[j][<span class="number">1</span>]=g[j<span class="number">-1</span>][<span class="number">1</span>]+f[j][<span class="number">1</span>]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    n=rd,<span class="built_in">scanf</span>(<span class="string">"%s %s %s"</span>, s[<span class="number">0</span>]<span class="number">+1</span>, s[<span class="number">1</span>]<span class="number">+1</span>, s[<span class="number">2</span>]<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">if</span>(!<span class="built_in">chk</span>()) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"0\n"</span>),<span class="number">0</span>; _init(n*<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,j;i&lt;=n;i=j){</span><br><span class="line">        <span class="keyword">if</span>(s[<span class="number">1</span>][i]==<span class="string">'o'</span>) cnt+=(s[<span class="number">0</span>][i]==<span class="string">'x'</span>)+(s[<span class="number">2</span>][i]==<span class="string">'x'</span>),j=i<span class="number">+1</span>;</span><br><span class="line">        <span class="keyword">else</span>{</span><br><span class="line">            <span class="keyword">for</span>(j=i;j&lt;=n&amp;&amp;s[<span class="number">1</span>][j]==s[<span class="number">1</span>][i];++j);</span><br><span class="line">            <span class="built_in">init</span>(i); <span class="keyword">for</span>(<span class="type">int</span> k=i<span class="number">+1</span>;k&lt;j;++k) <span class="built_in">get</span>(k);</span><br><span class="line">            ans=<span class="number">1ll</span>*(g[all][<span class="number">0</span>]+g[all][<span class="number">1</span>])%MOD*ans%MOD*fjc[all]%MOD,cnt+=all;</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    ans=<span class="number">1ll</span>*ans*jc[cnt]%MOD;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ”¯é…æ ‘</title>
      <link href="/notes/dom/"/>
      <url>/notes/dom/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¯¹äºæœ‰å‘å›¾ $G=(V,E)$ï¼Œåœ¨ç»™å®šæºç‚¹ $s \in V$ï¼ˆ$s$ å¯è¾¾ $V$ ä¸­å…¶ä»–èŠ‚ç‚¹ï¼‰çš„æƒ…å†µä¸‹ï¼Œè‹¥ä»»æ„ $s \to y$ çš„è·¯å¾„éƒ½ç»è¿‡ $x$ï¼Œåˆ™ç§° $x$ æ”¯é… $y$ï¼Œ$x$ æ˜¯ $y$ çš„æ”¯é…ç‚¹ï¼Œè®°ä½œ $x=dom_y$ã€‚æ”¯é…å…³ç³»æ»¡è¶³ä¼ é€’æ€§ã€è‡ªåæ€§ã€åå¯¹ç§°æ€§ï¼Œæ˜¯ååºå…³ç³»ï¼Œååºå…³ç³»å¯ä»¥ç”¨ DAG åˆ»ç”»ã€‚</p><p>æ”¯é…å…³ç³»è¿˜æ»¡è¶³è‹¥ $x = dom_z,y = dom_z$ åˆ™ $x=dom_y$ æˆ– $y = dom_x$ã€‚æ»¡è¶³è¿™ä¸ªæ€§è´¨çš„ååºå…³ç³»å¯ä»¥ç”¨æ ‘åˆ»ç”»ã€‚è®° $idom_x$ ä¸º $x$ çš„ç›´æ¥æ”¯é…ç‚¹ï¼ˆä¸ä¸º $x$ï¼‰ï¼Œæ»¡è¶³è‹¥ $y=dom_x,y \ne x$ é‚£ä¹ˆ $y=dom_{idom_x}$ï¼Œç›´è§‚ç†è§£å°±æ˜¯æ”¯é…ç‚¹ä¸­ç¦» $x$ æœ€è¿‘çš„é‚£ä¸ªã€‚$idom_x \to x$ å¯ä»¥å¾—åˆ°ä¸€æ£µæ ‘ï¼Œç§°ä¸ºæ”¯é…æ ‘ã€‚</p><h2 id="DAG"><a href="#DAG" class="headerlink" title="DAG"></a><a href="https://www.luogu.com.cn/problem/P2597">DAG</a></h2><p>æ±‚è§£ DAG çš„æ”¯é…æ ‘ï¼Œæœ‰ä¸€ä¸ªç®€å•çš„ç®—æ³•ã€‚</p><p>æ‹“æ‰‘æ’åºï¼ŒæŒ‰æ‹“æ‰‘åºä»å°åˆ°å¤§æ±‚è§£ã€‚å¯¹äºç‚¹ $x$ï¼ŒDAG ä¸Šä»¥å…¶ä¸ºç»ˆç‚¹çš„è¾¹æœ‰ $(s_1,x),(s_2,x)â€¦$ï¼Œåˆ™å…¶ç›´æ¥æ”¯é…ç‚¹ä¸º $LCA(s_1,s_2,â€¦)$ã€‚</p><p>éœ€è¦æ·»åŠ å¶å­èŠ‚ç‚¹æ±‚ LCAï¼Œç”¨å€å¢æ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦ $O((n+m)\log n)$ã€‚</p><h2 id="ä¸€èˆ¬å›¾"><a href="#ä¸€èˆ¬å›¾" class="headerlink" title="ä¸€èˆ¬å›¾"></a><a href="https://www.luogu.com.cn/problem/P5180">ä¸€èˆ¬å›¾</a></h2><p>å…ˆæ±‚å‡º dfs æ ‘ï¼Œ$x&lt;y$ å½“ä¸”ä»…å½“ $dfn_x&lt;dfn_y$ï¼Œè®° $[x,y]$ ä¸ºæ ‘ä¸Š $x$ åˆ° $y$ è·¯å¾„ä¸Šçš„ç‚¹ï¼ˆ$(x,y)$ åŒç†ï¼‰ã€‚</p><blockquote><p><strong>å¼•ç† 1</strong> $idom_u$ æ˜¯ $u$ çš„çœŸç¥–å…ˆï¼ˆä¸å« $u$ çš„ç¥–å…ˆï¼‰ã€‚</p><p>è¯æ˜æ˜¾ç„¶ã€‚</p></blockquote><p>è®° $lca$ ä¸º $lca(u,v)$ã€‚</p><blockquote><p><strong>å¼•ç† 2</strong> è‹¥ $u &lt; v$ï¼Œé‚£ä¹ˆä»»æ„ $u$ åˆ° $v$ çš„è·¯å¾„ä¸€å®šç»è¿‡ $lca$ çš„ç¥–å…ˆã€‚</p><p>æ¨ªå‰è¾¹æ»¡è¶³ä»å¤§åˆ°å°ï¼Œå¯ä»¥æ„Ÿæ€§ç†è§£ã€‚</p></blockquote><p>é‚£ä¹ˆä¸€å®šå­˜åœ¨ç¥–å…ˆèŠ‚ç‚¹ä½¿å¾—å…¶å¯ä»¥é€šè¿‡å¤§äº $x$ çš„èŠ‚ç‚¹åˆ°è¾¾ $x$ï¼Œè®°ä¸º $y$ï¼Œè€Œ $(y,x)$ éƒ½ä¸èƒ½ä½œä¸º $idom_x$ã€‚åªéœ€è¦è€ƒè™‘æ»¡è¶³è¯¥æ€§è´¨çš„æœ€å°çš„ç¥–å…ˆå³å¯ã€‚</p><blockquote><p><strong>åŠæ”¯é…ç‚¹</strong> å­˜åœ¨è·¯å¾„ $y \to p_1 \to p_2 \to â€¦ \to x,p_i &gt; x$ çš„æœ€å°çš„ $x$ çš„ç¥–å…ˆ $y$ ç§°ä¸º $x$ çš„åŠæ”¯é…ç‚¹ï¼Œè®°ä½œ $sdom_x$ã€‚</p></blockquote><p>è€ƒè™‘é€šè¿‡åŠæ”¯é…ç‚¹æ±‚å¾—ç›´æ¥æ”¯é…ç‚¹ã€‚è®° $p_x$ ä¸º $(sdom_x,x)$ ä¸Š $sdom$ æœ€å°çš„ç‚¹ï¼Œæœ‰</p><script type="math/tex; mode=display">idom_x = \begin{cases}  sdom_x  & \text{ if } sdom_{p_x} > sdom_x\\  idom_{p_x}  & \text{ otherwise }\end{cases}</script><p>è€ƒè™‘å°† $idom_x$ çš„æ±‚è§£æŒ‚åœ¨ $sdom_x$ ä¸Šã€‚éå† dfs æ ‘ï¼Œç”¨å¸¦æƒå¹¶æŸ¥é›†ç»´æŠ¤æ¯ä¸ªç‚¹åˆ°å½“å‰èŠ‚ç‚¹ $sdom$ æœ€å°çš„ç‚¹ï¼Œç›´æ¥æŸ¥è¯¢å³å¯ã€‚æœ€åæŒ‰ $dfs$ åºä»å¤§åˆ°å°è®¡ç®— $idom$ã€‚æ—¶é—´å¤æ‚åº¦ $O(n \log n)$ã€‚</p><p>è€ƒè™‘æ±‚è§£åŠæ”¯é…ç‚¹ã€‚è®¾æ±‚è§£ $sdom_x$ï¼Œåˆ†ç±»è®¨è®º</p><ul><li><p>å¯¹äºæ ‘è¾¹æˆ–å‰å‘è¾¹ $y \to x$ï¼Œç”¨ $y$ æ›´æ–° $sdom_x$ã€‚</p></li><li><p>å¯¹äºä¸­é—´æœ‰ç‚¹çš„è·¯å¾„ï¼Œæšä¸¾ $y \to x$ ä½œä¸ºæœ€åä¸€æ¡è¾¹ã€‚</p><p>ç›´æ¥ç”¨ $sdom_y$ æ›´æ–°æ˜¯ä¸å¯¹çš„ï¼Œå› ä¸º $sdom_x$ åˆ° $x$ å¯èƒ½å­˜åœ¨ç‚¹ $p$ æ»¡è¶³ $x &lt; p &lt; y$ã€‚</p><p>è®° $z$ ä¸º $sdom_x$ åˆ° $x$ ä¸Šæœ€å°çš„ç‚¹ï¼Œæ ¹æ®å¼•ç† 2ï¼Œ$z$ ä¸€å®šæ˜¯ $y$ çš„ç¥–å…ˆã€‚åªéœ€è€ƒè™‘ $z$ åœ¨ $[lca(x,y),y)$ ä¸Šçš„æƒ…å†µå³å¯ï¼Œå¦åˆ™å¯ä»¥é€šè¿‡æ ‘è¾¹åˆ°è¾¾ $x$ã€‚ç”¨ $sdom_z$ æ›´æ–° $sdom_x$ å³å¯ã€‚</p><p>å®ç°ä¸æ±‚è§£ç›´æ¥æ”¯é…ç‚¹ç›¸åŒï¼Œç”¨ä¸€ä¸ªå¹¶æŸ¥é›†å³å¯ï¼Œå…·ä½“è§ä»£ç ã€‚</p></li></ul><p>æ—¶é—´å¤æ‚åº¦ $O(n \log n)$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> n,m;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N],FG[N],TG[N],vc[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dfn[N],d_c=<span class="number">0</span>,fdfn[N],vis[N],sdom[N],idom[N],pos[N],siz[N];     </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fu)</span></span>{ fdfn[dfn[u]=++d_c]=u,vis[u]=<span class="number">1</span>; <span class="keyword">for</span>(<span class="type">int</span> v:G[u]) <span class="keyword">if</span>(!vis[v]) <span class="built_in">dfs</span>(v,u),TG[u].<span class="built_in">pb</span>(v); }</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DSU</span>{</span><br><span class="line">    <span class="type">int</span> fa[N],mn[N];</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span>{ <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) fa[i]=i,mn[i]=i; }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(x==fa[x]) <span class="keyword">return</span> x; <span class="type">int</span> res=<span class="built_in">find</span>(fa[x]);</span><br><span class="line">        <span class="keyword">if</span>(dfn[sdom[mn[fa[x]]]]&lt;dfn[sdom[mn[x]]]) mn[x]=mn[fa[x]];</span><br><span class="line">        <span class="keyword">return</span> fa[x]=res;</span><br><span class="line">    }</span><br><span class="line">}D;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sol</span><span class="params">(<span class="type">int</span> u)</span></span>{</span><br><span class="line">    dfn[sdom[u]]=INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v:FG[u]){</span><br><span class="line">        <span class="keyword">if</span>(dfn[v]&lt;dfn[u]){ <span class="keyword">if</span>(dfn[v]&lt;dfn[sdom[u]]) sdom[u]=v; }</span><br><span class="line">        <span class="keyword">else</span>{ D.<span class="built_in">find</span>(v); <span class="keyword">if</span>(dfn[sdom[D.mn[v]]]&lt;dfn[sdom[u]]) sdom[u]=sdom[D.mn[v]]; }</span><br><span class="line">    }</span><br><span class="line">    vc[sdom[u]].<span class="built_in">pb</span>(u);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v:vc[u]) D.<span class="built_in">find</span>(v),pos[v]=D.mn[v];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> v:TG[u]) D.fa[v]=u; </span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    n=rd,m=rd,D.<span class="built_in">init</span>(n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y;i&lt;=m;++i) G[x=rd].<span class="built_in">pb</span>(y=rd),FG[y].<span class="built_in">pb</span>(x);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>); <span class="keyword">for</span>(<span class="type">int</span> i=n;i&gt;=<span class="number">1</span>;--i) <span class="built_in">sol</span>(fdfn[i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i){</span><br><span class="line">        <span class="keyword">if</span>(pos[fdfn[i]]==fdfn[i]) idom[fdfn[i]]=sdom[fdfn[i]];</span><br><span class="line">        <span class="keyword">else</span> idom[fdfn[i]]=idom[pos[fdfn[i]]];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h4 id="1-ç‚¹é›†çš„æ”¯é…ç‚¹"><a href="#1-ç‚¹é›†çš„æ”¯é…ç‚¹" class="headerlink" title="1.ç‚¹é›†çš„æ”¯é…ç‚¹"></a>1.ç‚¹é›†çš„æ”¯é…ç‚¹</h4><p>æ±‚ç‚¹é›†åœ¨æ”¯é…æ ‘ä¸Šçš„ LCA å³å¯ã€‚</p><h4 id="2-æ”¯é…è¾¹"><a href="#2-æ”¯é…è¾¹" class="headerlink" title="2.æ”¯é…è¾¹"></a>2.æ”¯é…è¾¹</h4><p>æ˜¾ç„¶å¯ä»¥å¯ä»¥å¯¹æ¯æ¡è¾¹å»ºç«‹è™šç‚¹ã€‚ä½†æ­¤æ–¹æ³•å¸¸æ•°è¾ƒå¤§ï¼Œæœ‰å¸¸æ•°æ›´å°çš„åšæ³•ã€‚</p><blockquote><p><strong>å¼•ç† 3</strong> $(u,v)$ æ˜¯ç‚¹ $x$ çš„æ”¯é…è¾¹å½“ä¸”ä»…å½“ $u,v$ éƒ½æ˜¯ $x$ çš„æ”¯é…ç‚¹ä¸” $u$ åˆ° $v$ åªæœ‰ä¸€æ¡ç®€å•è·¯å¾„ã€‚</p><p>è¯æ˜æ˜¾ç„¶ã€‚</p></blockquote><p>æ”¯é…è¾¹æ˜¾ç„¶æ˜¯æ ‘è¾¹ï¼Œå¯¹äºæ ‘è¾¹ $(u,v)$ï¼Œè‹¥ $u=idom_v$ ä¸” $u$ åˆ° $v$ åªæœ‰ä¸€æ¡ç®€å•è·¯å¾„ï¼Œé‚£ä¹ˆ $(u,v)$ æ”¯é… $v$ æ”¯é…çš„æ‰€æœ‰ç‚¹ã€‚</p><p>å¯¹äºæ ‘è¾¹ $(u,v)$ ä¸” $u=idom_v$ï¼Œ$u$ åˆ° $v$ åªæœ‰ä¸€æ¡ç®€å•è·¯å¾„å½“ä¸”ä»…å½“è®¡ç®— $sdom_v$ æ—¶åªæœ‰ä¸€ç§æƒ…å†µä½¿å¾— $sdom=u$ï¼ˆæ³¨æ„é‡è¾¹ï¼‰ã€‚</p><h4 id="3-æœ‰å‘å›¾çš„å‰²ç‚¹å’Œå‰²è¾¹"><a href="#3-æœ‰å‘å›¾çš„å‰²ç‚¹å’Œå‰²è¾¹" class="headerlink" title="3.æœ‰å‘å›¾çš„å‰²ç‚¹å’Œå‰²è¾¹"></a>3.æœ‰å‘å›¾çš„å‰²ç‚¹å’Œå‰²è¾¹</h4><p>ç±»ä¼¼æ— å‘å›¾ï¼Œæœ‰å‘å›¾çš„å‰²ç‚¹å’Œå‰²è¾¹ä¸ºåˆ å»åå¼ºè¿é€šåˆ†é‡å¢åŠ çš„ç‚¹å’Œè¾¹ï¼Œç§°ä¸ºå¼ºå‰²ç‚¹å’Œå¼ºå‰²è¾¹ã€‚</p><p>å¯ä»¥å¯¹æ¯ä¸ªå¼ºè¿é€šåˆ†é‡åˆ†åˆ«è€ƒè™‘ï¼Œå› æ­¤ä»¥ä¸‹è®¨è®ºå‡åŸºäºå¼ºè¿é€šå›¾ã€‚</p><blockquote><p><strong>å¼•ç† 4.1</strong> ç‚¹ $x$ æ˜¯å¼ºå‰²ç‚¹å½“ä¸”ä»…å½“å¯¹äºä»»æ„ $u \ne x$ï¼Œéƒ½å­˜åœ¨ç‚¹ $v \ne x$ï¼Œä½¿å¾—ä»¥ä¸‹ä¹‹ä¸€æˆç«‹ï¼š</p><ul><li>ä»»æ„ $u$ åˆ° $v$ çš„è·¯å¾„éƒ½ç»è¿‡ $x$ã€‚</li><li>ä»»æ„ $v$ åˆ° $u$ çš„è·¯å¾„éƒ½ç»è¿‡ $x$ã€‚</li></ul><p><strong>å¼•ç† 4.2</strong> è¾¹ $(x,y)$ æ˜¯å¼ºå‰²è¾¹å½“ä¸”ä»…å½“å¯¹äºä»»æ„ $u$ éƒ½å­˜åœ¨ç‚¹ $v$ ä½¿å¾—ä»¥ä¸‹ä¹‹ä¸€æˆç«‹ï¼š</p><ul><li>ä»»æ„ $u$ åˆ° $v$ çš„è·¯å¾„éƒ½ç»è¿‡è¾¹ $(x,y)$ã€‚</li><li>ä»»æ„ $v$ åˆ° $u$ çš„è·¯å¾„éƒ½ç»è¿‡è¾¹ $(x,y)$ã€‚</li></ul><p>è¯æ˜æ˜¾ç„¶ã€‚</p></blockquote><p>è®° $DT(G,s)$ ä¸ºå›¾ $G$ ä»¥ $s$ ä¸ºæºç‚¹çš„æ”¯é…æ ‘ã€‚</p><p>ä»»å–ä¸€ç‚¹ $s$ï¼Œå¹¶åˆ¤æ–­å®ƒæ˜¯å¦ä¸ºå¼ºå‰²ç‚¹ã€‚æ ¹æ®æ¡ä»¶ 1ï¼Œ$DT(G,s)$ é™¤ $s$ å¤–çš„éå¶å­èŠ‚ç‚¹éƒ½æ˜¯å¼ºå‰²ç‚¹ï¼Œæ ¹æ®æ¡ä»¶ 2ï¼Œ$DT(G^{-1},s)$ é™¤ $s$ å¤–çš„éå¶å­èŠ‚ç‚¹éƒ½æ˜¯å¼ºå‰²ç‚¹ã€‚</p><p>å¼ºå‰²è¾¹åˆ¤æ–­åŒæ”¯é…è¾¹ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-Team-Rocket-Rises-Again"><a href="#1-Team-Rocket-Rises-Again" class="headerlink" title="1.Team Rocket Rises Again"></a><a href="https://www.luogu.com.cn/problem/CF757F">1.Team Rocket Rises Again</a></h4><p>å…ˆæ±‚æœ€çŸ­è·¯ DAGï¼Œå†æ±‚æ”¯é…æ ‘å³å¯ã€‚</p><h4 id="2-çœé€‰è”è€ƒ-2021-A-å·-æ”¯é…"><a href="#2-çœé€‰è”è€ƒ-2021-A-å·-æ”¯é…" class="headerlink" title="2.[çœé€‰è”è€ƒ 2021 A å·] æ”¯é…"></a><a href="https://www.luogu.com.cn/problem/P7520">2.[çœé€‰è”è€ƒ 2021 A å·] æ”¯é…</a></h4><p>å…ˆæ±‚æ”¯é…æ ‘ï¼Œåªéœ€åˆ¤æ–­æ˜¯å¦å­˜åœ¨ $1 \leadsto x \to y \leadsto p$ ä¸”ä¸ç»è¿‡ $idom_p$ çš„è·¯å¾„å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2+nq)$ã€‚</p><h4 id="3-ã€R1-Bã€‘åœ°é“çº¿è·¯"><a href="#3-ã€R1-Bã€‘åœ°é“çº¿è·¯" class="headerlink" title="3.ã€R1-Bã€‘åœ°é“çº¿è·¯"></a>3.ã€R1-Bã€‘åœ°é“çº¿è·¯</h4><p>æ±‚å¼ºå‰²è¾¹ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ã€Šæµ…è°ˆæ”¯é…æ ‘åŠå…¶åº”ç”¨ã€‹</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜â„ï¸â­• P3175 [HAOI2015] æŒ‰ä½æˆ–</title>
      <link href="/solutions/P3175/"/>
      <url>/solutions/P3175/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä½ æ‰‹ä¸Šæœ‰ä¸€ä¸ªæ•°ï¼Œåˆå§‹ä¸º $0$ï¼Œæ¯ç§’éšæœºé€‰æ‹©ä¸€ä¸ª $[0,2^n)$ çš„æ•°ä¸ä½ æ‰‹ä¸Šçš„æ•°æˆ–ï¼Œé€‰æ‹© $i$ çš„æ¦‚ç‡ä¸º $p_i$ï¼Œæ±‚ä½ æ‰‹ä¸Šçš„æ•°å˜ä¸º $2^n - 1$ çš„æœŸæœ›æ—¶é—´ã€‚</p><p>$1 \le n \le 20$ã€‚</p></blockquote><h2 id="æ³•ä¸€"><a href="#æ³•ä¸€" class="headerlink" title="æ³•ä¸€"></a>æ³•ä¸€</h2><p>min-max å®¹æ–¥ï¼Œç›´æ¥èƒŒå¼å­</p><script type="math/tex; mode=display">\mathrm{kthmax}(S) = \sum_{T \subseteq S} (-1)^{|T|-1} \binom{|T|-1}{k-1} \min(T)</script><p>æœŸæœ›æ„ä¹‰ä¸‹ä¹Ÿæ˜¯æˆç«‹çš„ï¼Œè¯æ˜æ¯”è¾ƒæ‰­æ›²ã€‚</p><p>è®° $f_{i}$ ä¸ºç¬¬ $i$ ä½å˜ä¸º $1$ çš„æ—¶é—´ï¼Œå¥— min-max å®¹æ–¥å³å¯ã€‚</p><h2 id="æ³•äºŒ"><a href="#æ³•äºŒ" class="headerlink" title="æ³•äºŒ"></a>æ³•äºŒ</h2><p>å®šä¹‰ä¹˜æ³•ä¸ºæˆ–å·ç§¯ï¼Œé‚£ä¹ˆ $k$ ç§’åæ‰‹ä¸Šçš„æ•°ä¸º $S$ çš„æ¦‚ç‡ä¸º $p^{k}_{S}$ã€‚è®° $f_{S}$ ä¸ºæ•°ä¸º $S$ çš„æœŸæœ›æ—¶é—´ï¼Œé‚£ä¹ˆ</p><script type="math/tex; mode=display">f_{S} = \sum_{k=1}^{\infty} k(p^{k}_{S} - p^{k-1}_{S})</script><p>è®° $f,p$ è«æ¯”ä¹Œæ–¯å˜æ¢çš„ç»“æœä¸º $F,P$ï¼Œé‚£ä¹ˆ</p><script type="math/tex; mode=display">\begin{aligned}F_{S} &= \sum_{k=1}^{\infty} k(P^{k}_{S} - P^{k-1}_{S}) \\&= -\sum_{k=0}^{\infty} P_{S}^{k} \\&=\left\{\begin{matrix} -\frac{1}{1-P_{S}} & (P_S \neq 1) \\ 0 & (P_S=1)\end{matrix}\right.\end{aligned}</script>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é›†åˆå¹‚çº§æ•°</title>
      <link href="/notes/FWT/"/>
      <url>/notes/FWT/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><script type="math/tex; mode=display">(x \oplus y) \& z = (x \& z) \oplus (y \& z)</script><script type="math/tex; mode=display">\frac{1}{2^{n}} \sum_{T < 2^n} (-1)^{|S \& T|} = [S=0]</script><p>å¾—åˆ°</p><script type="math/tex; mode=display">\begin{aligned}h_{S} &= \sum_{L \oplus R = S} f_{L}g_{R} \\&= \sum [L \oplus R \oplus S = 0]f_{L}g_{R} \\&= \sum \frac{1}{2^n} \sum_{T < 2^n} (-1)^{|(L \oplus R \oplus S) \& T|} f_{L}g_{R} \\&= \sum \frac{1}{2^n} \sum_{T < 2^n} (-1)^{|L \& T|}(-1)^{|R \& T|}(-1)^{|S \& T|}f_{L}g_{R} \\&= \frac{1}{2^n} \sum_{T < 2^n} (-1)^{|S \& T|} (\sum_{L < 2^n}(-1)^{|L \& T|}f_{L})(\sum_{R < 2^n}(-1)^{|R \& T|}g_{R})\end{aligned}</script><p>å®šä¹‰æ²ƒå°”ä»€å˜æ¢ä¸º</p><script type="math/tex; mode=display">f_{S} = \sum_{T < 2^n} (-1)^{|S \& T|} f_{T}</script><p>å…¶é€†å˜æ¢ä¸º</p><script type="math/tex; mode=display">f_{S} = \sum_{T < 2^n} (-1)^{|S \& T|} f_{T}</script><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">OR</span><span class="params">(<span class="type">int</span> A[N],<span class="type">int</span> op)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;(<span class="number">1</span>&lt;&lt;n);mid&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);i+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i;j&lt;i+mid;++j)</span><br><span class="line">                <span class="built_in">mod</span>(A[j+mid]=op*A[j]+A[j+mid]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AND</span><span class="params">(<span class="type">int</span> A[N],<span class="type">int</span> op)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>;mid&lt;(<span class="number">1</span>&lt;&lt;n);mid&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);i+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i;j&lt;i+mid;++j)</span><br><span class="line">                <span class="built_in">mod</span>(A[j]=A[j]+op*A[j+mid]);</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">XOR</span><span class="params">(<span class="type">int</span> A[N],<span class="type">int</span> op)</span></span>{</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> mid=<span class="number">1</span>,A0,A1;mid&lt;(<span class="number">1</span>&lt;&lt;n);mid&lt;&lt;=<span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;(<span class="number">1</span>&lt;&lt;n);i+=(mid&lt;&lt;<span class="number">1</span>))</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i;j&lt;i+mid;++j){</span><br><span class="line">                A0=A[j],A1=A[j+mid];</span><br><span class="line">                <span class="built_in">mod</span>(A[j]=A0+A1),<span class="built_in">mod</span>(A[j+mid]=A0-A1);</span><br><span class="line">                <span class="keyword">if</span>(op==<span class="number">-1</span>) A[j]=<span class="number">1ll</span>*A[j]*inv2%MOD,A[j+mid]=<span class="number">1ll</span>*A[j+mid]*inv2%MOD;</span><br><span class="line">            }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="Nim"><a href="#Nim" class="headerlink" title="Nim"></a>Nim</h2><blockquote><p>nim æ¸¸æˆï¼Œæœ‰ $n$ å †çŸ³å­ï¼Œæ±‚æ¯å †çŸ³å­ä¸ºä¸è¶…è¿‡ $m$ çš„ç´ æ•°ä¸”å…ˆæ‰‹å¿…è´¥çš„æ–¹æ¡ˆæ•°ã€‚</p><p>$1 \le n \le 10^9,1 \le m \le 10^5$ã€‚</p></blockquote><p>å…ˆæ‰‹å¿…è´¥å½“ä¸”ä»…å½“å¼‚æˆ–å’Œä¸º $0$ã€‚FWT å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(m\log m + m\log n)$ã€‚</p><h2 id="è¿é€šç”Ÿæˆå­å›¾è®¡æ•°"><a href="#è¿é€šç”Ÿæˆå­å›¾è®¡æ•°" class="headerlink" title="è¿é€šç”Ÿæˆå­å›¾è®¡æ•°"></a>è¿é€šç”Ÿæˆå­å›¾è®¡æ•°</h2><blockquote><p>ç»™ä½  $n$ ä¸ªèŠ‚ç‚¹çš„æ— å‘å›¾ $G$ï¼Œæ±‚è¿é€šç”Ÿæˆå­å›¾ä¸ªæ•°ï¼Œç­”æ¡ˆå¯¹ $10^9 + 7$ å–æ¨¡ã€‚</p><p>$1 \le n \le 20$ã€‚ </p></blockquote><p>è®° $f$ ä¸ºè¿é€šç”Ÿæˆå­å›¾çš„é›†åˆå¹‚çº§æ•°ï¼Œ$g$ ä¸ºç”Ÿæˆå­å›¾çš„é›†åˆå¹‚çº§æ•°ï¼Œä»¤$f_{\emptyset}=g_{\emptyset}=0$ï¼Œ$g$ æ˜¯å¥½æ±‚çš„ã€‚å®šä¹‰ä¹˜æ³•ä¸ºå­é›†å·ç§¯ï¼Œé‚£ä¹ˆ $g = \sum_{i \ge 1} \frac{f^{i}}{i!} = e^f -1$ï¼Œå³ $f = \ln(g+1)$ã€‚</p><h2 id="çº¿æ€§åŸº"><a href="#çº¿æ€§åŸº" class="headerlink" title="çº¿æ€§åŸº"></a>çº¿æ€§åŸº</h2><blockquote><p>å¯¹æ¯ä¸ª $S \in [0,2^n)$ï¼Œæ±‚ $\sum [\bigoplus_{x \in T}x = S] \prod_{x \in T} a_x \prod_{x \notin T} b_x$ã€‚</p><p>$1 \le n \le 20$ã€‚</p></blockquote><p>å®šä¹‰ä¹˜æ³•ä¸ºå¼‚æˆ–å·ç§¯ï¼Œå³æ±‚ $\prod (a_i + b_i x^i)$ çš„å„é¡¹ç³»æ•°ã€‚</p><p>FWTï¼Œå®šä¹‰ä¹˜æ³•ä¸ºå¯¹åº”ç›¸ä¹˜ï¼Œè½¬åŒ–ä¸º $\mathrm{IFWT} (\prod \mathrm{FWT} (a_i + b_ix^i))$ã€‚æ ¹æ®å®šä¹‰</p><script type="math/tex; mode=display">\begin{aligned}\prod \mathrm{FWT} (a_i + b_ix^i) &= \prod_{i} \sum_{j < 2^n} (a_i+(-1)^{|j \& i|} b_i)x^j \\&= \sum_{j < 2^n} x^j \prod_{i} (a_i + (-1)^{|j \& i|}b_i)\end{aligned}</script><p>å³å¯¹æ¯ä¸ª $S \in [0,2^n)$ æ±‚å‡º $\prod_{i}(a_i + (-1)^{|S \&amp; i|}b_i)$ã€‚æŒ‰ä½è€ƒè™‘ï¼Œè®° $f_{k,S}$ ä¸ºæ»¡è¶³ $i \oplus S \in [0,2^k)$ çš„ $i$ çš„ä¸Šå¼çš„å€¼ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜­â„ï¸â­• P6631 [ZJOI2020] åºåˆ—</title>
      <link href="/solutions/P6631/"/>
      <url>/solutions/P6631/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç»™ä½ ä¸€ä¸ªé•¿ä¸º $n$ çš„éè´Ÿæ•´æ•°åºåˆ— $a$ï¼Œä½ å¯ä»¥è¿›è¡ŒåŒºé—´å‡ $1$ï¼ŒåŒºé—´å¥‡æ•°ä¸‹æ ‡å‡ $1$ï¼ŒåŒºé—´å¶æ•°ä¸‹æ ‡å‡ $1$ï¼Œè¯·æ±‚å‡ºè®²æ‰€æœ‰æ•°å˜ä¸º $0$ çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚</p><p>$1 \le n \le 10^5$ã€‚</p></blockquote><p>è®° $m$ ä¸ºæ“ä½œç§ç±»æ•°ï¼Œ$S_i$ ä¸ºç¬¬ $i$ ç§æ“ä½œæ¶‰åŠçš„ä¸‹æ ‡é›†åˆï¼Œ$x_i$ ä¸ºç¬¬ $i$ ç§æ“ä½œçš„æ“ä½œæ¬¡æ•°ï¼Œé‚£ä¹ˆå¯ä»¥å†™æˆ</p><script type="math/tex; mode=display">\begin{aligned}\min \quad &\sum_{j=1}^{m} x_j \\\texttt{s.t.} \quad&\sum_{j=1}^{m} [i \in S_j]x_j = a_i \quad i=1,2,...,n \\&x_j \ge 0 \quad j=1,2,...,m\end{aligned}</script><p>å¯¹æ¯ä¸ªé™åˆ¶è®¾ä¸€ä¸ªä¹˜æ•° $p_i$ï¼ŒåŠ å…¥æœ€å°åŒ–çš„å¼å­ä¸­å¾—åˆ°</p><script type="math/tex; mode=display">\begin{aligned}&\sum_{j=1}^{m} x_j + \sum_{i=1}^{n} p_i (\sum_{j=1}^{m} [i \in S_j]x_i - a_i) \\&=\sum_{j=1}^{m} (\sum_{i \in S_j} p_i + 1) x_j - \sum_{i=1}^{n} p_ia_i\end{aligned}</script><p>æ‹‰æ ¼æœ—æ—¥å¯¹å¶ï¼Œå¹¶å°† $p_i$ å–åï¼Œå¾—åˆ°</p><script type="math/tex; mode=display">\begin{aligned}\max \quad &\sum_{i=1}^{n} p_ia_i \\\texttt{s.t.} \quad&\sum_{i \in S_j} p_i \le 1 \quad j=1,2,...,m \\\end{aligned}</script><p>æè¿°ä¸€ä¸‹å°±æ˜¯æ±‚å‡ºä¸€ä¸ªåºåˆ— $p$ ä½¿å¾—æ¯ä¸ªå¯ä»¥ä¸€èµ·æ“ä½œçš„ä¸‹æ ‡é›†åˆ $p$ ä¹‹å’Œéƒ½ $\le 1$ï¼Œæ±‚ $\sum_{i=1}^{n} a_ip_i$ çš„æœ€å¤§å€¼ã€‚</p><p>çŒœæµ‹æœ‰æ•´æ•°æœ€ä¼˜è§£ã€‚å‡è®¾ä¸€ä¸ªåˆæ³•çš„ $p$ æœ‰ $\le -2$ çš„æ•°ï¼Œé‚£ä¹ˆå°†å…¶æ”¹ä¸º $-1$ ä»ç„¶åˆæ³•å¹¶ä¸”ä¸åŠ£ã€‚é™åˆ¶ $p$ åªèƒ½å– $-1,0,1$ å³å¯ã€‚</p><p>è€ƒè™‘ DPï¼Œè®° $f_{i,0/1,0/1,0/1}$ ä¸ºæšä¸¾åˆ° $i$ï¼Œæ˜¯å¦æœ‰å’Œä¸º $1$ çš„åç¼€ï¼Œæ˜¯å¦æœ‰åç¼€æ»¡è¶³ä¸‹æ ‡ä¸ºå¶æ•°çš„å’Œä¸º $1$ï¼Œå¥‡æ•°ï¼Œçš„æœ€å¤§å€¼ã€‚è½¬ç§»æšä¸¾å½“å‰ä½é€‰æ‹© $-1,0,1$ å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ $O(n)$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span><span class="number">+100</span>,INF=<span class="number">1e18</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">in</span><span class="params">(<span class="type">int</span> S,<span class="type">int</span> i)</span></span>{ <span class="keyword">return</span> (S&gt;&gt;i)&amp;<span class="number">1</span>; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">chkmax</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> y)</span></span>{ <span class="keyword">return</span> y&gt;x?x=y,<span class="number">1</span>:<span class="number">0</span>; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line">    <span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,a[N],f[N][<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">    n=rd; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]=rd;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=n;++i) <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">8</span>;++j) f[i][j]=-INF; f[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;<span class="number">8</span>;++j){</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> x:{<span class="number">-1</span>,<span class="number">0</span>,<span class="number">1</span>}){</span><br><span class="line">                <span class="keyword">if</span>(<span class="built_in">in</span>(j,<span class="number">0</span>)==<span class="number">1</span>&amp;&amp;x==<span class="number">1</span>) <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">if</span>(i&amp;<span class="number">1</span>){ <span class="keyword">if</span>(x!=<span class="number">1</span>||!<span class="built_in">in</span>(j,<span class="number">2</span>)) <span class="built_in">chkmax</span>(f[i][(<span class="built_in">in</span>(j,<span class="number">0</span>)+x==<span class="number">1</span>)|(<span class="built_in">in</span>(j,<span class="number">1</span>)&lt;&lt;<span class="number">1</span>)|((<span class="built_in">in</span>(j,<span class="number">2</span>)+x==<span class="number">1</span>)&lt;&lt;<span class="number">2</span>)],f[i<span class="number">-1</span>][j]+x*a[i]); }</span><br><span class="line">                <span class="keyword">else</span>{ <span class="keyword">if</span>(x!=<span class="number">1</span>||!<span class="built_in">in</span>(j,<span class="number">1</span>)) <span class="built_in">chkmax</span>(f[i][(<span class="built_in">in</span>(j,<span class="number">0</span>)+x==<span class="number">1</span>)|((<span class="built_in">in</span>(j,<span class="number">1</span>)+x==<span class="number">1</span>)&lt;&lt;<span class="number">1</span>)|(<span class="built_in">in</span>(j,<span class="number">2</span>)&lt;&lt;<span class="number">2</span>)],f[i<span class="number">-1</span>][j]+x*a[i]); }</span><br><span class="line">            }</span><br><span class="line">        }</span><br><span class="line">    }</span><br><span class="line">    <span class="type">int</span> ans=<span class="number">0</span>; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">8</span>;++i) <span class="built_in">chkmax</span>(ans,f[n][i]);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> T=rd;</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜âš¡â­• AGC025F Addition and Andition</title>
      <link href="/solutions/AGC025F/"/>
      <url>/solutions/AGC025F/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç»™å®šä¸¤ä¸ªé•¿ä¸º $n,m$ çš„äºŒè¿›åˆ¶ä¸² $x,y$ï¼Œæœ‰ $k$ æ¬¡æ“ä½œï¼Œæ¯æ¬¡ä»¤ $x,y$ åŒæ—¶åŠ ä¸Š $x\&amp;y$ï¼Œæ±‚æœ€åçš„ $x,y$ã€‚</p><p>$1 \le n,m,k \le 10^6$ã€‚</p></blockquote><p>ç›´æ¥æ¨¡æ‹Ÿå¯ä»¥åšåˆ° $O((n+m)k)$ã€‚</p><p>å¯ä»¥æ‰‹ç©å‡ ç»„è§‚å¯Ÿæ€§è´¨ï¼Œå‘ç°åªä¼šç§»åŠ¨ $x_i=y_i=1$ çš„ä½ç½®ï¼Œå¹¶ä¸”å®ƒä»¬ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ï¼Œç®€å•æ¥è¯´å°±æ˜¯ä¸ä¼šæ’åˆ°ä¸€èµ·ã€‚è€ƒè™‘ä»é«˜ä½åˆ°ä½ä½è€ƒè™‘è¿™æ ·çš„ä½ç½®ï¼ˆå› ä¸ºé«˜ä½çš„â€œè¶³è¿¹â€ä¼šå¯¹ä½ä½äº§ç”Ÿå½±å“ï¼‰ã€‚</p><p>å¯¹äº $x_i=y_i=1$ çš„ $i$ï¼ŒæŒ‰ $i+1$ ä½åˆ†è®¨</p><ul><li><p>$x_{i+1}=y_{i+1}=0$ï¼Œç›¸å½“äº $i$ ä½çš„ $1$ ç§»åŠ¨ä¸€æ­¥ã€‚</p></li><li><p>$x_{i+1}=y_{i+1}=1$ï¼Œä¸å¯èƒ½å­˜åœ¨ã€‚</p></li><li><p>å…¶ä»–ï¼Œå½“å‰ä½çš„ $1$ ä¼šå‘å‰è·³è·ƒå‡ æ­¥ï¼ˆæ ¹æ®è¿ç»­ $1$ çš„ä¸ªæ•°ï¼‰ã€‚</p></li></ul><p>å¯¹äºç¬¬ä¸‰ç§æƒ…å†µï¼Œå¯ä»¥ç›´æ¥å°†å½“å‰ä½æ¸…ç©ºï¼Œä¸‹ä¸€ä½åŠ  $1$ï¼Œåœ¨ä¸‹ä¸€ä½å†å¤„ç†è¿›ä½ï¼Œåœ¨å½“å‰ä½æ­¥æ•°åŠ  $1$ï¼ˆè¿›ä½çš„ä½æ­¥æ•°ä¸åŠ ï¼‰ã€‚</p><p>å‘ç°æ¯æ¬¡è¿›è¡Œè¿›ä½ $1$ çš„ä¸ªæ•°éƒ½ä¼šå‡å°‘ï¼Œé‚£ä¹ˆè¿›ä½åªä¼šè¿›è¡Œ $O(n+m)$ æ¬¡ã€‚è€Œç¬¬ä¸€ç§æƒ…å†µå¾ˆå¥½ç¼©åœ¨ä¸€èµ·ï¼Œé‚£ä¹ˆå¾—å‡ºäº† $O(n+m+k)$ çš„æ¨¡æ‹Ÿåšæ³•ã€‚</p><p>å…·ä½“çš„ï¼Œä»é«˜ä½åˆ°ä½ä½æšä¸¾ï¼Œå°† $x/y$ éç©ºçš„ä½åŠ å…¥æ ˆä¸­ï¼Œå½“æšä¸¾åˆ° $x=y=1$ çš„ä½æ—¶è¿›è¡Œä¸Šè¿°æ¨¡æ‹Ÿï¼Œå…·ä½“ç»†èŠ‚è§ä»£ç ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span><span class="number">+100</span>,INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line">    <span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,K,a[N*<span class="number">2</span>],b[N*<span class="number">2</span>],sta[N*<span class="number">2</span>],tp=<span class="number">0</span>;</span><br><span class="line"><span class="type">char</span> s[N],t[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vc;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    n=rd,m=rd,K=rd,<span class="built_in">scanf</span>(<span class="string">"%s %s"</span>, s<span class="number">+1</span>, t<span class="number">+1</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(s<span class="number">+1</span>,s+n<span class="number">+1</span>),<span class="built_in">reverse</span>(t<span class="number">+1</span>,t+m<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="built_in">max</span>(n,m);++i) a[i]=(i&lt;=n?s[i]-<span class="string">'0'</span>:<span class="number">0</span>),b[i]=(i&lt;=m?t[i]-<span class="string">'0'</span>:<span class="number">0</span>);</span><br><span class="line">    sta[tp=<span class="number">1</span>]=INF;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="built_in">max</span>(n,m);i&gt;=<span class="number">1</span>;--i){</span><br><span class="line">        <span class="keyword">if</span>(!a[i]&amp;&amp;!b[i]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[i]&amp;&amp;b[i]){</span><br><span class="line">            vc={};</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=i,c=K;;){</span><br><span class="line">                vc.<span class="built_in">pb</span>(j);</span><br><span class="line">                <span class="keyword">for</span>(;tp&amp;&amp;sta[tp]&lt;=j;--tp);</span><br><span class="line">                <span class="keyword">if</span>(a[j]==<span class="number">1</span>&amp;&amp;b[j]==<span class="number">1</span>&amp;&amp;c){</span><br><span class="line">                    <span class="keyword">if</span>(tp&amp;&amp;sta[tp]==j<span class="number">+1</span>) a[j]=b[j]=<span class="number">0</span>,++a[j<span class="number">+1</span>],++b[j<span class="number">+1</span>],--c,++j;</span><br><span class="line">                    <span class="keyword">else</span>{ a[j]=b[j]=<span class="number">0</span>; <span class="type">int</span> jp=<span class="built_in">min</span>(c,sta[tp]-j<span class="number">-1</span>); c-=jp,j+=jp; a[j]=b[j]=<span class="number">1</span>; }</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(a[j]&gt;<span class="number">1</span>||b[j]&gt;<span class="number">1</span>){</span><br><span class="line">                    a[j<span class="number">+1</span>]+=a[j]/<span class="number">2</span>,a[j]&amp;=<span class="number">1</span>;</span><br><span class="line">                    b[j<span class="number">+1</span>]+=b[j]/<span class="number">2</span>,b[j]&amp;=<span class="number">1</span>;</span><br><span class="line">                    ++j;</span><br><span class="line">                }</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">break</span>;</span><br><span class="line">            }</span><br><span class="line">            <span class="built_in">reverse</span>(vc.<span class="built_in">begin</span>(),vc.<span class="built_in">end</span>());</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> v:vc) <span class="keyword">if</span>(a[v]||b[v]) sta[++tp]=v;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">else</span> sta[++tp]=i;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="built_in">reverse</span>(a<span class="number">+1</span>,a+n+K<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,flag=<span class="number">0</span>;i&lt;=n+K;++i){</span><br><span class="line">        <span class="keyword">if</span>(!a[i]&amp;&amp;!flag) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, a[i]); flag=<span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line">    <span class="built_in">reverse</span>(b<span class="number">+1</span>,b+m+K<span class="number">+1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,flag=<span class="number">0</span>;i&lt;=m+K;++i){</span><br><span class="line">        <span class="keyword">if</span>(!b[i]&amp;&amp;!flag) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d"</span>, b[i]); flag=<span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">""</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜¨â„ï¸âŒ CF1086F Forest Fires</title>
      <link href="/solutions/CF1086F/"/>
      <url>/solutions/CF1086F/</url>
      
        <content type="html"><![CDATA[<blockquote><p>æ— é™å¤§çš„ç½‘æ ¼ï¼Œç¬¬ $0$ ç§’æœ‰ $n$ ä¸ªç‚¹ç‡ƒçƒ§ï¼Œæ¯ä¸€ç§’æ­£ç‡ƒçƒ§çš„ç‚¹ä¼šä½¿ä¸å…¶å…«è¿é€šçš„ç‚¹ç‡ƒçƒ§ï¼Œæ¯ä¸ªç‚¹çš„æƒå€¼ä¸ºå…¶æœ€æ—©ç‡ƒçƒ§çš„æ—¶é—´ï¼Œæ±‚ $t$ ç§’åçš„æƒå€¼å’Œã€‚</p><p>$1 \le n \le 2000,1 \le t \le 10^8,-10^8 \le x,y \le 10^8$ã€‚</p></blockquote><p>è®° $f_i$ ä¸º $i$ ç§’åç‡ƒçƒ§æ ¼å­çš„æ•°é‡ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">tf_t - \sum_{i=0}^{t-1} f_i</script><p>$f_i$ å¯ç”¨æ‰«æçº¿ $O(n\log n)$ æ±‚è§£ï¼Œå¯ä»¥æ±‚å‡ºæ‰€æœ‰ $f_i$ ä»£å…¥ä¸Šå¼è·å¾—ç­”æ¡ˆï¼Œæ—¶é—´å¤æ‚åº¦ $O(tn \log n)$ã€‚</p><p>ç”±äºæ¯ç§’çŸ©å½¢éƒ½ä¼šæ‰©å¤§ $1$ï¼Œå¹¶ä¸”æ‰€æœ‰çŸ©å½¢çš„å¤§å°ç›¸ç­‰ï¼Œé‚£ä¹ˆçŒœæµ‹ $f_i$ ä¸ $i$ æˆæŸä¸ªç®€å•çš„å‡½æ•°å…³ç³»ã€‚çŸ©å½¢å¹¶çš„è½®å»“çº¿çš„å¤§å°å³ä¸º $f_i$ çš„å¢å¤§é‡ï¼Œå‘ç°è½®å»“çº¿çš„å¤§å°æˆç­‰å·®æ•°åˆ—ã€‚å‡†ç¡®æ¥è¯´ï¼Œå½“çŸ©å½¢çš„ç›¸äº¤å…³ç³»ä¸å˜æ—¶ï¼Œ$f_i$ ä¸ºå…³äº $i$ çš„äºŒæ¬¡å‡½æ•°ã€‚æ€»å…±æœ‰ $O(n^2)$ ç§ä¸¤ä¸¤ç›¸äº¤ï¼Œå®ƒä»¬å°†æ—¶é—´åˆ†æˆäº† $O(n^2)$ æ®µï¼Œæ¯æ®µä¸­ $f_i$ çš„å‡½æ•°è¡¨è¾¾å¼ä¸å˜ã€‚é‚£ä¹ˆæ±‚å‡ºä¸‰ä¸ª $f_i$ å°±å¯ä»¥å¾—åˆ°æœ¬æ®µä¸­ $f_i$ ä¹‹å’Œã€‚æ—¶é—´å¤æ‚åº¦ $O(n^3\log n)$ã€‚æœ¬æ–¹æ³•è¶³ä»¥é€šè¿‡ CFã€‚</p><p>å‘ç°çŸ©å½¢çš„äº¤æ˜¯å¥½æ±‚çš„ï¼Œè€ƒè™‘å®¹æ–¥ï¼Œè®° $g_{S,i}$ ä¸ºé›†åˆ $S$ ä¸­çš„åˆå§‹ç‚¹åœ¨ $i$ ç§’åå½¢æˆçŸ©å½¢çš„äº¤çš„å¤§å°ï¼Œé‚£ä¹ˆç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">\sum_{S} (-1)^{|S|+1} (tg_{S,t} - \sum_{i=0}^{t-1} g_{S,i})</script><p>è®° $dx,dy$ $S$ ä¸­çš„ç‚¹æ¨ªçºµåæ ‡å·®çš„æå¤§å€¼ï¼Œé‚£ä¹ˆ</p><script type="math/tex; mode=display">g_{S,i} = \max(0,2i+1-dx) \times \max(0,2i+1-dy)</script><p>é€šè¿‡æ¨å¼å­ï¼Œ$(-1)^{|S|+1}(tg_{S,t} - \sum_{i=0}^{t-1} g_{S,i})$ å¯ä»¥ $O(1)$ æ±‚è§£ï¼Œè®°ä¸º $G_S$ã€‚</p><p>è¿›ä¸€æ­¥è§‚å¯Ÿï¼Œè‹¥ $S$ ä¸­å­˜åœ¨ä¸€ä¸ªç‚¹ $x$ ä½¿å¾—åˆ å»è¿™ä¸ªç‚¹åæ¨ªçºµåæ ‡å·®çš„æå¤§å€¼ä¸å˜ï¼Œé‚£ä¹ˆ $G_{S} + G_{S \setminus \{x\}} = 0$ï¼ˆç¬¦å·ç›¸åï¼‰ï¼Œé‚£ä¹ˆåˆæ³•çš„ $S$ å¤§å¤§å‡å°‘ï¼Œäº‹å®ä¸Šåªæœ‰ $O(n^2)$ ä¸ªã€‚</p><p>å°†èŠ‚ç‚¹æŒ‰æ¨ªåæ ‡æ’åºï¼Œæšä¸¾ $i &lt; j$ æ¡†å®šæ¨ªåæ ‡å·®çš„æå¤§å€¼ã€‚éœ€è¦åˆ¤æ–­ $(i,j)$ ä¸­æ˜¯å¦å­˜åœ¨ç‚¹çš„çºµåæ ‡åœ¨ $i,j$ çºµåæ ‡å†…ï¼Œå¦‚æœå­˜åœ¨é‚£ä¹ˆåŒ…å« $i,j$ çš„é›†åˆéƒ½ä¸åˆæ³•ï¼Œå¦åˆ™å°† $G_{\{i,j\}}$ è®¡å…¥ç­”æ¡ˆï¼Œå¹¶æ‰¾åˆ° $(i,j)$ ä¸­ $i,j$ çºµåæ ‡çš„å‰é©±/åç»§ï¼Œæšä¸¾å®ƒä»¬æ˜¯å¦è®¡å…¥ $S$ è®¡å…¥ç­”æ¡ˆã€‚ç”¨ <code>set</code> å®ç°ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2\log n)$ã€‚ç”¨é“¾è¡¨å®ç°å¯ä»¥åšåˆ° $O(n^2)$ã€‚</p><p>æœ‰ä¸€ä¸ªç»†èŠ‚æ˜¯å¯¹äºæ¨ª/çºµåæ ‡ç›¸ç­‰çš„ç‚¹ï¼Œå‘ç°æ€æ ·é’¦å®šå®ƒä»¬çš„é¡ºåºéƒ½æ˜¯å¯¹çš„ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ar(x) array<span class="string">&lt;int,x&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e3</span><span class="number">+100</span>,INF=<span class="number">1e9</span>,MOD=<span class="number">998244353</span>,inv3=<span class="number">332748118</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mod</span><span class="params">(<span class="type">int</span> &amp;x)</span></span>{ <span class="keyword">if</span>(x&gt;=MOD) x-=MOD; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x+=MOD; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y=MOD<span class="number">-2</span>)</span></span>{ <span class="type">int</span> res=<span class="number">1</span>; <span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=<span class="number">1ll</span>*x*x%MOD) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="number">1ll</span>*res*x%MOD; <span class="keyword">return</span> res; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line">    <span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,t,ans=<span class="number">0</span>; <span class="built_in">ar</span>(<span class="number">2</span>) a[N]; set&lt;<span class="type">int</span>&gt; s;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">f</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> i)</span></span>{ <span class="keyword">return</span> <span class="number">1ll</span>*<span class="built_in">max</span>(<span class="number">0</span>,(<span class="number">2</span>*i-x<span class="number">+1</span>))*<span class="built_in">max</span>(<span class="number">0</span>,(<span class="number">2</span>*i-y<span class="number">+1</span>))%MOD; }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">S1</span><span class="params">(<span class="type">int</span> x)</span></span>{ <span class="keyword">return</span> <span class="number">1ll</span>*x*(x<span class="number">+1</span>)/<span class="number">2</span>%MOD; }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">S2</span><span class="params">(<span class="type">int</span> x)</span></span>{ <span class="keyword">return</span> <span class="number">1ll</span>*x*(x<span class="number">+1</span>)/<span class="number">2</span>%MOD*(<span class="number">2</span>*x<span class="number">+1</span>)%MOD*inv3%MOD; }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line"><span class="type">int</span> res=<span class="number">1ll</span>*t*<span class="built_in">f</span>(x,y,t)%MOD,l=(<span class="built_in">max</span>(x,y)<span class="number">+1</span>)/<span class="number">2</span>,r=t<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">if</span>(l&gt;r) <span class="keyword">return</span> res;</span><br><span class="line"><span class="built_in">mod</span>(res-=<span class="number">4ll</span>*(<span class="built_in">S2</span>(r)-<span class="built_in">S2</span>(l<span class="number">-1</span>))%MOD);</span><br><span class="line"><span class="built_in">mod</span>(res+=<span class="number">2ll</span>*(x<span class="number">-1</span>+y<span class="number">-1</span>)*(<span class="built_in">S1</span>(r)-<span class="built_in">S1</span>(l<span class="number">-1</span>))%MOD);</span><br><span class="line"><span class="built_in">mod</span>(res-=<span class="number">1ll</span>*(x<span class="number">-1</span>)*(y<span class="number">-1</span>)%MOD*(r-l<span class="number">+1</span>)%MOD);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">(<span class="type">int</span> i,<span class="type">int</span> j)</span></span>{</span><br><span class="line">    <span class="type">int</span> dx=a[j][<span class="number">0</span>]-a[i][<span class="number">0</span>],p=INF,q=INF;</span><br><span class="line">    <span class="keyword">if</span>(a[i][<span class="number">1</span>]&gt;a[j][<span class="number">1</span>]) <span class="built_in">swap</span>(i,j);</span><br><span class="line">    <span class="keyword">auto</span> it1=s.<span class="built_in">upper_bound</span>(a[j][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">auto</span> it2=s.<span class="built_in">lower_bound</span>(a[i][<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span>(it1!=it2) <span class="keyword">return</span>;</span><br><span class="line">    <span class="built_in">mod</span>(ans-=<span class="built_in">calc</span>(dx,a[j][<span class="number">1</span>]-a[i][<span class="number">1</span>]));</span><br><span class="line">    <span class="keyword">if</span>(it1!=s.<span class="built_in">end</span>()) <span class="built_in">mod</span>(ans+=<span class="built_in">calc</span>(dx,*it1-a[i][<span class="number">1</span>])),p=*it1;</span><br><span class="line">    <span class="keyword">if</span>(it2!=s.<span class="built_in">begin</span>()) --it2,<span class="built_in">mod</span>(ans+=<span class="built_in">calc</span>(dx,a[j][<span class="number">1</span>]-*it2)),q=*it2;</span><br><span class="line">    <span class="keyword">if</span>(p!=INF&amp;&amp;q!=INF) <span class="built_in">mod</span>(ans-=<span class="built_in">calc</span>(dx,p-q));</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">    n=rd,t=rd,ans=<span class="number">1ll</span>*n*<span class="built_in">calc</span>(<span class="number">0</span>,<span class="number">0</span>)%MOD;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) a[i]={rd,rd}; <span class="built_in">sort</span>(a<span class="number">+1</span>,a+n<span class="number">+1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i){</span><br><span class="line">        s.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i<span class="number">+1</span>;j&lt;=n;++j)</span><br><span class="line">            <span class="built_in">solve</span>(i,j),s.<span class="built_in">insert</span>(a[j][<span class="number">1</span>]);</span><br><span class="line">    }</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> T=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜¨â¤ï¸âŒ THUWC2024 å°Cçš„çŸ©é˜µ</title>
      <link href="/solutions/THUWC2024C/"/>
      <url>/solutions/THUWC2024C/</url>
      
        <content type="html"><![CDATA[<p>upd: å›¾æŒ‚äº†ï¼Œä½†æ‡’å¾—è¡¥äº†ï¼Œå°†å°±ç€çœ‹ã€‚</p><hr><p><a href="https://www.luogu.com.cn/problem/U401797">æ­¤å¤„</a>æäº¤ã€‚</p><blockquote><p>äº¤äº’é¢˜ï¼Œæœ‰ä¸€ä¸ª $n \times m$ çš„ $01$ çŸ©é˜µï¼Œä½ å¯ä»¥è¯¢é—®ä¸€ä¸ªçŸ©å½¢å†…æ˜¯å¦æœ‰ $1$ï¼Œä½ éœ€è¦æ‰¾åˆ° $(x,y)=1$ ä¸”æ»¡è¶³ $x+y$ æœ€å¤§ï¼Œè¾“å‡ºæœ€å¤§çš„ $x+y$ã€‚æœ‰è¯¢é—®æ¬¡æ•°å’Œè¯¢é—®çŸ©å½¢å¤§å°å’Œçš„é™åˆ¶ï¼Œå…¶ä¸­è¯¢é—®çŸ©å½¢å¤§å°å’Œç”± $\sum \max(xr-xl+1,yr-yl+1)$ å®šä¹‰ã€‚</p><p>ä¸‰ç§æ•°æ®ï¼š</p><ul><li><p>$n=m=2$ï¼Œè¯¢é—®æ¬¡æ•°é™åˆ¶ä¸º $2$ï¼Œè¯¢é—®çŸ©å½¢å¤§å°å’Œé™åˆ¶ä¸º $3$ã€‚</p></li><li><p>$n=1,m=2^{12}$ï¼Œè¯¢é—®æ¬¡æ•°é™åˆ¶ä¸º $12$ï¼Œè¯¢é—®çŸ©å½¢å¤§å°å’Œé™åˆ¶ä¸º $2^{12}-1$ã€‚</p></li><li><p>$n=m=2^{12}$ï¼Œè¯¢é—®æ¬¡æ•°é™åˆ¶ä¸º $2^{13}$ï¼Œè¯¢é—®çŸ©å½¢å¤§å°é™åˆ¶ä¸º $7.4 \times 10^4$ã€‚</p></li></ul></blockquote><p>åˆ†åˆ«è€ƒè™‘ã€‚</p><h2 id="ä¸€"><a href="#ä¸€" class="headerlink" title="ä¸€"></a>ä¸€</h2><p>æ‰‹ç©å³å¯ï¼Œå››ä¸ªæ ¼ä¾æ¬¡æ ‡å· $1,2,3,4$ã€‚</p><ul><li><p>æŸ¥è¯¢ $2,4$ã€‚</p><ul><li><p>ä¸º $1$ åˆ™æŸ¥è¯¢ $4$ã€‚</p><ul><li><p>ä¸º $1$ åˆ™ä¸ºå››å·æ ¼ã€‚</p></li><li><p>ä¸º $0$ åˆ™ä¸ºäºŒå·æ ¼ã€‚</p></li></ul></li><li><p>ä¸º $0$ åˆ™æŸ¥è¯¢ $3$ã€‚</p><ul><li><p>ä¸º $1$ åˆ™ä¸ºä¸‰å·æ ¼ã€‚</p></li><li><p>ä¸º $0$ åˆ™ä¸ºä¸€å·æ ¼ã€‚</p></li></ul></li></ul></li></ul><p>æ¬¡æ•°ä¸º $2$ï¼Œå¤§å°ä¸º $3$ã€‚</p><h2 id="äºŒ"><a href="#äºŒ" class="headerlink" title="äºŒ"></a>äºŒ</h2><p>äºŒåˆ†å³å¯ï¼Œå½“é€’å½’åˆ° $[l,r]$ æ—¶ï¼ŒæŸ¥è¯¢ $[mid+1,r]$ï¼Œè‹¥ä¸º $1$ åˆ™é€’å½’ $[mid+1,r]$ å¦åˆ™é€’å½’ $[l,mid]$ã€‚</p><p>æ¬¡æ•°ä¸º $12$ï¼Œå¤§å°ä¸º $2^{12}-1$ã€‚</p><h2 id="ä¸‰"><a href="#ä¸‰" class="headerlink" title="ä¸‰"></a>ä¸‰</h2><p>$x+y$ ç›¸ç­‰çš„æ ¼å­å½¢æˆäº†ä¸€æ¡ä»å·¦ä¸‹åˆ°å³ä¸Šçš„çº¿ã€‚ä»ç„¶è€ƒè™‘äºŒåˆ†ç­”æ¡ˆã€‚å¥—ç”¨æ³•ä¸€ï¼Œåˆ†ä¸º $4$ ä¸ªè¾¹é•¿ä¸º $2^6$ çš„æ­£æ–¹å½¢ï¼Œå‘ç°å¯ä»¥å°†ç­”æ¡ˆçš„èŒƒå›´ç¼©å°ä¸€åŠï¼ˆæœ‰ä¸‰ç§æƒ…å†µï¼‰ï¼Œè¿™æ˜¯å¾ˆå¥½çš„ã€‚åªéœ€è¦é€’å½’è§£å†³ä¸‹å›¾çš„é—®é¢˜ã€‚</p><p><img src="https://pic1.imgdb.cn/item/67b3ebc8d0e0a243d4005d32.png" alt=""></p><p>å°† LR å¤¹ç€çš„æ­£æ–¹å½¢å–å‡ºæ¥ï¼ˆä¸‹å›¾çº¢è‰²çš„éƒ¨åˆ†ï¼‰ã€‚</p><p><img src="https://pic1.imgdb.cn/item/67b3ebc8d0e0a243d4005d32.png" alt=""></p><p>å…¶ä¸­ç°è‰²çš„éƒ¨åˆ†æ˜¯æ²¡æœ‰ $1$ çš„ï¼Œä¸ç„¶ä¸ä¼šé€’å½’åˆ° LRã€‚å¯¹æ¯ä¸ªçº¢è‰²çš„æ­£æ–¹å½¢ä½¿ç”¨æ³•ä¸€ï¼Œä¸‰ç§æƒ…å†µå–æœ€ä¼˜é€’å½’ä¸‹å»å³å¯ã€‚</p><p>æ€»å…±é€’å½’äº† $12$ æ¬¡ï¼Œæ ‡å· $0,1,2,..,11$ï¼Œç¬¬ $i$ æ¬¡é€’å½’ä¸­é—´æœ€å¤šæœ‰ $2^{i}$ ä¸ªæ­£æ–¹å½¢ã€‚æ€»æ¬¡æ•°æœ€å¤šä¸º $2\sum_{i=0}^{11}2^i = 2^{13}-2$ï¼Œæ€»å¤§å°æœ€å¤šä¸ºä¸º $\frac{3}{2}\sum_{i=0}^{11} 2^{i} \times \frac{2^{12}}{2^{i}} = 18 \times 2^{12} =  73728$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">4096</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="string">"C"</span>{</span><br><span class="line">    <span class="function"><span class="keyword">extern</span> <span class="type">bool</span> <span class="title">Ask</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r,<span class="type">int</span> u,<span class="type">int</span> v)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">extern</span> <span class="type">int</span> <span class="title">Solve</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m,<span class="type">int</span> id)</span></span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> A{</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">Ask</span>(<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)==<span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">Ask</span>(<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>)==<span class="number">1</span>?<span class="number">4</span>:<span class="number">3</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">Ask</span>(<span class="number">2</span>,<span class="number">2</span>,<span class="number">1</span>,<span class="number">1</span>)==<span class="number">1</span>?<span class="number">3</span>:<span class="number">2</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> B{</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sol</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(l==r) <span class="keyword">return</span> l;</span><br><span class="line">        <span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Ask</span>(<span class="number">1</span>,<span class="number">1</span>,mid<span class="number">+1</span>,r)==<span class="number">1</span>?<span class="built_in">sol</span>(mid<span class="number">+1</span>,r):<span class="built_in">sol</span>(l,mid);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sol</span>(<span class="number">1</span>,N)<span class="number">+1</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="keyword">namespace</span> C{</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> xl,<span class="type">int</span> xr,<span class="type">int</span> yl,<span class="type">int</span> yr)</span></span>{</span><br><span class="line">        <span class="type">int</span> xm=xl+xr&gt;&gt;<span class="number">1</span>,ym=yl+yr&gt;&gt;<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">Ask</span>(xl,xr,ym<span class="number">+1</span>,yr)==<span class="number">1</span>) <span class="keyword">return</span> <span class="built_in">Ask</span>(xm<span class="number">+1</span>,xr,ym<span class="number">+1</span>,yr)==<span class="number">1</span>?<span class="number">3</span>:<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">Ask</span>(xm<span class="number">+1</span>,xr,yl,ym)==<span class="number">1</span>?<span class="number">2</span>:<span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">sol</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>{</span><br><span class="line">        <span class="keyword">if</span>(r-l==<span class="number">2</span>) <span class="keyword">return</span> l<span class="number">+1</span>;</span><br><span class="line">        <span class="type">int</span> res=<span class="number">0</span>,mid=l+r&gt;&gt;<span class="number">1</span>,L=r-l&gt;&gt;<span class="number">1</span>,x,y;</span><br><span class="line">        <span class="keyword">if</span>(mid&lt;=N) x=mid<span class="number">-1</span>,y=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> x=N,y=mid-N;</span><br><span class="line">        <span class="keyword">for</span>(;x-L<span class="number">+1</span>&gt;=<span class="number">1</span>&amp;&amp;y+L<span class="number">-1</span>&lt;=N;x-=L,y+=L) res=<span class="built_in">max</span>(res,<span class="built_in">calc</span>(x-L<span class="number">+1</span>,x,y,y+L<span class="number">-1</span>));</span><br><span class="line">        <span class="keyword">return</span> res==<span class="number">1</span>?<span class="built_in">sol</span>(l,mid):res==<span class="number">2</span>?<span class="built_in">sol</span>(l+mid&gt;&gt;<span class="number">1</span>,mid+r&gt;&gt;<span class="number">1</span>):<span class="built_in">sol</span>(mid,r);</span><br><span class="line">    }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sol</span>(<span class="number">1</span>,<span class="number">2</span>*N<span class="number">+1</span>);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">Solve</span><span class="params">(<span class="type">int</span> n , <span class="type">int</span> m , <span class="type">int</span> id)</span></span>{</span><br><span class="line">    <span class="keyword">if</span>(id==<span class="number">1</span>) <span class="keyword">return</span> A::<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(id==<span class="number">2</span>) <span class="keyword">return</span> B::<span class="built_in">solve</span>();</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> C::<span class="built_in">solve</span>();</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜¨â¤ï¸âŒ AGC018E Sightseeing Plan</title>
      <link href="/solutions/AGC018E/"/>
      <url>/solutions/AGC018E/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ç½‘æ ¼å›¾ä¸Šæœ‰ä¸‰ä¸ªçŸ©å½¢ â€‹â€‹</p><script type="math/tex; mode=display">A:(x_1,y_1)-(x_2,y_2),B:(x_3,y_3)-(x_4,y_4),C:(x_5,y_5)-(x_6,y_6)</script><p>æ±‚ $a \to b \to c(a \in A,b \in B,c \in C)$ çš„æ–¹æ¡ˆæ•°ã€‚</p><p>å…¶ä¸­ $a \to b$ è¡¨ç¤º $a$ å‘ä¸‹å‘å³èµ°åˆ° $b$ çš„è·¯å¾„ã€‚ä¸¤ä¸ªæ–¹æ¡ˆä¸åŒå½“ä¸”ä»…å½“ $a,b,c$ ä¸åŒï¼Œæˆ– $a \to b,b \to c$ ä¸åŒã€‚</p><p>$1 \le x_1 \le x_2 &lt; x_3 \le x_4 &lt; x_5 \le x_6 \le 10^6,1 \le y_1 \le y_2 &lt; y_3â€‹ \le y_4 &lt; y_5 \le y_6 \le 10^6$ã€‚</p></blockquote><p>è€ƒè™‘æšä¸¾ä¸­é—´èŠ‚ç‚¹ $b$ï¼Œéœ€è¦è®¡ç®—çš„æ˜¯ä¸€ä¸ªç‚¹åˆ°ä¸€ä¸ªçŸ©å½¢çš„æ–¹æ¡ˆæ•°ã€‚å°†çŸ©å½¢å·®åˆ†ï¼Œåªéœ€è¦è®¡ç®—ç‚¹ $(0,0)$ åˆ°çŸ©å½¢ $(0,0)-(x,y)$ çš„æ–¹æ¡ˆæ•°ã€‚</p><script type="math/tex; mode=display">\begin{aligned}\sum_{i=0}^{x} \sum_{j=0}^{y} \binom{i+j}{i} &= \sum_{i=0}^{x} \binom{y+i+1}{i+1} \\&= \sum_{i=-1}^{x} \binom{y+i+1}{y} - \binom{y}{y} \\&= \binom{x+y+2}{y+1} - 1\end{aligned}</script><p>å·®åˆ†çš„å››é¡¹æ±‚å’Œä¹‹å $-1$ å°±è¢«æ¶ˆå»äº†ï¼Œè€Œ $\binom{x+y+2}{y+1}$ æ°ä¸º $(0,0) \to (x+1,y+1)$ çš„æ–¹æ¡ˆæ•°ã€‚è®° $a \to b$ è¡¨ç¤º $a$ åˆ° $b$ è·¯å¾„çš„æ–¹æ¡ˆæ•°ï¼Œé‚£ä¹ˆ $b$ åˆ° $A$ çš„æ–¹æ¡ˆæ•°ä¸º</p><script type="math/tex; mode=display">b \to (x_1-1,y_1-1) + b \to (x_2,y_2) - b \to (x_1-1,y_2) - b \to (x_2,y_1-1)</script><p>$b$ åˆ° $C$ çš„æ–¹æ¡ˆæ•°ç±»ä¼¼ï¼Œå¾—åˆ°äº† $O(n^2)$ çš„åšæ³•ã€‚</p><p>é€šè¿‡å·®åˆ†ç›¸å½“äºå°† $A,B$ åˆ†åˆ«è½¬åŒ–ä¸º $4$ ä¸ªç‚¹ï¼Œè€Œæšä¸¾ $4 \times 4$ ä¸ªç‚¹å¯¹æ˜¯å¯ä»¥æ¥å—çš„ï¼Œè€ƒè™‘æšä¸¾èµ·ç‚¹ $a$ å’Œç»ˆç‚¹ $c$ï¼Œæ­¤æ—¶å¯¹ç­”æ¡ˆè´¡çŒ®çš„ç³»æ•°ä¸ºä¸¤ä¸ªç‚¹å¯¹åº”ç³»æ•°çš„ä¹˜ç§¯ã€‚</p><p>ä¸€æ¡ $a \to c$ çš„è·¯å¾„äº§ç”Ÿçš„æ–¹æ¡ˆæ•°ä¸ºè·¯å¾„ä¸ $B$ çš„äº¤ç‚¹ä¸ªæ•°ï¼ˆæ¯ä¸ªäº¤ç‚¹éƒ½å¯ä»¥å……å½“ $b$ï¼‰ã€‚å¯ä»¥æšä¸¾è·¯å¾„è¿›å…¥å’Œç¦»å¼€ $B$ çš„ç‚¹è®¡ç®—æ–¹æ¡ˆæ•°ï¼Œä½†è¿™æ ·ä»æ˜¯ $O(n^2)$ çš„ã€‚è‹¥çŸ©å½¢åŒ…å« $a$ é‚£å°±ä¸ç”¨æšä¸¾è¿›å…¥çš„ç‚¹äº†ã€‚ç»§ç»­å·®åˆ†ï¼Œå°† $B$ å·®åˆ†ä¸ºå››ä¸ªä»¥ $a$ ä¸ºå·¦ä¸Šè§’çš„çŸ©å½¢ã€‚æšä¸¾è·¯å¾„ç¦»å¼€çŸ©å½¢çš„ç‚¹è®¡ç®—æ–¹æ¡ˆæ•°å³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼Œå¸¦ä¸€ä¸ªæ¯”è¾ƒå¤§çš„å¸¸æ•°ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ar(x) array<span class="string">&lt;int,x&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e6</span><span class="number">+100</span>,MOD=<span class="number">1e9</span><span class="number">+7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y=MOD<span class="number">-2</span>)</span></span>{ <span class="type">int</span> res=<span class="number">1</span>; <span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=<span class="number">1ll</span>*x*x%MOD) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="number">1ll</span>*res*x%MOD; <span class="keyword">return</span> res; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mod</span><span class="params">(<span class="type">int</span> &amp;x)</span></span>{ <span class="keyword">if</span>(x&gt;=MOD) x-=MOD; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x+=MOD; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line">    <span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line">    <span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line">    <span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> jc[N],fjc[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span>{</span><br><span class="line">    jc[<span class="number">0</span>]=<span class="number">1</span>; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) jc[i]=<span class="number">1ll</span>*jc[i<span class="number">-1</span>]*i%MOD;</span><br><span class="line">    fjc[n]=<span class="built_in">qm</span>(jc[n]); <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;~i;--i) fjc[i]=<span class="number">1ll</span>*fjc[i<span class="number">+1</span>]*(i<span class="number">+1</span>)%MOD;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">CM</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span>{ <span class="keyword">return</span> n&lt;<span class="number">0</span>||m&lt;<span class="number">0</span>||m&gt;n?<span class="number">0</span>:<span class="number">1ll</span>*jc[n]*fjc[m]%MOD*fjc[n-m]%MOD; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> x_1,<span class="type">int</span> y_1,<span class="type">int</span> x_2,<span class="type">int</span> y_2)</span></span>{ <span class="keyword">return</span> <span class="built_in">CM</span>(<span class="built_in">abs</span>(x_2-x_1)+<span class="built_in">abs</span>(y_2-y_1),<span class="built_in">abs</span>(x_2-x_1)); }</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> x[<span class="number">7</span>],y[<span class="number">7</span>],ans=<span class="number">0</span>;</span><br><span class="line">vector&lt;ar(3)&gt; A,B,C;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sol</span><span class="params">(ar(<span class="number">3</span>) a,ar(<span class="number">3</span>) b,ar(<span class="number">3</span>) c)</span></span>{</span><br><span class="line">    <span class="type">int</span> res=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=a[<span class="number">1</span>];i&lt;=b[<span class="number">1</span>];++i) <span class="built_in">mod</span>(res+=<span class="number">1ll</span>*<span class="built_in">calc</span>(b[<span class="number">0</span>],i,a[<span class="number">0</span>],a[<span class="number">1</span>])*<span class="built_in">calc</span>(b[<span class="number">0</span>]<span class="number">+1</span>,i,c[<span class="number">0</span>],c[<span class="number">1</span>])%MOD*(b[<span class="number">0</span>]-a[<span class="number">0</span>]+i-a[<span class="number">1</span>]<span class="number">+1</span>)%MOD);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=a[<span class="number">0</span>];i&lt;=b[<span class="number">0</span>];++i) <span class="built_in">mod</span>(res+=<span class="number">1ll</span>*<span class="built_in">calc</span>(i,b[<span class="number">1</span>],a[<span class="number">0</span>],a[<span class="number">1</span>])*<span class="built_in">calc</span>(i,b[<span class="number">1</span>]<span class="number">+1</span>,c[<span class="number">0</span>],c[<span class="number">1</span>])%MOD*(i-a[<span class="number">0</span>]+b[<span class="number">1</span>]-a[<span class="number">1</span>]<span class="number">+1</span>)%MOD);</span><br><span class="line">    <span class="built_in">mod</span>(ans+=a[<span class="number">2</span>]*b[<span class="number">2</span>]*c[<span class="number">2</span>]*res);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">    <span class="built_in">init</span>(N<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">6</span>;++i) x[i]=rd;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">6</span>;++i) y[i]=rd;</span><br><span class="line"></span><br><span class="line">    A.<span class="built_in">pb</span>({x[<span class="number">2</span>],y[<span class="number">2</span>],<span class="number">1</span>}),A.<span class="built_in">pb</span>({x[<span class="number">1</span>]<span class="number">-1</span>,y[<span class="number">1</span>]<span class="number">-1</span>,<span class="number">1</span>}),A.<span class="built_in">pb</span>({x[<span class="number">2</span>],y[<span class="number">1</span>]<span class="number">-1</span>,<span class="number">-1</span>}),A.<span class="built_in">pb</span>({x[<span class="number">1</span>]<span class="number">-1</span>,y[<span class="number">2</span>],<span class="number">-1</span>});</span><br><span class="line">    B.<span class="built_in">pb</span>({x[<span class="number">4</span>],y[<span class="number">4</span>],<span class="number">1</span>}),B.<span class="built_in">pb</span>({x[<span class="number">3</span>]<span class="number">-1</span>,y[<span class="number">3</span>]<span class="number">-1</span>,<span class="number">1</span>}),B.<span class="built_in">pb</span>({x[<span class="number">4</span>],y[<span class="number">3</span>]<span class="number">-1</span>,<span class="number">-1</span>}),B.<span class="built_in">pb</span>({x[<span class="number">3</span>]<span class="number">-1</span>,y[<span class="number">4</span>],<span class="number">-1</span>});</span><br><span class="line">    C.<span class="built_in">pb</span>({x[<span class="number">6</span>]<span class="number">+1</span>,y[<span class="number">6</span>]<span class="number">+1</span>,<span class="number">1</span>}),C.<span class="built_in">pb</span>({x[<span class="number">5</span>],y[<span class="number">5</span>],<span class="number">1</span>}),C.<span class="built_in">pb</span>({x[<span class="number">6</span>]<span class="number">+1</span>,y[<span class="number">5</span>],<span class="number">-1</span>}),C.<span class="built_in">pb</span>({x[<span class="number">5</span>],y[<span class="number">6</span>]<span class="number">+1</span>,<span class="number">-1</span>});</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> a:A) <span class="keyword">for</span>(<span class="keyword">auto</span> b:B) <span class="keyword">for</span>(<span class="keyword">auto</span> c:C) <span class="built_in">sol</span>(a,b,c);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å¸¸ç”¨ç»„åˆæ’ç­‰å¼</title>
      <link href="/notes/%E5%B8%B8%E7%94%A8%E7%BB%84%E5%90%88%E6%81%92%E7%AD%89%E5%BC%8F/"/>
      <url>/notes/%E5%B8%B8%E7%94%A8%E7%BB%84%E5%90%88%E6%81%92%E7%AD%89%E5%BC%8F/</url>
      
        <content type="html"><![CDATA[<p>é™åˆ¶æ¡ä»¶åœ¨ OI ä¸­åŸºæœ¬ç”¨ä¸åˆ°ï¼Œå°±ä¸å†™äº†ã€‚</p><script type="math/tex; mode=display">\begin{align}& \binom{n}{m} = \frac{n!}{m!(n-m)!} \\& \binom{n}{m} = \binom{n}{n-m} \\& \binom{n}{m} = \frac{n}{m} \binom{n-1}{m-1} \\& \binom{n}{m} = \binom{n-1}{m} + \binom{n-1}{m-1} \\& \binom{n}{m} = (-1)^{m} \binom{m-n-1}{m} \\& \binom{a}{b}\binom{b}{c} = \binom{a}{c}\binom{a-c}{b-c} \\& (a+b)^{n} = \sum_{i=0}^{n} \binom{n}{i} a^ib^{n-i} \\& \sum_{i=0}^{n} \binom{i}{m} = \binom{n+1}{m+1} \\& \sum_{i} \binom{a}{i} \binom{b}{n-i} = \binom{a+b}{n} \\& \sum_{\sum i_j = n} \prod \binom{a_i}{i_j} = \binom{\sum a_i}{n}\end{align}</script>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜âš¡âŒ P3214 [HNOI2011] å¡å†œ</title>
      <link href="/solutions/P3214/"/>
      <url>/solutions/P3214/</url>
      
        <content type="html"><![CDATA[<blockquote><p>ä» $[1,2^n)$ ä¸­é€‰æ‹© $m$ ä¸ªäº’ä¸ç›¸åŒä¸”å¼‚æˆ–å’Œä¸º $0$ çš„æ•°ï¼Œæ±‚æ–¹æ¡ˆæ•°ã€‚</p><p>$1 \le n,m \le 10^6$ã€‚</p></blockquote><p>è€ƒè™‘ DPï¼Œè®° $f_i$ ä¸ºé€‰æ‹© $i$ ä¸ªæ•°çš„æ–¹æ¡ˆæ•°ã€‚å…ˆè€ƒè™‘é¡ºåºï¼Œè¿™æ ·é€‰æ‹©çš„æ•°ä¸ä¼šæœ‰é¡ºåºçš„é™åˆ¶ï¼Œæœ€åå†é™¤ m! å¾—åˆ°ç­”æ¡ˆã€‚</p><p>å‘ç°ç¡®å®šå‰ $i-1$ ä¸ªæ•°å°±å¯ä»¥é€šè¿‡å¼‚æˆ–å’Œä¸º $0$ çš„æ¡ä»¶å¾—åˆ°ç¬¬ $i$ ä¸ªæ•°ï¼Œé‚£ä¹ˆå¾—åˆ°åˆå§‹æ–¹æ¡ˆæ•° $\binom{2^n-1}{i-1}(i-1)!$ã€‚è®°å‰ $i-1$ ä¸ªæ•°çš„å¼‚æˆ–å’Œä¸º $u$ï¼Œé‚£ä¹ˆ $i$ å¡« $u$ã€‚è€ƒè™‘ä¸åˆæ³•çš„æ–¹æ¡ˆï¼Œå‡å» $u=0$ å’Œ $u$ å‡ºç°ä¸¤æ¬¡çš„æ–¹æ¡ˆï¼Œå‰©ä¸‹çš„éƒ½åˆæ³•ã€‚å¾—åˆ°è½¬ç§»å¼</p><script type="math/tex; mode=display">f_i = \binom{2^n-1}{i-1}(i-1)! - f_{i-1} - (i-1)(2^n-1-(i-2))f_{i-2}</script><p>åˆå€¼ $f_1=f_2=0$ã€‚æ—¶é—´å¤æ‚åº¦ $O(m)$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span><span class="number">+10</span>,MOD=<span class="number">1e8</span><span class="number">+7</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y=MOD<span class="number">-2</span>)</span></span>{ <span class="type">int</span> res=<span class="number">1</span>; <span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=<span class="number">1ll</span>*x*x%MOD) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=<span class="number">1ll</span>*res*x%MOD; <span class="keyword">return</span> res; }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">mod</span><span class="params">(<span class="type">int</span> &amp;x)</span></span>{ <span class="keyword">if</span>(x&gt;=MOD) x-=MOD; <span class="keyword">if</span>(x&lt;<span class="number">0</span>) x+=MOD; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> jc[N],fjc[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">(<span class="type">int</span> n)</span></span>{</span><br><span class="line">jc[<span class="number">0</span>]=<span class="number">1</span>; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) jc[i]=<span class="number">1ll</span>*jc[i<span class="number">-1</span>]*i%MOD;</span><br><span class="line">fjc[n]=<span class="built_in">qm</span>(jc[n]); <span class="keyword">for</span>(<span class="type">int</span> i=n<span class="number">-1</span>;~i;--i) fjc[i]=<span class="number">1ll</span>*fjc[i<span class="number">+1</span>]*(i<span class="number">+1</span>)%MOD;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,pw,A[N],f[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd,pw=<span class="built_in">qm</span>(<span class="number">2</span>,n),<span class="built_in">init</span>(m);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=A[<span class="number">0</span>]=<span class="number">1</span>;i&lt;=m;++i) A[i]=<span class="number">1ll</span>*A[i<span class="number">-1</span>]*(pw-i)%MOD;</span><br><span class="line"></span><br><span class="line">f[<span class="number">1</span>]=f[<span class="number">2</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">3</span>;i&lt;=m;++i){</span><br><span class="line"><span class="built_in">mod</span>(f[i]=A[i<span class="number">-1</span>]-f[i<span class="number">-1</span>]);</span><br><span class="line"><span class="built_in">mod</span>(f[i]-=<span class="number">1ll</span>*(pw<span class="number">-1</span>-(i<span class="number">-2</span>))*(i<span class="number">-1</span>)%MOD*f[i<span class="number">-2</span>]%MOD);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="number">1ll</span>*f[m]*fjc[m]%MOD);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜´âš¡â­• P8907 [USACO22DEC] Making Friends P</title>
      <link href="/solutions/P8907/"/>
      <url>/solutions/P8907/</url>
      
        <content type="html"><![CDATA[<blockquote><p>$n$ ä¸ªç‚¹ $m$ æ¡è¾¹çš„æ— å‘å›¾ï¼ŒæŒ‰ç¼–å·ä»å°åˆ°å¤§ä¾æ¬¡åˆ ç‚¹ï¼Œæ¯æ¬¡åˆ ç‚¹åå°†å…¶é‚»ç‚¹è¡¥æˆå®Œå…¨å›¾ï¼Œæ±‚æ–°å¢è¾¹æ•°ã€‚</p><p>$1 \le n,m \le 2 \times 10^5$ã€‚</p></blockquote><p>æœ€å $(i,j)(i &lt; j)$ æœ‰è¿è¾¹å½“å‰ä»…å½“åŸå›¾å­˜åœ¨ $i \to j$ çš„è·¯å¾„ä½¿å¾—è·¯å¾„ä¸Šç‚¹ï¼ˆé™¤ $j$ å¤–ï¼‰çš„ç¼–å·å‡ $\le i$ã€‚</p><p>è€ƒè™‘æšä¸¾ $i$ ç»Ÿè®¡ä¸Šè¿°ç‚¹å¯¹çš„æ•°é‡ï¼Œæœ€åå‡å» $m$ å³ä¸ºç­”æ¡ˆã€‚                             </p><p>æŒ‰ç¼–å·ä»å°åˆ°å¤§æšä¸¾ $i$ï¼Œæšä¸¾è¿‡çš„ç‚¹æ ‡ $1$ï¼Œæœªæšä¸¾çš„æ ‡ $0$ã€‚é‚£ä¹ˆ $j$ çš„æ•°é‡å³ä¸º $i$ æ‰€åœ¨çš„ $1$ è¿é€šå—ç›¸é‚»çš„ $0$ ç‚¹çš„æ•°é‡ã€‚</p><p>ç”¨å¹¶æŸ¥é›†ç»´æŠ¤è¿é€šå—ï¼Œç”¨ <code>set</code> è®°å½•ç›¸é‚»çš„ $0$ ç‚¹ã€‚å½“æšä¸¾åˆ° $i$ æ—¶ï¼Œå…ˆå°†ç›¸é‚»çš„ $0$ ç‚¹åŠ å…¥å¯¹åº”çš„ <code>set</code>ï¼Œå†ä¸ç›¸é‚»çš„ $1$ ç‚¹åˆå¹¶ï¼Œ$j$ çš„æ•°é‡å³ä¸ºå¯¹åº” <code>set</code> çš„å¤§å°ã€‚å¯å‘å¼åˆå¹¶ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> ll=<span class="type">long</span> <span class="type">long</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> U(x) ((int)x.size())</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">2e5</span><span class="number">+100</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m; ll ans=<span class="number">0</span>;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> fa[N],siz[N]; set&lt;<span class="type">int</span>&gt; s[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>{ <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) fa[i]=i,siz[i]=<span class="number">1</span>; }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>{ <span class="keyword">return</span> fa[x]==x?x:fa[x]=<span class="built_in">find</span>(fa[x]); }</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">mer</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">x=<span class="built_in">find</span>(x),y=<span class="built_in">find</span>(y); <span class="keyword">if</span>(x==y) <span class="keyword">return</span>;</span><br><span class="line"><span class="keyword">if</span>(siz[x]&lt;siz[y]) <span class="built_in">swap</span>(x,y);</span><br><span class="line">fa[y]=x,siz[x]+=siz[y]; <span class="keyword">for</span>(<span class="keyword">auto</span> v:s[y]) s[x].<span class="built_in">insert</span>(v);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd,<span class="built_in">init</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y;i&lt;=m;++i) G[x=rd].<span class="built_in">pb</span>(y=rd),G[y].<span class="built_in">pb</span>(x);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> u=<span class="number">1</span>;u&lt;=n;++u){</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> v:G[u]) <span class="keyword">if</span>(v&gt;u) s[u].<span class="built_in">insert</span>(v);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> v:G[u]) <span class="keyword">if</span>(v&lt;u) <span class="built_in">mer</span>(v,u);</span><br><span class="line"><span class="keyword">if</span>(s[<span class="built_in">find</span>(u)].<span class="built_in">count</span>(u)) s[<span class="built_in">find</span>(u)].<span class="built_in">erase</span>(u); <span class="comment">//æ­¤æ—¶ u ä¸æ˜¯ 0 ç‚¹ï¼Œå¦‚æœæœ‰è¦åˆ å»ã€‚</span></span><br><span class="line">ans+=<span class="built_in">U</span>(s[<span class="built_in">find</span>(u)]);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, ans-m);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜±â„ï¸âŒ QOJ171 Longest Shortest Path</title>
      <link href="/solutions/QOJ171/"/>
      <url>/solutions/QOJ171/</url>
      
        <content type="html"><![CDATA[<p>å°†æœ€çŸ­è·¯å†™æˆçº¿æ€§è§„åˆ’å½¢å¼ã€‚</p><script type="math/tex; mode=display">\begin{align}\max \quad & p_t-p_s \\ \texttt{s.t.} \quad& p_v-p_u \le d_e+x_e \\& \sum_{e} c_ex_e \le P \\& x_e,p_u \ge 0 \end{align}</script><p>çº¿æ€§è§„åˆ’å¯¹å¶ï¼Œè®° $out_u,in_u$ åˆ†åˆ«ä¸º $u$ çš„å‡ºã€å…¥è¾¹é›†åˆã€‚é‚£ä¹ˆç­‰ä»·äº</p><script type="math/tex; mode=display">\begin{align}\min \quad & \sum_{e} d_ef_e + PF \\\texttt{s.t.} \quad& \sum_{e \in in_s} f_e - \sum_{e \in out_s} f_e \ge -1 \\& \sum_{e \in in_t} f_e - \sum_{e \in out_t} f_e \ge 1 \\& \sum_{e \in in_u} f_e - \sum_{e \in out_u} f_e \ge 0 \quad u \in V \setminus \{s,t\} \\& c_eF - f_e \ge 0 \\& F,f_e \ge 0\end{align}</script><p>ç”±äºè¦å– $\min$ ï¼Œæ‰€ä»¥å‰ä¸‰ä¸ªçº¦æŸå–ç­‰å·æ›´ä¼˜ï¼Œå‘ç°æ˜¯ç½‘ç»œæµçš„é™åˆ¶ï¼Œå³</p><script type="math/tex; mode=display">\begin{align}\min \quad & \sum_{e} d_ef_e + PF \\\texttt{s.t.} \quad& f ä¸º s åˆ° t æµé‡ä¸º 1 çš„æµ \\& c_eF - f_e \ge 0 \\& F,f_e \ge 0\end{align}</script><p>è¦å°† $c_eF - f_e \ge 0$ è½¬åŒ–ä¸ºæµé‡çš„é™åˆ¶ï¼Œä»¤ $fâ€™_e = \frac{f_e}{F}$ï¼Œåˆ™</p><script type="math/tex; mode=display">\begin{align}\min \quad & (\sum_{e} d_ef'_e + P)F \\\texttt{s.t.} \quad& f' ä¸º s åˆ° t æµé‡ä¸º \frac{1}{F} çš„æµ \\& f'_e \le c_e \\& F > 0,f'_e \ge 0\end{align}</script><p>è¿™æ˜¯è´¹ç”¨æµçš„å½¢å¼ï¼Œ$\sum_e d_efâ€™_e + P$ å…³äº $\frac{1}{F}$ æ˜¯å‡¸çš„ï¼Œé‚£ä¹ˆ $(\sum_{e} d_efâ€™_e + P)F$ çš„æœ€å°å€¼åœ¨å‡¸åŒ…çš„ç«¯ç‚¹å¤„å–åˆ°ï¼Œç”¨ EK æ±‚è§£è´¹ç”¨æµï¼Œæ¯æ¬¡å¢å¹¿åæ›´æ–°ç­”æ¡ˆå³å¯ã€‚è®° $F$ ä¸º $c$ çš„ä¸Šç•Œï¼Œæ—¶é—´å¤æ‚åº¦ $O(Fnm^2)$ï¼Œå®é™…ä¸Šè¿œè¿œè·‘ä¸æ»¡ã€‚</p><p>è¿˜å¯ä»¥ç”¨æ‹‰æ ¼æœ—æ—¥å¯¹å¶ï¼Œ<a href="/notes/æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°åŠå…¶å¯¹å¶">è¯¦è§</a>ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> db=<span class="type">double</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">200</span><span class="number">+10</span>,M=<span class="number">2e3</span><span class="number">+10</span>,INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">chkmin</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> y)</span></span>{ <span class="keyword">return</span> y&lt;x?x=y,<span class="number">1</span>:<span class="number">0</span>; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,s,t,P,maxflow=<span class="number">0</span>,mincost=<span class="number">0</span>; db ans=INF;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> head[N],ne[M*<span class="number">2</span>],v[M*<span class="number">2</span>],fl[M*<span class="number">2</span>],w[M*<span class="number">2</span>],tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> f,<span class="type">int</span> z)</span></span>{</span><br><span class="line">ne[++tot]=head[x],head[x]=tot,v[tot]=y,fl[tot]=f,w[tot]=z;</span><br><span class="line">ne[++tot]=head[y],head[y]=tot,v[tot]=x,fl[tot]=<span class="number">0</span>,w[tot]=-z;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dis[N],vis[N],pre[N],idx[N]; queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">spfa</span><span class="params">()</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) dis[i]=INF,vis[i]=<span class="number">0</span>; q.<span class="built_in">push</span>(s),dis[s]=<span class="number">0</span>,vis[s]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line"><span class="type">int</span> u=q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>(),vis[u]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=ne[i])</span><br><span class="line"><span class="keyword">if</span>(fl[i]&amp;&amp;<span class="built_in">chkmin</span>(dis[v[i]],dis[u]+w[i]))</span><br><span class="line">pre[v[i]]=u,idx[v[i]]=i,q.<span class="built_in">push</span>(v[i]),vis[v[i]]=<span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> dis[t]!=INF;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd,P=rd,s=rd,t=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y,z,f;i&lt;=m;++i) x=rd,y=rd,z=rd,f=rd,<span class="built_in">add</span>(x,y,f,z);</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">spfa</span>()){</span><br><span class="line"><span class="type">int</span> dflow=INF; <span class="keyword">for</span>(<span class="type">int</span> i=t;i!=s;i=pre[i]) dflow=<span class="built_in">min</span>(dflow,fl[idx[i]]);</span><br><span class="line">maxflow+=dflow,mincost+=dis[t]*dflow;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=t;i!=s;i=pre[i]) fl[idx[i]]-=dflow,fl[idx[i]^<span class="number">1</span>]+=dflow;</span><br><span class="line">ans=<span class="built_in">min</span>(ans,(db)(P+mincost)/maxflow);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%.6lf\n"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°åŠå…¶å¯¹å¶</title>
      <link href="/notes/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%81%B6/"/>
      <url>/notes/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A5%E4%B9%98%E6%95%B0%E5%8F%8A%E5%85%B6%E5%AF%B9%E5%81%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æ±‚å¤šå…ƒå‡½æ•° $f(x)$ åœ¨æ»¡è¶³ $g_i(x)=0$ çš„æå€¼ã€‚è®¾ä¸€ä¸ªä¹˜æ•° $\lambda$ï¼Œæ±‚ä¸‹é¢å¤šå…ƒå‡½æ•°çš„æå€¼</p><script type="math/tex; mode=display">f(x,\lambda)=f(x)+\sum_{i} \lambda_ig_i(x)</script><blockquote><p><strong>ä¾‹</strong> æ±‚ $y=\frac{1}{x}$ åˆ°åŸç‚¹æœ€è¿‘çš„ç‚¹ã€‚</p><p>å³åœ¨æ»¡è¶³ $g(x,y)=xy-1=0$ çš„æ¡ä»¶ä¸‹ï¼Œæœ€å°åŒ– $f(x,y)=x^2+y^2$ã€‚</p><p>è®¾ä¹˜æ•° $\lambda$ï¼Œæœ€å°åŒ– $f(x,y,\lambda)=f(x,y)+\lambda g(x,y)=x^2+y^2+\lambda xy-\lambda$ã€‚</p><p>åˆ†åˆ«å¯¹ $x,y,\lambda$ æ±‚å¯¼ï¼Œä»¤å¯¼æ•°ä¸º $0$ï¼Œå¾—åˆ°</p><script type="math/tex; mode=display">\left \{\begin{matrix}2x+\lambda y = 0 \\2y+\lambda x = 0 \\xy-1 = 0\end{matrix}\right.</script><p>è§£å¾—</p><script type="math/tex; mode=display">\left \{\begin{matrix}x = 1 \\y = 1 \\\lambda = -2\end{matrix}\right.æˆ–\\left \{\begin{matrix}x = -1 \\y = -1 \\\lambda = -2\end{matrix}\right.</script></blockquote><p>çº¿æ€§è§„åˆ’å¯¹å¶å¯ä»¥å¾—åˆ°æ–¹ä¾¿çš„æœºæ¢°åŒ–æ–¹æ³•ã€‚ä¸ä¼šè¯æ˜ï¼Œä¸‹é¢åªè®²æ–¹æ³•ã€‚</p><ul><li><p>å°†çº¿æ€§çº¦æŸè½¬åŒ–ä¸º $â€¦ \le 0$ çš„å½¢å¼ã€‚</p></li><li><p>å¯¹æ¯ä¸ªçº¦æŸè®¾ä¸€ä¸ªä¹˜æ•° $\lambda$ï¼Œè‹¥æ±‚ $\min$ é‚£ä¹ˆé™åˆ¶ $\lambda \ge 0$ï¼Œå¦åˆ™é™åˆ¶ $\lambda \le 0$ã€‚</p></li><li><p>å°†çº¦æŸä¹˜ä¹˜æ•°å†™å…¥æœ€ä¼˜åŒ–å‡½æ•°ï¼Œå³æ±‚ $L(x,\lambda)$ çš„æœ€å€¼ã€‚å°† $L(x,\lambda)$ è½¬åŒ–ä¸ºä»¥ $x$ ä¸ºä¸»å…ƒçš„å½¢å¼ï¼Œé€šè¿‡é™åˆ¶ç³»æ•°ä½¿å¾— $L(x,\lambda)$ ä¸ä¼šå–åˆ° $\infty/-\infty$ã€‚</p></li><li><p>å°† $\min/\max$ å–åï¼Œå°†å¸¦ $x$ çš„é¡¹åˆ å»å¾—åˆ°æ–°çš„æœ€ä¼˜åŒ–å‡½æ•°ã€‚</p></li></ul><blockquote><p><strong>ä¾‹</strong> <a href="https://www.luogu.com.cn/problem/AT_icpc2015autumn_j">Longest Shortest Path</a></p><p>éœ€è¦å°†ä¸‹å¼å¯¹å¶</p><script type="math/tex; mode=display">\begin{align}\max \quad & p_t-p_s \\ \texttt{s.t.} \quad& p_v-p_u \le d_e+x_e \\& \sum_{e} c_ex_e \le P \\& x_e,p_u \ge 0 \end{align}</script><p>æ”¹å†™ä¸º</p><script type="math/tex; mode=display">\begin{align}\max \quad & p_t-p_s \\ \texttt{s.t.} \quad& p_v-p_u-x_e-d_e \le 0 \\& \sum_{e} c_ex_e-P \le 0 \\& x_e,p_u \ge 0 \end{align}</script><p>è®¾ä¹˜æ•° $f_e,F$ å¾—åˆ°</p><script type="math/tex; mode=display">(\sum_{e \in in_s} f_e - \sum_{e \in out_s} f_e - 1) p_s \\ + (\sum_{e \in in_s} f_e - \sum_{e \in out_s} f_e + 1) p_t \\ + \sum_{u \in V \setminus \{s,t\}} (\sum_{e \in in_s} f_e - \sum_{e \in out_s}) p_u \\ + \sum_{e} (c_eF-f_e)x_e - \sum_{e} f_ed_e - FP</script><p>ä¸ºé˜²æ­¢å–åˆ° $\infty$ï¼Œå°†ç³»æ•°é™åˆ¶ä¸º $\le 0$ï¼Œå¾—åˆ°å¯¹å¶</p><script type="math/tex; mode=display">\begin{align}\min \quad & \sum_{e} -d_ef_e - PF \\\texttt{s.t.} \quad& \sum_{e \in in_s} f_e - \sum_{e \in out_s} f_e \le 1 \\& \sum_{e \in in_t} f_e - \sum_{e \in out_t} f_e \le -1 \\& \sum_{e \in in_u} f_e - \sum_{e \in out_u} f_e \le 0 \quad u \in V \setminus \{s,t\} \\& c_eF - f_e \le 0 \\& F,f_e \le 0\end{align}</script><p>å°† $f_e,F$ å–åå¾—åˆ°</p><script type="math/tex; mode=display">\begin{align}\min \quad & \sum_{e} d_ef_e + PF \\\texttt{s.t.} \quad& \sum_{e \in in_s} f_e - \sum_{e \in out_s} f_e \ge -1 \\& \sum_{e \in in_t} f_e - \sum_{e \in out_t} f_e \ge 1 \\& \sum_{e \in in_u} f_e - \sum_{e \in out_u} f_e \ge 0 \quad u \in V \setminus \{s,t\} \\& c_eF - f_e \ge 0 \\& F,f_e \ge 0\end{align}</script></blockquote><p>å¯¹äºä¸€èˆ¬çš„æ‹‰æ ¼æœ—æ—¥å¯¹å¶ï¼Œæœ€ä¼˜åŒ–å‡½æ•°æ»¡è¶³å‡¸ä¼˜åŒ–å’Œ slater æ¡ä»¶æ˜¯å¼ºå¯¹å¶çš„å……åˆ†æ¡ä»¶ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-NOI2012-éª‘è¡Œå·è—"><a href="#1-NOI2012-éª‘è¡Œå·è—" class="headerlink" title="1.[NOI2012] éª‘è¡Œå·è—"></a><a href="https://www.luogu.com.cn/problem/P2179">1.[NOI2012] éª‘è¡Œå·è—</a></h4><script type="math/tex; mode=display">\begin{align}\min \quad & \sum_{i} \frac{s_i}{v_i} \\\texttt{s.t.} \quad& \sum_{i} s_ik_i(v_i-v'_i)^2 \le E \\& v_i \ge v'_i \\& v_i > 0\end{align}</script><p>è´ªå¿ƒï¼Œä»¤ $\sum_{i} s_ik_i(v_i-vâ€™_i)^2=E$ å³å¯ã€‚</p><p>ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ï¼Œå¾—åˆ°</p><script type="math/tex; mode=display">\begin{align}2 \lambda k_iv_i^2(v_i-v'_i) &= 1 \tag{1} \\\sum_{i} s_ik_i(v_i-v'_i)^2 &= E \tag{2}\end{align}</script><p>å¯¹äºç»™å®šçš„ $\lambda$ï¼Œé€šè¿‡ $(1)$ å¼è®¡ç®— $v_i$ å¹¶å¸¦å…¥ $(2)$ å¼åˆ¤æ–­å³å¯ã€‚å‘ç° $\lambda$ é€’å¢æ—¶ $v_i$ é€’å‡ï¼ŒäºŒåˆ† $\lambda$ å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log^2V)$ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/4xdbun0b">[OIç¬”è®°]åˆ©ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•æ±‚å‡½æ•°çš„æœ€å€¼</a></p><p><a href="https://www.cnblogs.com/yyyyxh/p/17939643/LPdual">åœ¨ OI ä¸­æ›´æ˜“ä¸Šæ‰‹çš„çº¿æ€§è§„åˆ’å¯¹å¶</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>é•¿é“¾å‰–åˆ†</title>
      <link href="/notes/%E9%95%BF%E9%93%BE%E5%89%96%E5%88%86/"/>
      <url>/notes/%E9%95%BF%E9%93%BE%E5%89%96%E5%88%86/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä»¥å­æ ‘ä¸­æœ€å¤§æ·±åº¦æœ€å¤§çš„å„¿å­ä¸ºé‡å„¿å­ã€‚</p><ul><li><p>é“¾çš„é•¿åº¦å’Œä¸º $n$ã€‚</p></li><li><p>è‹¥é“¾ $L_1$ å‘ä¸Šè·³åˆ° $L_2$ï¼Œé‚£ä¹ˆ $L_2 \ge L_1+1$ã€‚</p></li><li><p>ç‚¹åˆ°æ ¹èŠ‚ç‚¹è·¯å¾„ä¸Šæœ‰ $O(\sqrt{n})$ æ¡é“¾ã€‚</p></li></ul><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-ã€æ¨¡æ¿ã€‘æ ‘ä¸Š-K-çº§ç¥–å…ˆ"><a href="#1-ã€æ¨¡æ¿ã€‘æ ‘ä¸Š-K-çº§ç¥–å…ˆ" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘æ ‘ä¸Š K çº§ç¥–å…ˆ"></a><a href="https://www.luogu.com.cn/problem/P5903">1.ã€æ¨¡æ¿ã€‘æ ‘ä¸Š K çº§ç¥–å…ˆ</a></h4><p>$k$ çº§ç¥–å…ˆæ‰€åœ¨é“¾çš„é•¿åº¦ $\ge k+1$ã€‚è€ƒè™‘æ‰¾åˆ° $kâ€™ \ge \frac{k}{2}$ çº§ç¥–å…ˆ $x$ï¼Œé‚£ä¹ˆ $k$ çº§ç¥–å…ˆåˆ° $x$ çš„è·ç¦»ä¸è¶…è¿‡ $x$ æ‰€åœ¨é“¾é•¿ã€‚</p><p>å¯¹æ¯ä¸ªé“¾å¤´ç»´æŠ¤æ‰€åœ¨é“¾çš„é›†åˆå’Œå‘ä¸Šè·³ä¸è¶…è¿‡é“¾é•¿çš„é›†åˆã€‚å– $kâ€™$ ä¸º $k$ çš„äºŒè¿›åˆ¶æœ€é«˜ä½ã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log n)-O(1)$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/7rdq0fum">code</a></p><h4 id="2-Dominant-Indices"><a href="#2-Dominant-Indices" class="headerlink" title="2.Dominant Indices"></a><a href="https://www.luogu.com.cn/problem/CF1009F">2.Dominant Indices</a></h4><p>å®ç°æ—¶ç”¨æŒ‡é’ˆï¼Œæ—¶ç©ºå¤æ‚åº¦å‡ä¸º $O(n)$ã€‚</p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span> </span></span><br><span class="line">using namespace <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e6</span>+<span class="number">100</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="keyword">inline</span> <span class="type">int</span> <span class="title function_">read</span><span class="params">()</span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,ans[N],*f[N],tmp[N],*cur=tmp+<span class="number">1</span>;</span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="type">int</span>&gt; G[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> dep[N],mx[N],son[N];</span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs0</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fu)</span>{</span><br><span class="line">mx[u]=dep[u]=dep[fu]+<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> v:G[u]){</span><br><span class="line"><span class="keyword">if</span>(v==fu) <span class="keyword">continue</span>;</span><br><span class="line">dfs0(v,u),mx[u]=max(mx[u],mx[v]);</span><br><span class="line"><span class="keyword">if</span>(mx[v]&gt;mx[son[u]]) son[u]=v;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">inline</span> <span class="type">void</span> <span class="title function_">assign</span><span class="params">(<span class="type">int</span> u)</span>{ f[u]=cur,cur+=mx[u]-dep[u]+<span class="number">1</span>; }</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs1</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fu)</span>{</span><br><span class="line"><span class="keyword">if</span>(son[u]) f[son[u]]=f[u]+<span class="number">1</span>,dfs1(son[u],u),ans[u]=ans[son[u]]+<span class="number">1</span>;</span><br><span class="line">f[u][<span class="number">0</span>]=<span class="number">1</span>; <span class="keyword">if</span>(f[u][<span class="number">0</span>]&gt;=f[u][ans[u]]) ans[u]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> v:G[u]){</span><br><span class="line"><span class="keyword">if</span>(v==fu||v==son[u]) <span class="keyword">continue</span>; assign(v),dfs1(v,u);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=mx[v]-dep[v];++i){</span><br><span class="line">f[u][i+<span class="number">1</span>]+=f[v][i];</span><br><span class="line"><span class="keyword">if</span>(f[u][i+<span class="number">1</span>]&gt;f[u][ans[u]]||(f[u][i+<span class="number">1</span>]==f[u][ans[u]]&amp;&amp;i+<span class="number">1</span>&lt;ans[u])) ans[u]=i+<span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>{</span><br><span class="line"></span><br><span class="line">n=rd; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y;i&lt;n;i++) G[x=rd].pb(y=rd),G[y].pb(x);</span><br><span class="line"></span><br><span class="line">dfs0(<span class="number">1</span>,<span class="number">0</span>),assign(<span class="number">1</span>),dfs1(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h4 id="3-WC2010-é‡å»ºè®¡åˆ’"><a href="#3-WC2010-é‡å»ºè®¡åˆ’" class="headerlink" title="3.[WC2010] é‡å»ºè®¡åˆ’"></a><a href="https://www.luogu.com.cn/problem/P4292">3.[WC2010] é‡å»ºè®¡åˆ’</a></h4><p>äºŒåˆ†ï¼Œé•¿é“¾å‰–åˆ†ä¼˜åŒ– DPï¼Œåˆå¹¶éœ€è¦æŸ¥è¯¢åŒºé—´é•¿åº¦ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/522npqp1">é•¿é“¾å‰–åˆ†</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>SAM</title>
      <link href="/notes/SAM/"/>
      <url>/notes/SAM/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¢é‡æ³•æ„é€ ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">TREE</span>{ <span class="type">int</span> ne[SZ],fa,len,siz; }t[N&lt;&lt;<span class="number">1</span>]; <span class="type">int</span> las=<span class="number">1</span>,tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> c)</span></span>{</span><br><span class="line">    <span class="type">int</span> p=las,np=++tot,v,nv; las=np,t[np].len=t[p].len<span class="number">+1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;p&amp;&amp;!t[p].ne[c];p=t[p].fa) t[p].ne[c]=np;</span><br><span class="line">    <span class="keyword">if</span>(!p) <span class="keyword">return</span> t[np].fa=<span class="number">1</span>,<span class="built_in">void</span>(); v=t[p].ne[c];</span><br><span class="line">    <span class="keyword">if</span>(t[v].len==t[p].len<span class="number">+1</span>) <span class="keyword">return</span> t[np].fa=v,<span class="built_in">void</span>();</span><br><span class="line">    t[nv=++tot]=t[v],t[nv].len=t[p].len<span class="number">+1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;p&amp;&amp;t[p].ne[c]==v;p=t[p].fa) t[p].ne[c]=nv;</span><br><span class="line">    t[v].fa=t[np].fa=nv;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="æ™®é€šåç¼€è‡ªåŠ¨æœº"><a href="#æ™®é€šåç¼€è‡ªåŠ¨æœº" class="headerlink" title="æ™®é€šåç¼€è‡ªåŠ¨æœº"></a>æ™®é€šåç¼€è‡ªåŠ¨æœº</h2><h4 id="1-ã€æ¨¡æ¿ã€‘åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰"><a href="#1-ã€æ¨¡æ¿ã€‘åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰"></a><a href="https://www.luogu.com.cn/problem/P3804">1.ã€æ¨¡æ¿ã€‘åç¼€è‡ªåŠ¨æœºï¼ˆSAMï¼‰</a></h4><p>åç¼€è‡ªåŠ¨æœºèŠ‚ç‚¹çš„ endpos é›†åˆå¤§å°å³ä¸ºå½“å‰èŠ‚ç‚¹å­—ç¬¦ä¸²çš„å‡ºç°æ¬¡æ•°ã€‚</p><h4 id="2-ä¸åŒå­ä¸²ä¸ªæ•°"><a href="#2-ä¸åŒå­ä¸²ä¸ªæ•°" class="headerlink" title="2.ä¸åŒå­ä¸²ä¸ªæ•°"></a><a href="https://www.luogu.com.cn/problem/P2408">2.ä¸åŒå­ä¸²ä¸ªæ•°</a></h4><ul><li><p>æ³•ä¸€ DAG ä¸Š DP</p><p>æ€§è´¨ï¼šä»»æ„ä¸¤ä¸ªèŠ‚ç‚¹çš„è¡¨ç¤ºé›†åˆæ²¡æœ‰äº¤ã€‚</p><p>è®° $f_u$ ä¸ºä» $u$ å‡ºå‘çš„è·¯å¾„æ¡æ•°å³å¯ã€‚</p></li><li><p>æ³•äºŒ ç»Ÿè®¡æ ‘ä¸Šæ¯ä¸ªèŠ‚ç‚¹çš„å­—ç¬¦ä¸²ä¸ªæ•°å³å¯ã€‚</p></li></ul><h4 id="3-SDOI2016-ç”Ÿæˆé­”å’’-æ´›è°·"><a href="#3-SDOI2016-ç”Ÿæˆé­”å’’-æ´›è°·" class="headerlink" title="3.[SDOI2016] ç”Ÿæˆé­”å’’ - æ´›è°·"></a><a href="https://www.luogu.com.cn/problem/P4070">3.[SDOI2016] ç”Ÿæˆé­”å’’ - æ´›è°·</a></h4><h4 id="4-TJOI2015-å¼¦è®º-æ´›è°·"><a href="#4-TJOI2015-å¼¦è®º-æ´›è°·" class="headerlink" title="4.[TJOI2015] å¼¦è®º - æ´›è°·"></a><a href="https://www.luogu.com.cn/problem/P3975">4.[TJOI2015] å¼¦è®º - æ´›è°·</a></h4><h2 id="åç¼€è‡ªåŠ¨æœºå’Œ-AC-è‡ªåŠ¨æœº"><a href="#åç¼€è‡ªåŠ¨æœºå’Œ-AC-è‡ªåŠ¨æœº" class="headerlink" title="åç¼€è‡ªåŠ¨æœºå’Œ AC è‡ªåŠ¨æœº"></a>åç¼€è‡ªåŠ¨æœºå’Œ AC è‡ªåŠ¨æœº</h2><p>parent æ ‘å¯ä»¥çœ‹æˆå¯¹æ‰€æœ‰å­ä¸²å»ºç«‹ AC è‡ªåŠ¨æœºã€‚</p><h4 id="1-LCS-Longest-Common-Substring"><a href="#1-LCS-Longest-Common-Substring" class="headerlink" title="1.LCS - Longest Common Substring"></a><a href="https://www.luogu.com.cn/problem/SP1811">1.LCS - Longest Common Substring</a></h4><h4 id="2-Cyclical-Quest"><a href="#2-Cyclical-Quest" class="headerlink" title="2.Cyclical Quest"></a><a href="https://www.luogu.com.cn/problem/CF235C">2.Cyclical Quest</a></h4><h4 id="3-BJOI2020-å°å°"><a href="#3-BJOI2020-å°å°" class="headerlink" title="3.[BJOI2020] å°å°"></a><a href="https://www.luogu.com.cn/problem/P6640">3.[BJOI2020] å°å°</a></h4><h2 id="åç¼€è‡ªåŠ¨æœºå’Œåç¼€æ ‘"><a href="#åç¼€è‡ªåŠ¨æœºå’Œåç¼€æ ‘" class="headerlink" title="åç¼€è‡ªåŠ¨æœºå’Œåç¼€æ ‘"></a>åç¼€è‡ªåŠ¨æœºå’Œåç¼€æ ‘</h2><p>åä¸²çš„ parent æ ‘å°±æ˜¯åç¼€æ ‘ã€‚</p><h4 id="1-AHOI2013-å·®å¼‚"><a href="#1-AHOI2013-å·®å¼‚" class="headerlink" title="1.[AHOI2013] å·®å¼‚"></a><a href="https://www.luogu.com.cn/problem/P4248">1.[AHOI2013] å·®å¼‚</a></h4><h4 id="2-åäºŒçœè”è€ƒ-2019-å­—ç¬¦ä¸²é—®é¢˜"><a href="#2-åäºŒçœè”è€ƒ-2019-å­—ç¬¦ä¸²é—®é¢˜" class="headerlink" title="2.[åäºŒçœè”è€ƒ 2019] å­—ç¬¦ä¸²é—®é¢˜"></a><a href="https://www.luogu.com.cn/problem/P5284">2.[åäºŒçœè”è€ƒ 2019] å­—ç¬¦ä¸²é—®é¢˜</a></h4><h2 id="å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº"><a href="#å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº" class="headerlink" title="å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº"></a>å¹¿ä¹‰åç¼€è‡ªåŠ¨æœº</h2><p>å°±æ˜¯åç¼€è‡ªåŠ¨æœºæ’å…¥å¤šä¸ªå­—ç¬¦ä¸²ã€‚</p><p>æ’å…¥ä¸€ä¸ªå­—ç¬¦ä¸²åå°† <code>lst</code> è®¾ä¸º $1$ï¼Œæ˜¯å¸¸è§çš„ä¼ªå¹¿ä¹‰åç¼€è‡ªåŠ¨æœºå†™æ³•ï¼Œä½†æ˜¯æ—¶é—´å¤æ‚åº¦æ˜¯æ­£ç¡®çš„ã€‚</p><h4 id="1-SNOI2020-å­—ç¬¦ä¸²"><a href="#1-SNOI2020-å­—ç¬¦ä¸²" class="headerlink" title="1.[SNOI2020] å­—ç¬¦ä¸²"></a><a href="https://www.luogu.com.cn/problem/P6793">1.[SNOI2020] å­—ç¬¦ä¸²</a></h4><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/alex-wei/p/Common_String_Theory_Theory_automaton_related.html">å¸¸è§å­—ç¬¦ä¸²ç®—æ³• IIï¼šè‡ªåŠ¨æœºç›¸å…³</a></p><p><a href="https://www.luogu.com/article/w967d5rp">åç¼€è‡ªåŠ¨æœºå­¦ä¹ ç¬”è®°(åº”ç”¨ç¯‡)</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>exKMP</title>
      <link href="/notes/exKMP/"/>
      <url>/notes/exKMP/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¯¹äºå­—ç¬¦ä¸² $s$ï¼Œè®° $z_i$ ä¸º $i$ åç¼€ä¸ $s$ çš„æœ€é•¿å…¬å…±å‰ç¼€ã€‚exKMP ç®—æ³•å¯ä»¥ $O(n)$ æ±‚ $z$ã€‚</p><p>è®° $[i,i+z_i-1]$ ä¸ºåŒ¹é…æ®µï¼Œåœ¨æ±‚è§£è¿‡ç¨‹ä¸­ç»´æŠ¤æœ€é å³çš„åŒ¹é…æ®µ $[l,r]$ï¼Œå½“æ±‚è§£ $z_i$ æ—¶ã€‚</p><ul><li><p>$r &lt; i$ æš´åŠ›åŒ¹é…ã€‚</p></li><li><p>$i \le r$ ä»¤ $z_i=\min(r-i+1,z_{i-l+1})$ï¼Œå†æš´åŠ›åŒ¹é…ã€‚</p></li></ul><p>å‡æ‘Šçº¿æ€§ã€‚</p><p>$[1,z_1]$ æ˜¯æ²¡æœ‰æ„ä¹‰çš„ï¼Œä¸è¦è®¡å…¥ $[l,r]$ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-ã€æ¨¡æ¿ã€‘æ‰©å±•-KMP-exKMPï¼ˆZ-å‡½æ•°ï¼‰"><a href="#1-ã€æ¨¡æ¿ã€‘æ‰©å±•-KMP-exKMPï¼ˆZ-å‡½æ•°ï¼‰" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘æ‰©å±• KMP/exKMPï¼ˆZ å‡½æ•°ï¼‰"></a><a href="https://www.luogu.com.cn/problem/P5410">1.ã€æ¨¡æ¿ã€‘æ‰©å±• KMP/exKMPï¼ˆZ å‡½æ•°ï¼‰</a></h4><p>æ„é€  $b+!+a$ã€‚éœ€è¦ç‰¹åˆ¤ $z_1$ã€‚</p><h4 id="2-Prefixes-and-Suffixes"><a href="#2-Prefixes-and-Suffixes" class="headerlink" title="2.Prefixes and Suffixes"></a><a href="https://www.luogu.com.cn/problem/CF432D">2.Prefixes and Suffixes</a></h4><p>å®Œç¾å­—ä¸²æ˜¯å¥½æ‰¾çš„ï¼Œéœ€è¦è®¡ç®—æ¯ä¸ªå‰ç¼€çš„å‡ºç°æ¬¡æ•°ï¼Œè®¡ç®— $z$ï¼Œæ¯æ¬¡ $[1,z_i]$ åŒºé—´åŠ  $1$ã€‚æ—¶é—´å¤æ‚åº¦ $O(n)$ã€‚</p><h4 id="3-Om-Nom-and-Necklace"><a href="#3-Om-Nom-and-Necklace" class="headerlink" title="3.Om Nom and Necklace"></a><a href="https://www.luogu.com.cn/problem/CF526D">3.Om Nom and Necklace</a></h4><p>ç›¸å½“äº $S=AAâ€¦AB$ï¼Œ$A$ æœ‰ $k$ ä¸ªï¼Œ$B$ ä¸º $A$ çš„å‰ç¼€ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/alex-wei/p/Basic_String_Theory.html">å­—ç¬¦ä¸²åŸºç¡€</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ACAM</title>
      <link href="/notes/ACAM/"/>
      <url>/notes/ACAM/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ç”¨äºè§£å†³å¤šæ¨¡å¼ä¸²åŒ¹é…é—®é¢˜ã€‚</p><p>å°†æ¨¡å¼ä¸²æ’å…¥ trie ä¸­ï¼Œå¯¹æ¯ä¸ªç‚¹æ„é€  $fail$ æŒ‡å‘æ¨¡å¼ä¸²ä¸­ä¸å…¶åç¼€åŒ¹é…çš„æœ€é•¿å‰ç¼€ã€‚</p><p>ä»¥æ¯ä¸ªç‚¹çš„ $fail$ ä¸ºçˆ¶èŠ‚ç‚¹æ„å»º fail æ ‘ï¼Œæ»¡è¶³èŠ‚ç‚¹ $x$ å¯¹åº”çš„ä¸²ä¸ºèŠ‚ç‚¹ $y$ å¯¹åº”çš„ä¸²çš„åç¼€å½“ä¸”ä»…å½“ $y \in T(x)$ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-AC-è‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰"><a href="#1-AC-è‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰" class="headerlink" title="1.AC è‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰"></a><a href="https://www.luogu.com.cn/problem/P3808">1.AC è‡ªåŠ¨æœºï¼ˆç®€å•ç‰ˆï¼‰</a></h4><p>å‡ºç°è¿‡ï¼Œéå†åå°±èµ‹å€¼ä¸º $-1$ï¼Œé‡åˆ° $-1$ åˆ™åœæ­¢ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦çº¿æ€§ã€‚</p><h4 id="2-ã€æ¨¡æ¿ã€‘AC-è‡ªåŠ¨æœº"><a href="#2-ã€æ¨¡æ¿ã€‘AC-è‡ªåŠ¨æœº" class="headerlink" title="2.ã€æ¨¡æ¿ã€‘AC è‡ªåŠ¨æœº"></a><a href="https://www.luogu.com.cn/problem/P5357">2.ã€æ¨¡æ¿ã€‘AC è‡ªåŠ¨æœº</a></h4><p>å°†æ–‡æœ¬ä¸²å¯¹åº”çš„æ‰€æœ‰èŠ‚ç‚¹æ ‡è®°ï¼Œç›¸å½“äºæŸ¥è¯¢å­æ ‘å’Œã€‚</p><h4 id="3-HNOI2004-L-è¯­è¨€"><a href="#3-HNOI2004-L-è¯­è¨€" class="headerlink" title="3.[HNOI2004] L è¯­è¨€"></a><a href="https://www.luogu.com.cn/problem/P2292">3.[HNOI2004] L è¯­è¨€</a></h4><p>DPï¼Œè®° $f_i$ ä¸º $i$ å‰ç¼€æ˜¯å¦åˆæ³•ï¼Œè½¬ç§»å½¢å¦‚ $f_i|=f_j([j+1,i] \in D)$ï¼Œç”±äº $|s| \le 20$ï¼Œå¯¹ trie ä¸Šæ¯ä¸ªèŠ‚ç‚¹ç»´æŠ¤äºŒè¿›åˆ¶çŠ¶æ€è¡¨ç¤ºé•¿ä¸º $k$ çš„æ¨¡å¼ä¸²æ˜¯å¦å‡ºç°å³å¯ $O(1)$ è½¬ç§»ã€‚</p><h4 id="4-COCI2015-Divljak"><a href="#4-COCI2015-Divljak" class="headerlink" title="4.[COCI2015] Divljak"></a><a href="https://www.luogu.com.cn/problem/P5840">4.[COCI2015] Divljak</a></h4><p>å°† $S$ æ’å…¥ trie ä¸­ï¼Œå»ºç«‹ ACAMã€‚ç›¸å½“äºå•ç‚¹åŠ é¢œè‰²ï¼ŒæŸ¥è¯¢å­æ ‘ä¸­é¢œè‰²ç§ç±»æ•°ã€‚å¯¹æ¯ä¸ªç‚¹ç»´æŠ¤å­æ ‘ä¸­é¢œè‰²ç§ç±»æ•°ï¼Œæ¯æ¬¡æ˜¯é“¾å¹¶çš„åŠ ï¼ŒæŒ‰ dfs åºæ’åºåï¼Œå®¹æ–¥ä¸€ä¸‹å³å¯ã€‚å¯ä»¥å†å·®åˆ†ç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/alex-wei/p/Common_String_Theory_Theory_automaton_related.html">å¸¸è§å­—ç¬¦ä¸²ç®—æ³• IIï¼šè‡ªåŠ¨æœºç›¸å…³</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ä¸‡èƒ½æ¬§å‡ é‡Œå¾—</title>
      <link href="/notes/%E4%B8%87%E8%83%BD%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/"/>
      <url>/notes/%E4%B8%87%E8%83%BD%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä»¥æ±‚ $\sum_{i=1}^{n} \left \lfloor \frac{ai+b}{c} \right \rfloor$ ä¸ºä¾‹ã€‚æ­¤å’Œå¼ç›¸å½“äºæ±‚çº¿æ®µ $y=\frac{a}{c}x+\frac{b}{c}(x \in [1,n])$ ä¸‹é¢æ¨ªåæ ‡ä¸ºæ­£æ•´æ•°çš„æ•´ç‚¹ä¸ªæ•°ã€‚</p><p>è€ƒè™‘æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»å·¦åˆ°å³éå†è¯¥çº¿æ®µï¼Œæ¯å½“é‡åˆ° $y=k(k \in \mathbb{Z})$ åˆ™åŠ  $\texttt{U}$ï¼Œé‡åˆ° $x=k(k \in \mathbb{Z})$ åˆ™åŠ  $\texttt{R}$ã€‚åªéœ€è¦çŸ¥é“è¯¥å­—ç¬¦ä¸²å³å¯å¾—åˆ°å’Œå¼çš„å’Œã€‚</p><p>è®° $f(S)$ ä¸ºå­—ç¬¦ä¸² $S$ å¯¹åº”å’Œå¼çš„ç­”æ¡ˆï¼Œé‚£ä¹ˆåŸå’Œå¼çš„ç­”æ¡ˆä¸º $f(\left \lfloor \frac{b}{c} \right \rfloor \times U + S)$ã€‚éœ€è¦ç”¨ $f(S_1),f(S_2)$ è®¡ç®— $f(S_1+S_2)$ï¼Œè¿™ä¸ªéœ€è¦ä¾æ®å’Œå¼ã€‚æ¥æ¨ä¸€ä¸‹æˆ‘ä»¬çš„ä¾‹å­</p><script type="math/tex; mode=display">\begin{align}f(S) &= f(S_1) \times f(S_2) \\&= f(S_1) + \sum_{i=1}^{n_2} (\left \lfloor \frac{ai+b}{c} \right \rfloor + cnt_1(U)) \\&= f(S_1)+f(S_2)+n_2 \times cnt_1(U)\end{align}</script><p>ç”¨å‡½æ•° $f$ å‚¨å­˜éœ€è¦çš„ä¿¡æ¯ï¼Œå¯¹äºæœ¬ä¾‹å°±æ˜¯å’Œå¼çš„å€¼ã€$cnt(U)ã€cnt(R)$ï¼Œé‚£ä¹ˆå®šä¹‰çš„ä¹˜æ³•å°±å¯ä»¥è®¡ç®—äº†ã€‚</p><p>è®° $f(a,b,c,n,f_U,f_R)$ï¼Œä¸ºå°†å’Œå¼ $\sum_{i=1}^{n} \left \lfloor \frac{ai+b}{c} \right \rfloor$ å½¢æˆçš„å­—ç¬¦ä¸²ä¸­çš„ $\texttt{U}$ æ¢æˆ $f_U$ï¼Œ$\texttt{R}$ æ¢æˆ $f_R$ å¾—åˆ°çš„è¿ä¹˜å¼çš„å€¼ã€‚éœ€è¦å¿«é€Ÿè®¡ç®— $f(a,b,c,d,n,f_U,f_R)$ã€‚</p><p>å°†çº¿æ®µä¸Šä¸‹å¹³ç§»æ•´æ•°æ ¼æ˜¯ä¸æ”¹å˜å‡½æ•°çš„å€¼çš„ï¼Œæ‰€ä»¥</p><script type="math/tex; mode=display">f(a,b,c,n,f_U,f_R) = f(a,b\%c,c,n,f_U,f_R)</script><p>è€ƒè™‘å¯¹ $a,c$ çš„å¤§å°åˆ†è®¨</p><ul><li><p>$a \ge c$</p><script type="math/tex; mode=display">  f(a,b,c,n,f_U,f_R) = f(a\%c,b,c,n,f_U,f_U^{\left \lfloor \frac{a}{c} \right \rfloor} f_R)</script></li><li><p>$a &lt; c$<br>  éœ€è¦å°†çº¿æ®µæ²¿ $y=x$ ç¿»è½¬ï¼Œå› ä¸ºç¿»è½¬åå¯¹äºåœ¨çº¿æ®µä¸Šçš„é¡¶ç‚¹åŠ å…¥ $\texttt{U,R}$ çš„é¡ºåºé—®é¢˜ï¼Œè¿˜éœ€è¦å°†çº¿æ®µå‘å³å¹³ç§» $\frac{1}{c}$ï¼Œåé¢å°±æ˜¯æ¨å¼å­äº†ï¼Œæ‡’å¾—å†™äº†ï¼ŒæŠ›å‡ºç»“è®ºï¼Œè®° $m = \left \lfloor \frac{an+b}{c} \right \rfloor$</p><ul><li><p>$m=0$</p><script type="math/tex; mode=display">  f(a,b,c,n,f_U,f_R) = f_R^n</script></li><li><p>$m \ne 0$</p><script type="math/tex; mode=display">  f(a,b,c,n,f_U,f_R) = f_R^{\left \lfloor \frac{c-b-1}{a} \right \rfloor}  f_U f(c,c-b-1,a,m-1,f_R,f_U) f_R^{n-\left \lfloor \frac{cm-b-1}{a} \right \rfloor}</script></li></ul></li></ul><p>è®¡ç®—æ—¶é—´å¤æ‚åº¦ï¼Œå½“ $a&lt;c$ æ—¶ï¼Œæœ‰</p><script type="math/tex; mode=display">T(a,c)=T(c\%a,a)+O(\log(\frac{c}{a}))</script><p>æœ€åå¾—åˆ° $T(a,c)=O(\log c)$ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-ã€æ¨¡æ¿ã€‘ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#1-ã€æ¨¡æ¿ã€‘ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•"></a><a href="https://www.luogu.com.cn/problem/P5170">1.ã€æ¨¡æ¿ã€‘ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•</a></h4><p>è€ƒè™‘åˆå¹¶ï¼Œè®° $f,g,h$ åˆ†åˆ«ä¸º $\sum_{i=1}^{n} \left \lfloor \frac{ai+b}{c} \right \rfloor$ï¼Œ$\sum_{i=1}^{n} i\left \lfloor \frac{ai+b}{c} \right \rfloor$ï¼Œ$\sum_{i=1}^{n} \left \lfloor \frac{ai+b}{c} \right \rfloor^2$ çš„å€¼ï¼Œ$U,R$ ä¸º $\texttt{U,R}$ çš„ä¸ªæ•°ã€‚</p><script type="math/tex; mode=display">U_1U_2 = U_1 + U_2 \\R_1R_2 = R_1 + R_2</script><script type="math/tex; mode=display">\begin{align}f_1f_2 = f_1+f_2+n_2U_1\end{align}</script><script type="math/tex; mode=display">\begin{align}g_1g_2 &= g_1 + \sum_{i=1}^{n_2} (i+R_1)(\left \lfloor \frac{ai+b}{c} \right \rfloor + U_1) \\&= g_1 + g_2 + R_1f_2 + U_1 \frac{n_2(n_2+1)}{2} + n_2U_1R_1\end{align}</script><script type="math/tex; mode=display">\begin{align}h_1h_2 &= h_1 + \sum_{i=1}^{n_2} (\left \lfloor \frac{ai+b}{c} \right \rfloor + U_1)^2 \\&= h_1 + h_2 + 2U_1f_2 + n_2U_1^2\end{align}</script><p>å¥—ç”¨å…¬å¼å³å¯ã€‚</p><h4 id="2-ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•"><a href="#2-ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•" class="headerlink" title="2.ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•"></a><a href="https://loj.ac/p/138">2.ç±»æ¬§å‡ é‡Œå¾—ç®—æ³•</a></h4><p>äºŒé¡¹å¼å®šç†ã€‚</p><h4 id="3-ä¸‡èƒ½æ¬§å‡ é‡Œå¾—"><a href="#3-ä¸‡èƒ½æ¬§å‡ é‡Œå¾—" class="headerlink" title="3.ä¸‡èƒ½æ¬§å‡ é‡Œå¾—"></a><a href="https://loj.ac/p/6440">3.ä¸‡èƒ½æ¬§å‡ é‡Œå¾—</a></h4><script type="math/tex; mode=display">\begin{align}C_1C_2 &= C_1 + \sum_{i=1}^{n_2}A^{i+R_1}B^{\left \lfloor \frac{ai+b}{c} \right \rfloor + U_1} \\&=C_1 + A^{R_1} C_2 B^{U_1}\end{align}</script><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/0kkpowmz">ç±»æ¬§å‡ é‡Œå¾—</a> </p><p><a href="https://www.luogu.com.cn/article/0nty0w8p">ä¸‡èƒ½æ¬§å‡ é‡Œå¾—</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>çŸ©é˜µåŠ é€Ÿå›¾ä¸Šé—®é¢˜</title>
      <link href="/notes/%E7%9F%A9%E9%98%B5%E5%8A%A0%E9%80%9F%E5%9B%BE%E4%B8%8A%E9%97%AE%E9%A2%98/"/>
      <url>/notes/%E7%9F%A9%E9%98%B5%E5%8A%A0%E9%80%9F%E5%9B%BE%E4%B8%8A%E9%97%AE%E9%A2%98/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å›¾ä¸Šæ¸¸èµ°é—®é¢˜ã€‚</p><p>é‚»æ¥çŸ©é˜µçš„ $k$ æ¬¡å¹‚ä¸ºå›¾ä¸Šé€šè¿‡ $k$ æ¡è¾¹åˆ°è¾¾çš„æ–¹æ¡ˆæ•°ã€‚</p><p>çŸ©é˜µä¹˜å‘é‡çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚å¯¹äºæ±‚ $\vec vA^k$ï¼Œå¯ä»¥é¢„å¤„ç†</p><script type="math/tex; mode=display">A^1,A^2,...,A^{B} \\A^{B},A^{B^2},...,A^{B^{\log_B k}}</script><p>æ—¶é—´å¤æ‚åº¦ $O(n^3(B+\log_B k))-O(n^2\log_B k)$ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/s0f38vwf">çŸ©é˜µåŠ é€Ÿå›¾ä¸Šé—®é¢˜</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è‰¹</title>
      <link href="/others/%E8%89%B9/"/>
      <url>/others/%E8%89%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="1-ä¸è¦åœ¨æ¨¡æ„ä¹‰ä¸‹åˆ¤ç‰¹æ®Šæ•°æ®"><a href="#1-ä¸è¦åœ¨æ¨¡æ„ä¹‰ä¸‹åˆ¤ç‰¹æ®Šæ•°æ®" class="headerlink" title="1.ä¸è¦åœ¨æ¨¡æ„ä¹‰ä¸‹åˆ¤ç‰¹æ®Šæ•°æ®"></a>1.ä¸è¦åœ¨æ¨¡æ„ä¹‰ä¸‹åˆ¤ç‰¹æ®Šæ•°æ®</h2><p><a href="https://mirror.codeforces.com/contest/2043/problem/F">Nim</a></p><h2 id="2-lambda-è¡¨è¾¾å¼"><a href="#2-lambda-è¡¨è¾¾å¼" class="headerlink" title="2.lambda è¡¨è¾¾å¼"></a>2.lambda è¡¨è¾¾å¼</h2><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> f = [a](){</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    };</span><br><span class="line">    a=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="built_in">f</span>()); </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¾“å‡º $1$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> f = [&amp;a](){</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    }</span><br><span class="line">    a=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="built_in">f</span>()); </span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><p>è¾“å‡º $0$ã€‚</p><figure class="highlight cpp"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="type">int</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">auto</span> f = [&amp;a](){</span><br><span class="line">        a=<span class="number">0</span>;</span><br><span class="line">    };</span><br><span class="line">    <span class="built_in">f</span>();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, a); </span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>è¾“å‡º $0$ã€‚</p><h2 id="3-ç”¨-a-1-æ¥åˆ¤æ–­-a-æ˜¯å¦å­˜åœ¨ï¼Œä½†æ˜¯-a-in-infty-infty"><a href="#3-ç”¨-a-1-æ¥åˆ¤æ–­-a-æ˜¯å¦å­˜åœ¨ï¼Œä½†æ˜¯-a-in-infty-infty" class="headerlink" title="3.ç”¨ $a=-1$ æ¥åˆ¤æ–­ $a$ æ˜¯å¦å­˜åœ¨ï¼Œä½†æ˜¯ $a \in (-\infty,\infty)$"></a>3.ç”¨ $a=-1$ æ¥åˆ¤æ–­ $a$ æ˜¯å¦å­˜åœ¨ï¼Œä½†æ˜¯ $a \in (-\infty,\infty)$</h2>]]></content>
      
      
      <categories>
          
          <category> others </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ–¯å¦çº³æ ‘</title>
      <link href="/notes/%E6%96%AF%E5%9D%A6%E7%BA%B3%E6%A0%91/"/>
      <url>/notes/%E6%96%AF%E5%9D%A6%E7%BA%B3%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä½¿å…³é”®ç‚¹è¿é€šçš„æœ€å°æ ‘ã€‚</p><p><a href="https://www.luogu.com.cn/problem/P6192">ã€æ¨¡æ¿ã€‘æœ€å°æ–¯å¦çº³æ ‘</a></p><p>è€ƒè™‘çŠ¶å‹ DPï¼Œè®° $f(u,S)$ ä¸ºä»¥ $u$ ä¸ºæ ¹ï¼ŒåŒ…å« $S$ é›†åˆçš„ç‰¹æ®Šç‚¹çš„æœ€å°æ ‘ã€‚</p><p>å°†æœ€ç»ˆçš„æ ‘æ‰¾å‡ºæ¥ï¼Œå¯¹äºåº¦æ•°ä¸º $1$ çš„ç‚¹ï¼Œéœ€è¦åŠ è¾¹ï¼Œå³ $f(u,S) \gets f(v,S) + w$ã€‚è¿˜éœ€è¦åˆå¹¶ï¼Œå³ $f(u,S) \gets f(u,Sâ€™)+f(u,S \oplus Sâ€™)(Sâ€™ \subset S)$ã€‚</p><p>ç¬¬ä¸€ç§è½¬ç§»ç”¨æœ€çŸ­è·¯ï¼Œç¬¬äºŒç§è½¬ç§»æšä¸¾å­é›†ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n3^n+nm2^n)/O(n3^n+m\log m2^n)$ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ar(x) array<span class="string">&lt;int,x&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">100</span><span class="number">+10</span>,M=<span class="number">500</span><span class="number">+10</span>,L=(<span class="number">1</span>&lt;&lt;<span class="number">10</span>)<span class="number">+10</span>,INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">chkmin</span><span class="params">(<span class="type">int</span> &amp;x,<span class="type">int</span> y)</span></span>{ <span class="keyword">return</span> y&lt;x?x=y,<span class="number">1</span>:<span class="number">0</span>; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,K,vis[N],f[L][N];</span><br><span class="line">vector&lt;ar(2)&gt; G[N]; queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd,K=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y,z;i&lt;=m;++i) G[x=rd].<span class="built_in">pb</span>({y=rd,z=rd}),G[y].<span class="built_in">pb</span>({x,z});</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> S=<span class="number">0</span>;S&lt;(<span class="number">1</span>&lt;&lt;K);++S) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[S][i]=INF;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x;i&lt;=K;++i) x=rd,f[<span class="number">1</span>&lt;&lt;(i<span class="number">-1</span>)][x]=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> S=<span class="number">0</span>;S&lt;(<span class="number">1</span>&lt;&lt;K);++S){</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> T=S;T;T=(T<span class="number">-1</span>)&amp;S) <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) f[S][i]=<span class="built_in">min</span>(f[S][i],f[T][i]+f[S^T][i]);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="keyword">if</span>(f[S][i]!=INF) q.<span class="built_in">push</span>(i),vis[i]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line"><span class="type">int</span> u=q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>(),vis[u]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">auto</span> [v,w]:G[u]) <span class="keyword">if</span>(<span class="built_in">chkmin</span>(f[S][v],f[S][u]+w)&amp;&amp;!vis[v]) q.<span class="built_in">push</span>(v),vis[v]=<span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> ans=INF; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) ans=<span class="built_in">min</span>(ans,f[(<span class="number">1</span>&lt;&lt;K)<span class="number">-1</span>][i]); <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-JLOI2015-ç®¡é“è¿æ¥"><a href="#1-JLOI2015-ç®¡é“è¿æ¥" class="headerlink" title="1.[JLOI2015] ç®¡é“è¿æ¥"></a><a href="https://www.luogu.com.cn/problem/P3264">1.[JLOI2015] ç®¡é“è¿æ¥</a></h4><p>æœ€ç»ˆç­”æ¡ˆä¸ºæ–¯å¦çº³æ£®æ—ã€‚å…ˆæ±‚ä»»æ„å­é›†çš„æ–¯å¦çº³æ ‘ï¼Œå†å¥—ä¸ªçŠ¶å‹ DP å³å¯ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/m5jej3t8">æ–¯å¦çº³æ ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Pollard Rho</title>
      <link href="/notes/Pollard_Rho/"/>
      <url>/notes/Pollard_Rho/</url>
      
        <content type="html"><![CDATA[<h2 id="Miller-Rabin"><a href="#Miller-Rabin" class="headerlink" title="Miller Rabin"></a>Miller Rabin</h2><p><a href="https://www.luogu.com.cn/problem/SP288">PON - Prime or Not</a></p><ul><li><p>è‹¥ $p$ ä¸ºç´ æ•°ï¼Œé‚£ä¹ˆ $\forall p \nmid a, a^{p-1} \equiv 1 (\mod p)$ã€‚</p></li><li><p>è‹¥ $p$ ä¸ºå¥‡ç´ æ•°ï¼Œé‚£ä¹ˆ $x^2 \equiv 1(\mod p)$ çš„è§£ä¸º $x \equiv \pm 1(\mod p)$ã€‚</p></li></ul><p>å–å‰ $12$ ä¸ªç´ æ•°ï¼ˆ$2,3,5,7,11,13,17,19,23,29,31,37$ï¼‰å°±å¤Ÿç”¨äº†ã€‚<a href="https://oeis.org/A014233">OEIS</a>ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(\log V)$ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> p)</span></span>{ <span class="type">int</span> res=<span class="number">1</span>; <span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=(i128)x*x%p) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=(i128)res*x%p; <span class="keyword">return</span> res; }</span><br><span class="line"><span class="type">int</span> pr[<span class="number">15</span>]={<span class="number">0</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">7</span>,<span class="number">11</span>,<span class="number">13</span>,<span class="number">17</span>,<span class="number">19</span>,<span class="number">23</span>,<span class="number">29</span>,<span class="number">31</span>,<span class="number">37</span>};</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">chk</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> p)</span></span>{</span><br><span class="line"><span class="type">int</span> d=p<span class="number">-1</span>,cur; <span class="keyword">for</span>(;!(d&amp;<span class="number">1</span>);d&gt;&gt;=<span class="number">1</span>);</span><br><span class="line">cur=<span class="built_in">qm</span>(x,d,p); <span class="keyword">if</span>(cur==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(;d&lt;=p<span class="number">-1</span>;d&lt;&lt;=<span class="number">1</span>){</span><br><span class="line"><span class="keyword">if</span>(cur==p<span class="number">-1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">cur=(i128)cur*cur%p;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">chk</span><span class="params">(<span class="type">int</span> p)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(p&gt;<span class="number">37</span>){ <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">12</span>;++i) <span class="keyword">if</span>(!<span class="built_in">chk</span>(pr[i],p)) <span class="keyword">return</span> <span class="number">0</span>; <span class="keyword">return</span> <span class="number">1</span>; }</span><br><span class="line"><span class="keyword">else</span>{ <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=<span class="number">12</span>;++i) <span class="keyword">if</span>(pr[i]==p) <span class="keyword">return</span> <span class="number">1</span>; <span class="keyword">return</span> <span class="number">0</span>; }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="Pollard-Rho"><a href="#Pollard-Rho" class="headerlink" title="Pollard Rho"></a>Pollard Rho</h2><p><a href="https://www.luogu.com.cn/problem/P4718">ã€æ¨¡æ¿ã€‘Pollard-Rho</a></p><p>æ„é€ å‡½æ•° $f(x)=x^2+c$ï¼Œè®° $x_0=0,x_i=f(x_{i-1})$ã€‚</p><p>æ¯æ¬¡æ‰¾ $\gcd(\Delta x,p)$ æ˜¯å¾ˆä¼˜çš„ã€‚</p><p>$x_i$ ä¼šå½¢æˆç±»ä¼¼ $\rho$ çš„å›¾å½¢ï¼Œç”±ç”Ÿæ—¥æ‚–è®ºå¯çŸ¥å…¶é•¿åº¦æœŸæœ›ä¸º $O(\sqrt[4]{p})$ï¼Œè€ƒè™‘æšä¸¾ $i$ï¼Œå½“ $x_{2i}=x_i$ æ—¶é€€å‡ºï¼Œè¿™æ ·æ¥åˆ¤ç¯ã€‚</p><p>æœŸæœ›æ—¶é—´å¤æ‚åº¦ $O(\sqrt[4]{n}\log n)$ã€‚</p><p>æ ¹æ® $\gcd(a,n) \mid \gcd(ab \mod n,n)$ï¼Œå°† $\Delta x$ ä¹˜èµ·æ¥ï¼Œè¾¾åˆ°ä¸€å®šé™åº¦æ˜¯æ±‚ $\gcd$ åˆ¤æ–­ã€‚</p><p>å¯¹é™åº¦å€å¢ï¼Œä¸ $128$ å– $\min$ è¾ƒä¼˜ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> get(l,r) (rnd()%((r)-(l)+1)+(l))</span></span><br><span class="line"><span class="function">mt19937_64 <span class="title">rnd</span><span class="params">(time(<span class="number">0</span>))</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">qm</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> p)</span></span>{ <span class="type">int</span> res=<span class="number">1</span>; <span class="keyword">for</span>(;y;y&gt;&gt;=<span class="number">1</span>,x=(i128)x*x%p) <span class="keyword">if</span>(y&amp;<span class="number">1</span>) res=(i128)res*x%p; <span class="keyword">return</span> res; }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">div</span><span class="params">(<span class="type">int</span> p)</span></span>{</span><br><span class="line"><span class="type">int</span> c=<span class="built_in">get</span>(<span class="number">1</span>,p<span class="number">-1</span>),s=c,t=<span class="number">0</span>,prod=<span class="number">1</span>,lim=<span class="number">1</span>,cnt=<span class="number">0</span>,d;</span><br><span class="line"><span class="keyword">auto</span> f=[&amp;](<span class="type">int</span> x){ <span class="built_in">return</span> ((i128)x*x+c)%p; };</span><br><span class="line"><span class="keyword">for</span>(;s!=t;s=<span class="built_in">f</span>(<span class="built_in">f</span>(s)),t=<span class="built_in">f</span>(t)){</span><br><span class="line">prod=(i128)prod*<span class="built_in">abs</span>(s-t)%p;</span><br><span class="line"><span class="keyword">if</span>(++cnt==lim){</span><br><span class="line"><span class="keyword">if</span>((d=__gcd(prod,p))!=<span class="number">1</span>) <span class="keyword">return</span> d;</span><br><span class="line">cnt=<span class="number">0</span>,lim=<span class="built_in">min</span>(lim&lt;&lt;<span class="number">1</span>,B);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">if</span>((d=__gcd(prod,p))!=<span class="number">1</span>) <span class="keyword">return</span> d; <span class="keyword">return</span> p;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> p)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(p==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">chk</span>(p)) <span class="keyword">return</span> p;</span><br><span class="line"><span class="type">int</span> d=<span class="built_in">div</span>(p); <span class="keyword">for</span>(;d==p;d=<span class="built_in">div</span>(p));</span><br><span class="line"><span class="keyword">for</span>(;p%d==<span class="number">0</span>;p/=d);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">find</span>(d),<span class="built_in">find</span>(p));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/812-xiao-wen/p/10544546.html">Pollard Rho</a></p><p><a href="https://www.cnblogs.com/alex-wei/p/Number_Theory_II.html">åˆç­‰æ•°è®ºå­¦ä¹ ç¬”è®° IIï¼šåˆ†è§£è´¨å› æ•° </a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>äºŒåˆ†å›¾</title>
      <link href="/notes/%E4%BA%8C%E5%88%86%E5%9B%BE/"/>
      <url>/notes/%E4%BA%8C%E5%88%86%E5%9B%BE/</url>
      
        <content type="html"><![CDATA[<h2 id="åŒˆç‰™åˆ©ç®—æ³•"><a href="#åŒˆç‰™åˆ©ç®—æ³•" class="headerlink" title="åŒˆç‰™åˆ©ç®—æ³•"></a>åŒˆç‰™åˆ©ç®—æ³•</h2><p><a href="https://www.luogu.com.cn/problem/P3386">ã€æ¨¡æ¿ã€‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…</a></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=ne[i]){</span><br><span class="line"><span class="keyword">if</span>(vis[v[i]]) <span class="keyword">continue</span>; vis[v[i]]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!mat[v[i]]||<span class="built_in">dfs</span>(mat[v[i]]))</span><br><span class="line"><span class="keyword">return</span> mat[v[i]]=u,vis[v[i]]=<span class="number">0</span>,<span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><p>æ—¶é—´å¤æ‚åº¦ $O(nm)$ã€‚</p><h2 id="æ€§è´¨"><a href="#æ€§è´¨" class="headerlink" title="æ€§è´¨"></a>æ€§è´¨</h2><blockquote><p>$äºŒåˆ†å›¾æœ€å°è¦†ç›–ç‚¹æ•°=äºŒåˆ†å›¾æœ€å¤§åŒ¹é…$ã€‚</p></blockquote><p>å°±æ˜¯ menger å®šç†çš„ç‚¹å½¢å¼ã€‚</p><p>æ±‚å‡ºæœ€å¤§åŒ¹é…ï¼Œéå†æ¯ä¸€ä¸ªæœªåŒ¹é…çš„å·¦éƒ¨ç‚¹ï¼Œå°†å¢å¹¿è·¯æ ‡è®°ã€‚</p><p>å–æœªæ ‡è®°çš„å·¦éƒ¨ç‚¹å’Œæ ‡è®°çš„å³éƒ¨ç‚¹ä½œä¸ºç‚¹è¦†ç›–ã€‚</p><p><a href="https://www.cnblogs.com/C202202chenkelin/p/14437260.html">è¯æ˜</a></p><blockquote><p>$äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†=n-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…$ã€‚</p></blockquote><p>æœ€å°ç‚¹è¦†ç›–çš„è¡¥é›†ã€‚</p><blockquote><p>è¡¥å›¾çš„æœ€å¤§ç‹¬ç«‹é›†ä¸ºåŸå›¾çš„æœ€å¤§å›¢ã€‚</p></blockquote><h2 id="hall-å®šç†"><a href="#hall-å®šç†" class="headerlink" title="hall å®šç†"></a>hall å®šç†</h2><p>å¯¹äºç‚¹æ•°åˆ†åˆ«ä¸º $x,y(x \le y)$ çš„äºŒåˆ†å›¾ï¼Œè‹¥å…¶æœ€å¤§åŒ¹é…ä¸º $x$ é‚£ä¹ˆç§°å…¶æœ‰å®Œå¤‡åŒ¹é…ã€‚</p><blockquote><p>äºŒåˆ†å›¾å­˜åœ¨å®Œå¤‡åŒ¹é…å½“ä¸”ä»…å½“ $\forall |S| \le |N(S)|$ã€‚</p></blockquote><p>å½’çº³æ³•ï¼Œæ¯æ¬¡åˆ æ‰ä¸€å¯¹ã€‚</p><blockquote><p>äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ä¸º $x - \max\{|S|-|N(S)|\}$ã€‚</p></blockquote><p>å½’çº³æ³•ï¼Œæ¯æ¬¡åˆ æ‰ä¸€å¯¹ã€‚</p><p><a href="https://www.luogu.com.cn/problem/P3679">[CERC2016] äºŒåˆ†æ¯¯ Bipartite Blanket</a></p><p>å­˜åœ¨åŒ¹é…åŒæ—¶è¦†ç›– $X,Y$ï¼Œå½“ä¸”ä»…å½“å­˜åœ¨åŒ¹é…è¦†ç›–å·¦éƒ¨ç‚¹é›† $X$ï¼Œä¸”å­˜åœ¨åŒ¹é…è¦†ç›–å³éƒ¨ç‚¹é›† $Y$ã€‚</p><p>è¯æ˜è€ƒè™‘å°†ä¸¤ä¸ªåŒ¹é…æ‹¼èµ·æ¥ï¼Œå¯¹äºå¶ç¯/å¥‡é“¾ï¼Œé—´éš”é€‰æ‹©å³å¯ã€‚å¯¹äºå¶é“¾ï¼Œå‡è®¾å·¦éƒ¨ç‚¹å¤šäºå³éƒ¨ç‚¹ï¼Œä¸€å®šå­˜åœ¨ä¸€ä¸ªå·¦éƒ¨ç‚¹ $\notin X$ï¼Œåˆ å»å³å¯ã€‚</p><h2 id="äºŒåˆ†å›¾åšå¼ˆ"><a href="#äºŒåˆ†å›¾åšå¼ˆ" class="headerlink" title="äºŒåˆ†å›¾åšå¼ˆ"></a>äºŒåˆ†å›¾åšå¼ˆ</h2><p>åœ¨äºŒåˆ†å›¾ä¸Šä¸¤ä¸ªäººè½®æµç§»åŠ¨ä¸€ä¸ªæ£‹å­ï¼Œä¸èƒ½ç»è¿‡é‡å¤èŠ‚ç‚¹ï¼Œä¸èƒ½åŠ¨è€…è¾“ã€‚</p><p>é‚£ä¹ˆå…ˆæ‰‹å¿…èƒœå½“ä¸”ä»…å½“åˆå§‹ä½ç½®ä¸ºå¿…é¡»ç‚¹ã€‚</p><h2 id="å¿…ç»å¯è¡Œç‚¹è¾¹"><a href="#å¿…ç»å¯è¡Œç‚¹è¾¹" class="headerlink" title="å¿…ç»å¯è¡Œç‚¹è¾¹"></a>å¿…ç»å¯è¡Œç‚¹è¾¹</h2><p>è·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ï¼Œåœ¨æ®‹é‡ç½‘ç»œä¸Šè·‘å¼ºè¿é€šåˆ†é‡ï¼ˆåŒ…æ‹¬ $s,t$ï¼‰ã€‚</p><ul><li><p>è‹¥ä¸€æ¡è¾¹ä¸ºåŒ¹é…è¾¹ä¸”ä¸¤ä¸ªç«¯ç‚¹ä¸å±äºåŒä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œé‚£ä¹ˆå®ƒä¸ºå¿…é¡»è¾¹ã€‚</p></li><li><p>è‹¥ä¸€æ¡è¾¹ä¸ºåŒ¹é…è¾¹æˆ–ä¸¤ä¸ªç«¯ç‚¹å±äºåŒä¸€ä¸ªå¼ºè¿é€šåˆ†é‡ï¼Œé‚£ä¹ˆå®ƒä¸ºå¯è¡Œè¾¹ã€‚</p></li><li><p>ä» $s$ å¼€å§‹æ ‡è®°èƒ½è¾¾åˆ°çš„å·¦éƒ¨ç‚¹ï¼Œä» $t$ å¼€å§‹æ ‡è®°èƒ½è¾¾åˆ°çš„å³éƒ¨ç‚¹ï¼Œé‚£ä¹ˆè¢«æ ‡è®°çš„ç‚¹å‡ä¸ºéå¿…é¡»ç‚¹ï¼Œå…¶è¡¥é›†ä¸ºå¿…é¡»ç‚¹ã€‚</p></li><li><p>è‹¥ä¸€ä¸ªç‚¹å­˜åœ¨ä¸€æ¡ç›¸é‚»çš„å¯è¡Œè¾¹ï¼Œé‚£ä¹ˆå®ƒæ˜¯å¯è¡Œç‚¹ã€‚</p></li></ul><h2 id="æŸ“è‰²"><a href="#æŸ“è‰²" class="headerlink" title="æŸ“è‰²"></a>æŸ“è‰²</h2><p><a href="https://www.luogu.com.cn/problem/CF600F">Edge coloring of bipartite graph</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æœ€å°å‰²æ ‘</title>
      <link href="/notes/%E6%9C%80%E5%B0%8F%E5%89%B2%E6%A0%91/"/>
      <url>/notes/%E6%9C%80%E5%B0%8F%E5%89%B2%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p><a href="https://www.luogu.com.cn/problem/P4897">ã€æ¨¡æ¿ã€‘æœ€å°å‰²æ ‘ï¼ˆGomory-Hu Treeï¼‰</a></p><p>è€ƒè™‘å»ºæ ‘ï¼Œå¯¹äºé›†åˆ $S$ å–å‡ºä¸¤ä¸ªèŠ‚ç‚¹ $x,y$ï¼Œæ±‚ $x \to y$ çš„æœ€å°å‰²ï¼Œæ ‘ä¸Šè¿è¾¹ $(x,y)$ è¾¹æƒä¸ºæœ€å°å‰²ã€‚åˆ’åˆ†ä¸ºä¸¤ä¸ªé›†åˆé€’å½’ä¸‹å»ã€‚</p><p>ç”¨ dinic æ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^3m)$ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ar(x) array<span class="string">&lt;int,x&gt;</span></span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">500</span><span class="number">+10</span>,M=<span class="number">1500</span><span class="number">+10</span>,INF=<span class="number">1e9</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,id[N],_id[N];</span><br><span class="line">vector&lt;ar(2)&gt; G[N];</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> head[N],ne[M*<span class="number">4</span>],v[M*<span class="number">4</span>],fl[M*<span class="number">4</span>],tot=<span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y,<span class="type">int</span> f)</span></span>{</span><br><span class="line">ne[++tot]=head[x],head[x]=tot,v[tot]=y,fl[tot]=f;</span><br><span class="line">ne[++tot]=head[y],head[y]=tot,v[tot]=x,fl[tot]=<span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> s,t,dis[N],cur[N]; queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">bfs</span><span class="params">()</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) dis[i]=<span class="number">-1</span>,cur[i]=head[i];</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>()) q.<span class="built_in">pop</span>(); q.<span class="built_in">push</span>(s),dis[s]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line"><span class="type">int</span> u=q.<span class="built_in">front</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=head[u];i;i=ne[i]){</span><br><span class="line"><span class="keyword">if</span>(dis[v[i]]==<span class="number">-1</span>&amp;&amp;fl[i]){</span><br><span class="line">dis[v[i]]=dis[u]<span class="number">+1</span>,q.<span class="built_in">push</span>(v[i]);</span><br><span class="line"><span class="keyword">if</span>(v[i]==t) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> df)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(u==t) <span class="keyword">return</span> df; <span class="type">int</span> res=df;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=cur[u];res&amp;&amp;i;i=ne[i]){</span><br><span class="line">cur[u]=i;</span><br><span class="line"><span class="keyword">if</span>(dis[v[i]]==dis[u]<span class="number">+1</span>&amp;&amp;fl[i]){</span><br><span class="line"><span class="type">int</span> k=<span class="built_in">dinic</span>(v[i],<span class="built_in">min</span>(res,fl[i]));</span><br><span class="line"><span class="keyword">if</span>(!k) dis[v[i]]=<span class="number">-1</span>;</span><br><span class="line"><span class="keyword">else</span> res-=k,fl[i]-=k,fl[i^<span class="number">1</span>]+=k;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> df-res;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">sol</span><span class="params">(<span class="type">int</span> l,<span class="type">int</span> r)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span>;</span><br><span class="line"><span class="type">int</span> dflow=<span class="number">0</span>,maxflow=<span class="number">0</span>,_l=l<span class="number">-1</span>,_r=r<span class="number">+1</span>; s=id[l],t=id[r];</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">bfs</span>()) <span class="keyword">while</span>(dflow=<span class="built_in">dinic</span>(s,INF)) maxflow+=dflow; <span class="built_in">bfs</span>();</span><br><span class="line">G[id[l]].<span class="built_in">pb</span>({id[r],maxflow}),G[id[r]].<span class="built_in">pb</span>({id[l],maxflow});</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=tot;i+=<span class="number">2</span>) fl[i]+=fl[i^<span class="number">1</span>],fl[i^<span class="number">1</span>]=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i){</span><br><span class="line"><span class="keyword">if</span>(dis[id[i]]!=<span class="number">-1</span>) _id[++_l]=id[i];</span><br><span class="line"><span class="keyword">else</span> _id[--_r]=id[i];</span><br><span class="line">}</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=l;i&lt;=r;++i) id[i]=_id[i];</span><br><span class="line"><span class="built_in">sol</span>(l,_l),<span class="built_in">sol</span>(_r,r);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> tmp[N],ans[N][N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fu,<span class="type">int</span> mn)</span></span>{ tmp[u]=mn; <span class="keyword">for</span>(<span class="keyword">auto</span> [v,w]:G[u]) <span class="keyword">if</span>(v!=fu) <span class="built_in">dfs</span>(v,u,<span class="built_in">min</span>(mn,w)); }</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd<span class="number">+1</span>,m=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) id[i]=i;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y,z;i&lt;=m;++i) x=rd<span class="number">+1</span>,y=rd<span class="number">+1</span>,z=rd,<span class="built_in">add</span>(x,y,z),<span class="built_in">add</span>(y,x,z);</span><br><span class="line"></span><br><span class="line"><span class="built_in">sol</span>(<span class="number">1</span>,n);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) <span class="built_in">dfs</span>(i,<span class="number">0</span>,INF),<span class="built_in">memcpy</span>(ans[i],tmp,<span class="number">4</span>*(n<span class="number">+1</span>));</span><br><span class="line">m=rd; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=m;++i) <span class="built_in">printf</span>(<span class="string">"%d\n"</span>, ans[rd<span class="number">+1</span>][rd<span class="number">+1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-Pumping-Stations"><a href="#1-Pumping-Stations" class="headerlink" title="1.Pumping Stations"></a><a href="https://www.luogu.com.cn/problem/CF343E">1.Pumping Stations</a></h4><p>å…ˆå»ºæœ€å°å‰²æ ‘ã€‚</p><p>å–å‡ºæœ€å°è¾¹è€ƒè™‘ï¼Œå®ƒä¸€å®šä¼šè¢«è®¡å…¥ç­”æ¡ˆä¸€æ¬¡ï¼Œåˆ æ‰å®ƒå½¢æˆä¸¤æ£µæ ‘ï¼Œä¸¤æ£µæ ‘å¯ä»¥éšä¾¿é€‰å®šèµ·ç‚¹ï¼Œè¿™æ ·å·²ç»å¾ˆè‡ªç”±äº†ï¼Œæ‰€ä»¥åˆ†åˆ«éå†å†æ‹¼èµ·æ¥å³å¯ã€‚</p><h4 id="2-æ›¼å“ˆé¡¿è®¡åˆ’EX"><a href="#2-æ›¼å“ˆé¡¿è®¡åˆ’EX" class="headerlink" title="2.æ›¼å“ˆé¡¿è®¡åˆ’EX"></a><a href="https://www.luogu.com.cn/problem/P3729">2.æ›¼å“ˆé¡¿è®¡åˆ’EX</a></h4><p>è¯¢é—®å¯ä»¥æŒ‡é’ˆï¼Œä½†ç“¶é¢ˆä¸åœ¨è¿™ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/cnyjwh6a">æœ€å°å‰²æ ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç½‘ç»œæµ</title>
      <link href="/notes/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
      <url>/notes/%E7%BD%91%E7%BB%9C%E6%B5%81/</url>
      
        <content type="html"><![CDATA[<h2 id="ç®—æ³•"><a href="#ç®—æ³•" class="headerlink" title="ç®—æ³•"></a>ç®—æ³•</h2><p>æœ‰ä¸ªå»ºåå‘è¾¹çš„åæ‚”æ€æƒ³ã€‚</p><h3 id="FF-ç®—æ³•ï¼ˆæŒ‡ç”¨-dfs-å®ç°çš„-FFï¼‰"><a href="#FF-ç®—æ³•ï¼ˆæŒ‡ç”¨-dfs-å®ç°çš„-FFï¼‰" class="headerlink" title="FF ç®—æ³•ï¼ˆæŒ‡ç”¨ dfs å®ç°çš„ FFï¼‰"></a>FF ç®—æ³•ï¼ˆæŒ‡ç”¨ dfs å®ç°çš„ FFï¼‰</h3><p>dfs æ‰¾å¢å¹¿è·¯ã€‚</p><p>æ¯æ¬¡å¢å¹¿å½“å‰æµé‡è‡³å°‘åŠ  $1$ï¼Œå•æ¬¡å¢å¹¿æ—¶é—´å¤æ‚åº¦ $O(m)$ã€‚è®° $F$ ä¸ºæœ€å¤§æµï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(Fm)$ã€‚</p><h3 id="EK-ç®—æ³•"><a href="#EK-ç®—æ³•" class="headerlink" title="EK ç®—æ³•"></a>EK ç®—æ³•</h3><p>bfs æ‰¾åˆ°å¢å¹¿è·¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ä¸º $O(nm^2)$ã€‚</p><p>ä¸‹é¢æ˜¯è¯æ˜ã€‚</p><blockquote><p>æ¯æ¬¡å¢å¹¿å $s$ åˆ°é™¤ $s$ å¤–æ¯ä¸ªç‚¹çš„æœ€çŸ­è·¯å•è°ƒä¸é™ã€‚</p></blockquote><p>åè¯æ³•ï¼Œè®° $d_u$ ä¸ºåŸæœ€çŸ­è·¯ï¼Œ$dâ€™_u$ ä¸ºå¢å¹¿åçš„æœ€çŸ­è·¯ï¼Œå‡è®¾å­˜åœ¨ç‚¹ $u$ æ»¡è¶³ $dâ€™_u&lt;d_u$ å– $dâ€™_u$ æœ€å°çš„ç‚¹ä½œä¸º $u$ã€‚</p><p>è®¾å¢å¹¿åçš„æœ€çŸ­è·¯å¾„å½¢å¦‚ $s \leadsto x \to u$ã€‚é‚£ä¹ˆ $dâ€™u=dâ€™x+1$ã€‚</p><p>æ­¤æ—¶ $(x,u) \notin E$ï¼Œå¦åˆ™ $d_u \le d_x+1 \le dâ€™_x+1 = dâ€™_u$ çŸ›ç›¾ã€‚</p><p>é‚£ä¹ˆ $(x,u)$ æ˜¯å¢å¹¿åçš„åå‘è¾¹ï¼Œå³ $(u,x) \in E$ã€‚æœ‰ $d_u+1=d_x \le dâ€™_x = dâ€™_u-1$ï¼Œå³ $d_u \le dâ€™_u-2$ çŸ›ç›¾ã€‚</p><blockquote><p>è®°ä¸€æ¬¡å¢å¹¿æµé‡ç­‰äºå¢å¹¿æµé‡çš„è¾¹ä¸ºå…³é”®è¾¹ï¼Œé‚£ä¹ˆæ¯æ¡è¾¹æœ€å¤šæˆä¸º $\frac{n}{2}-1$ æ¬¡å…³é”®è¾¹ã€‚</p></blockquote><p>è‹¥ $(u,v)$ ä½œä¸ºå…³é”®è¾¹ï¼Œå…¶å†æ¬¡å‡ºç°éœ€è¦ $(v,u)$ ä½œä¸ºå…³é”®è¾¹ã€‚é‚£ä¹ˆ $ d_u = d_v-1 \le dâ€™_v-1 = dâ€™_u-2 $ï¼Œè€Œ $d$ æœ€å°ä¸º $1$ æœ€å¤§ä¸º $n-1$ï¼Œæœ€å¤šå‡ºç° $\frac{n}{2}-1$ æ¬¡ã€‚</p><p>é‚£ä¹ˆæ€»å¢å¹¿æ¬¡æ•°ä¸º $O(nm)$ï¼Œå•æ¬¡å¢å¹¿æ—¶é—´å¤æ‚åº¦ $O(m)$ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ $O(nm^2)$ã€‚</p><h3 id="dinic"><a href="#dinic" class="headerlink" title="dinic"></a>dinic</h3><p><a href="https://www.luogu.com.cn/problem/P3376">1.ã€æ¨¡æ¿ã€‘ç½‘ç»œæœ€å¤§æµ</a> <a href="https://www.luogu.com.cn/paste/n5dv07nc">dinic</a></p><p><a href="https://www.luogu.com.cn/problem/P3381">2.ã€æ¨¡æ¿ã€‘æœ€å°è´¹ç”¨æœ€å¤§æµ</a> <a href="https://www.luogu.com.cn/paste/dcnzzkwo">dinic</a></p><ul><li><p>å¯¹äºä¸€èˆ¬ç½‘ç»œï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n^2m)$ã€‚</p></li><li><p>å¯¹äºå®¹é‡ä¸º $1$ çš„ç½‘ç»œï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(m\min(n^{\frac{2}{3}},\sqrt{m}))$ã€‚</p></li><li><p>å¯¹äºå•ä½ç½‘ç»œï¼Œå³æ»¡è¶³ $\min(d_i^{in},d_i^{out}) \le 1$ ä¸”å®¹é‡ä¸º $1$ çš„ç½‘ç»œï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(m\sqrt{n})$ã€‚</p></li><li><p>å¢å¹¿è½®æ•°ä¸º $O(\sqrt{\sum_{i}\min(d_i^{in},d_i^{out})})$ã€‚</p></li></ul><p>ä¸‹é¢æ˜¯è¯æ˜ã€‚</p><blockquote><p>æ¯æ¬¡å¢å¹¿ååˆ° $t$ çš„æœ€çŸ­è·¯å•è°ƒä¸å‡ã€‚</p></blockquote><p>åŒç†å¯è¯ã€‚</p><blockquote><p>dinic ç®—æ³•æ¯æ¬¡å¢å¹¿å $s$ åˆ° $t$ çš„æœ€çŸ­è·¯å•è°ƒé€’å¢ã€‚</p></blockquote><p>åªéœ€è¯æ˜ä¸ç›¸ç­‰ï¼Œåè¯æ³•ï¼Œå‡è®¾å¢å¹¿åæœ€çŸ­è·¯å•è°ƒé€’å¢ã€‚</p><p>é‚£ä¹ˆä¸€å®šå­˜åœ¨ä¸€æ¡è¾¹ $e \notin E$ï¼Œå¦åˆ™ä¼šè¢«å¢å¹¿ã€‚é‚£ä¹ˆ $d \ge dâ€™+2$ çŸ›ç›¾ã€‚</p><blockquote><p>å¯¹äºä¸€èˆ¬å›¾ï¼Œdinic ç®—æ³•æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2m)$ã€‚</p></blockquote><p>ä¼šå¢å¹¿ $O(n)$ è½®ï¼Œæ¯è½®å¢å¹¿ä¼šå¢å¹¿ $O(m)$ æ¬¡ï¼Œæ¯æ¬¡å¢å¹¿æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼ˆåˆ†å±‚å›¾ï¼‰ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ $O(n^2m)$ã€‚</p><blockquote><p>è®° $S=\sum_{i}\min(d_i^{in},d_i^{out})$ï¼Œé‚£ä¹ˆå¢å¹¿è½®æ•°ä¸º $O(\sqrt{S})$ã€‚</p></blockquote><p>è‹¥å¢å¹¿è¶…è¿‡ $O(\sqrt{S})$ è½®ï¼Œé‚£ä¹ˆä¹‹åçš„å¢å¹¿è·¯é•¿åº¦ $&gt;\sqrt{S}$ã€‚</p><p>å°†è¾¾åˆ°ç»ˆæ€éœ€è¦å¢å¹¿çš„è·¯å¾„æå‡ºæ¥ï¼Œå¯¹æ¯ä¸ªç‚¹åˆ†åˆ«è€ƒè™‘å¯å¾—å…¶æ€»é•¿åº¦ $\le S$ï¼Œé‚£ä¹ˆè·¯å¾„æ•°ä¸º $O(\sqrt{S})$ï¼Œåˆ™æ¥ä¸‹æ¥è‡³å¤šå¢å¹¿ $O(\sqrt{S})$ è½®ã€‚</p><blockquote><p>è¾¹å®¹é‡ä¸º $1$ çš„ç½‘ç»œï¼Œå¢å¹¿è½®æ•°ä¸º $O(\sqrt{m})$ã€‚</p></blockquote><p>$S=m$ã€‚</p><blockquote><p>è¾¹å®¹é‡ä¸º $1$ çš„ç½‘ç»œï¼Œå¢å¹¿è½®æ•°ä¸º $O(n^{\frac{2}{3}})$ã€‚</p></blockquote><p>è®° $s_i$ ä¸ºä¸ $s$ æœ€çŸ­è·ç¦»ä¸º $i$ çš„ç‚¹çš„ä¸ªæ•°ï¼Œè®° $d$ ä¸º $s$ åˆ° $t$ çš„æœ€çŸ­è·ç¦»ï¼Œè®° $F$ ä¸ºæœ€å¤§æµï¼Œæœ‰ $F \le s_is_{i+1} \le (\frac{s_i+s_{i+1}}{2})^2(i=0,1,â€¦,d-1)$ã€‚</p><p>è€Œ $\sum_{i=0}^{d-1} \frac{s_i+s_{i+1}}{2} &lt; n$ï¼Œæ•… $F &lt; \frac{n^2}{d^2}$ã€‚</p><p>è¿˜æœ‰ä¸ªå¢å¹¿è½®æ•° $\le d$ çš„é™åˆ¶ï¼Œé‚£ä¹ˆå½“ $d \le n^{\frac{2}{3}}$ æ—¶ï¼Œå¢å¹¿è½®æ•°ä¸º $O(n^{\frac{2}{3}})$ï¼Œå½“ $d &gt; n^{\frac{2}{3}}$ æ—¶ï¼Œå¢å¹¿è½®æ•°ä¸º $O(n^{\frac{2}{3}})$ã€‚</p><blockquote><p>è¾¹å®¹é‡ä¸º $1$ çš„ç½‘ç»œï¼Œå•æ¬¡å¢å¹¿çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(m)$ã€‚</p></blockquote><p>æ¯æ¡è¾¹è‡³å¤šéå†ä¸€æ¬¡ã€‚</p><blockquote><p>å•ä½ç½‘ç»œçš„å¢å¹¿è½®æ•°ä¸º $O(\sqrt{n})$ã€‚</p></blockquote><p>$S=O(n)$ã€‚</p><h2 id="æœ€å¤§æµæœ€å°å‰²å®šç†"><a href="#æœ€å¤§æµæœ€å°å‰²å®šç†" class="headerlink" title="æœ€å¤§æµæœ€å°å‰²å®šç†"></a>æœ€å¤§æµæœ€å°å‰²å®šç†</h2><p>å³ æœ€å¤§æµ $=$ æœ€å°å‰²ã€‚</p><p>æœ€å¤§æµ $\le$ æœ€å°å‰²ï¼Œåªéœ€è¯æ˜æœ€å¤§æµ $\ge$ æœ€å°å‰²ã€‚</p><p>åªéœ€è¯æ˜å­˜åœ¨ä¸€ä¸ªæµç­‰äºä¸€ä¸ªå‰²å³å¯ï¼Œæœ€ç»ˆçš„æ®‹ä½™ç½‘ç»œæ˜¾ç„¶ç¬¦åˆæ¡ä»¶ã€‚</p><p>å…¶å®æ˜¯å¯¹å¶ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…"><a href="#1-äºŒåˆ†å›¾æœ€å¤§åŒ¹é…" class="headerlink" title="1.äºŒåˆ†å›¾æœ€å¤§åŒ¹é…"></a>1.äºŒåˆ†å›¾æœ€å¤§åŒ¹é…</h4><p>è®° $X,Y$ åˆ†åˆ«ä¸ºå·¦å³éƒ¨ç‚¹ã€‚</p><ul><li><p>$\forall x \in X,(s,x,1)$ã€‚</p></li><li><p>$\forall y \in Y,(y,t,1)$ã€‚</p></li><li><p>$\forall (x,y) \in E,(x,y,1)$ã€‚</p></li></ul><h4 id="2-Matrix-Decompressing"><a href="#2-Matrix-Decompressing" class="headerlink" title="2.Matrix Decompressing"></a><a href="https://www.luogu.com.cn/problem/UVA11082">2.Matrix Decompressing</a></h4><p>æ±‚å‡ºæ¯è¡Œæ¯åˆ—çš„å’Œã€‚å°†æ¯ä¸ªç‚¹çš„åˆå§‹å€¼è®¾ä¸º $1$ï¼ŒèŒƒå›´è½¬åŒ–ä¸º $0-19$ã€‚</p><p>å°†æ¯è¡Œæ¯åˆ—è§†ä¸ºä¸€ä¸ªç‚¹ã€‚å¯¹åŸå›¾ä¸­ç‚¹ $(x,y)$ å»º $(x,y,19)$ã€‚ä» $s$ å‘æ¯è¡Œè¿å®¹é‡ä¸ºå½“å‰è¡Œçš„å’Œçš„è¾¹ï¼Œåˆ—å‘ $t$ è¿è¾¹ã€‚</p><p>è·‘æœ€å¤§æµå³å¯ä¿è¯è¡Œå’Œåˆ—å‡æ»¡è¶³å’Œçš„æ¡ä»¶ã€‚</p><p>æ¯ä¸ªç‚¹çš„å€¼å³ä¸ºè¾¹çš„æµé‡ $+1$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/4m006v0m">code</a></p><h4 id="3-æœ‰è´Ÿåœˆçš„è´¹ç”¨æµ"><a href="#3-æœ‰è´Ÿåœˆçš„è´¹ç”¨æµ" class="headerlink" title="3.æœ‰è´Ÿåœˆçš„è´¹ç”¨æµ"></a><a href="https://www.luogu.com.cn/problem/P7173">3.æœ‰è´Ÿåœˆçš„è´¹ç”¨æµ</a></h4><p>ç”±äºæœ‰è´Ÿç¯ï¼ŒåŸºäºæœ€çŸ­è·¯çš„è´¹ç”¨æµæ— æ³•ç›´æ¥å¤„ç†ã€‚</p><p>å¼ºåˆ¶è®©è´Ÿæƒè¾¹æ»¡æµï¼Œä½†æ˜¯è¿™æ ·ä¼šä½¿æœ‰çš„ç‚¹çš„å…¥æµä¸å‡ºæµä¸ç­‰ã€‚</p><p>è‹¥ç‚¹çš„å…¥æµå¤§äºå‡ºæµï¼Œåˆ™éœ€è¦æµå‡ºä¸€äº›æµï¼Œåä¹‹åˆ™éœ€è¦æµå…¥ä¸€äº›æµã€‚ç”¨ç½‘ç»œæµå¤„ç†ã€‚</p><p>å»ºç«‹è™šæ‹Ÿæºæ±‡ç‚¹ $s,t$ã€‚è®° $in_i$ ä¸ºç‚¹ $i$ çš„å…¥æµå‡å‡ºæµï¼Œ</p><ul><li><p>$in_i &gt; 0$ è¿è¾¹ $(s,i,in_i,0)$ã€‚</p></li><li><p>$in_i &lt; 0$ è¿è¾¹ $(i,t,-in_i,0)$ã€‚</p></li></ul><p>ä»¥è™šæ‹Ÿæºç‚¹è·‘ä¸€æ¬¡è´¹ç”¨æµé‚£ä¹ˆåŸå›¾æµé‡å¹³è¡¡ï¼ˆè¿™å«åšå¯è¡Œæµï¼‰ï¼Œå†è·‘è´¹ç”¨æµæ±‚è§£ã€‚</p><p><a href="https://www.luogu.com.cn/paste/aewu4k9t">code</a></p><h4 id="4-æœ‰æºæ±‡ä¸Šä¸‹ç•Œæœ€å¤§æµ"><a href="#4-æœ‰æºæ±‡ä¸Šä¸‹ç•Œæœ€å¤§æµ" class="headerlink" title="4.æœ‰æºæ±‡ä¸Šä¸‹ç•Œæœ€å¤§æµ"></a><a href="https://www.luogu.com.cn/problem/P5192">4.æœ‰æºæ±‡ä¸Šä¸‹ç•Œæœ€å¤§æµ</a></h4><p>å…ˆå¼ºåˆ¶æµæ»¡æ¯æ¡è¾¹çš„ä¸‹ç•Œï¼Œè·‘å¯è¡Œæµã€‚è‹¥ä¸å­˜åœ¨å¯è¡Œæµï¼ˆæ²¡æœ‰æ»¡æµï¼‰åˆ™æ— è§£ã€‚</p><p>ç‰¹åˆ«çš„ï¼Œç”±äºåŸå›¾ä¸­çš„æºç‚¹ã€æ±‡ç‚¹å…¥æµä¸ä¸€å®šç­‰äºå‡ºæµï¼Œæ‰€ä»¥è¿è¾¹ $(t,s,\infty)$ã€‚</p><p>è·‘å‡ºå¯è¡Œæµåï¼Œå°† $t$ åˆ° $s$ çš„è¾¹åˆ å»ï¼Œå†è·‘ä¸€æ¬¡æœ€å¤§æµã€‚å¯è¡ŒæµåŠ æœ€å¤§æµå³ä¸ºç­”æ¡ˆã€‚</p><p><a href="https://www.luogu.com.cn/paste/2rs524un">code</a></p><h4 id="5-æ–‡ç†åˆ†ç§‘"><a href="#5-æ–‡ç†åˆ†ç§‘" class="headerlink" title="5.æ–‡ç†åˆ†ç§‘"></a><a href="https://www.luogu.com.cn/problem/P4313">5.æ–‡ç†åˆ†ç§‘</a></h4><p>æ¯ä¸ªåŒå­¦è¦ä¹ˆé€‰æ–‡ç§‘è¦ä¹ˆé€‰ç†ç§‘ï¼Œè¯¥é—®é¢˜ä¸ºåˆ’åˆ†é—®é¢˜ï¼Œç”¨æœ€å°å‰²æ¥è§£å†³ã€‚</p><p>å¯¹äºæ¯ä¸ªåŒå­¦ï¼Œä» $s$ è¿ä¸€æ¡å®¹é‡ä¸ºé€‰æ–‡ç§‘æ‰€å¾—æ»¡æ„å€¼çš„è¾¹ï¼Œå‘ $t$ è¿ä¸€æ¡å®¹é‡ä¸ºé€‰ç†ç§‘æ‰€å¾—æ»¡æ„å€¼çš„è¾¹ï¼Œè¯¥åŒå­¦æœ€ç»ˆä¸ $s$ ç›¸è¿å³ä¸ºé€‰äº†æ–‡ç§‘ï¼Œåä¹‹ç†ç§‘ã€‚</p><p>å¯¹äºé€‰ç›¸åŒç§‘ç›®çš„æ»¡æ„å€¼ï¼ˆä¸¾éƒ½é€‰æ–‡ç§‘ä¸ºä¾‹ï¼‰ï¼Œæ–°å»ºä¸€ä¸ªèŠ‚ç‚¹ $i$ ä»£è¡¨ä»¥ $i$ ä¸ºä¸­å¿ƒçš„äº”ä½åŒå­¦</p><p>ä» $s$ è¿ä¸€æ¡å®¹é‡ä¸ºå…¨é€‰æ–‡ç§‘æ‰€å¾—æ»¡æ„å€¼çš„è¾¹ï¼Œå‘äº”ä½åŒå­¦åˆ†åˆ«è¿ä¸€æ¡å®¹é‡ä¸º $\infty$ çš„è¾¹ã€‚</p><p>è¡¨ç¤ºè‹¥è¦è·å¾—å…¨é€‰æ–‡ç§‘æ‰€å¾—çš„æ»¡æ„å€¼ï¼Œåˆ™äº”ä½åŒå­¦çš„ç†ç§‘è¾¹ï¼ˆå®¹é‡ä¸ºé€‰ç†ç§‘æ‰€å¾—æ»¡æ„å€¼çš„è¾¹ï¼‰éƒ½è¦å‰²æ–­ã€‚</p><p>æœ€å¤§æ»¡æ„å€¼å³ä¸ºå‰©ä¸‹çš„è¾¹çš„è¾¹æƒï¼Œç”¨æ»¡æ„åº¦ä¹‹å’Œå‡å»æœ€å°å‰²å³å¯ã€‚</p><p><a href="https://www.luogu.com.cn/paste/s1vbg5f8">code</a></p><h4 id="6-éª‘å£«å…±å­˜é—®é¢˜"><a href="#6-éª‘å£«å…±å­˜é—®é¢˜" class="headerlink" title="6.éª‘å£«å…±å­˜é—®é¢˜"></a><a href="https://www.luogu.com.cn/problem/P3355">6.éª‘å£«å…±å­˜é—®é¢˜</a></h4><p>ä»å¯çœ‹æˆåˆ’åˆ†é—®é¢˜ï¼Œå³æ¯ä¸ªä½ç½®é€‰æˆ–ä¸é€‰ã€‚é™åˆ¶ä¸ºé€‰æ‹©æŸä¸ªç‚¹åˆ™å‘¨å›´çš„ç‚¹å¼ºåˆ¶ä¸é€‰ã€‚</p><p>ä¸ºäº†åŠ è¾¹æ»¡è¶³è¯¥é™åˆ¶ï¼Œä¸€ä¸ªç‚¹ä¸ç›¸é‚»çš„ç‚¹çš„æ–¹å‘åº”æ˜¯ç›¸åçš„ï¼Œå³è¢«åˆ’åˆ†åˆ° $s$ çš„å«ä¹‰ä¸åŒã€‚</p><p>æ²¡æœ‰å¥‡ç¯ï¼Œç‚¹è¢«åˆæ³•åœ°åˆ†æˆäº†ä¸¤ç±»ï¼Œå¯¹åº”åŸå›¾é»‘ç™½æŸ“è‰²çš„ç»“æœã€‚</p><p>å»ºå›¾æ—¶æµé‡ä¸º $0$ çš„è¾¹å¯ä»¥çœå»ï¼Œè¿™æ ·å°±æ˜¯ä¸»æµçš„å»ºå›¾æ–¹å¼äº†ã€‚</p><p>æ­¤é¢˜çš„ $\infty$ å¯ä»¥è§†ä¸º $1$ï¼Œå‘ç°å»ºå›¾ä¸äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ç›¸åŒï¼Œäº‹å®ä¸Šæœ¬é¢˜å°±æ˜¯æ±‚äºŒåˆ†å›¾æœ€å¤§ç‹¬ç«‹é›†ã€‚</p><h4 id="7-å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜"><a href="#7-å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜" class="headerlink" title="7.å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜"></a><a href="https://www.luogu.com.cn/problem/P2762">7.å¤ªç©ºé£è¡Œè®¡åˆ’é—®é¢˜</a></h4><p>è€ƒè™‘ä¸€èˆ¬çš„é—®é¢˜ï¼Œå³æœ€å¤§æƒé—­åˆå­å›¾ã€‚</p><p>çœ‹æˆåˆ’åˆ†é—®é¢˜ï¼Œéœ€è¦æ»¡è¶³ä¸€ä¸ªç‚¹è¢«é€‰ï¼Œé‚£ä¹ˆå®ƒçš„é‚»ç‚¹å¼ºåˆ¶è¢«é€‰ã€‚</p><p>ç”±äºç‚¹æƒæœ‰è´Ÿæ•°ï¼Œä¸èƒ½ç›´æ¥å»ºå›¾ï¼Œå…ˆåŠ ä¸Šç‚¹æƒçš„ç»å¯¹å€¼å³å¯ã€‚</p><p>è¯¦ç»†è§£é‡Šã€‚</p><p>å¯¹äºç‚¹æƒä¸ºæ­£çš„ï¼Œè¿è¾¹ä¸º $val,0$ï¼Œç­”æ¡ˆä¸º $val-å‰²$ï¼ˆæœ€å°å‰²æ»¡è¶³ä¿ç•™è¾¹çš„æƒå€¼æœ€å¤§ï¼‰ã€‚</p><p>å¯¹äºç‚¹æƒä¸ºè´Ÿçš„ï¼Œå¼€å§‹è¿è¾¹ $val,0$ï¼Œç­”æ¡ˆä¸º $val-å‰²$ï¼Œç”±äº $val$ ä¸ºè´Ÿï¼Œè€ƒè™‘è¿è¾¹ $0,-val$ï¼Œç­”æ¡ˆä¸º $val-(å‰²+val)=0-å‰²$ã€‚</p><h4 id="8-Hard-Life"><a href="#8-Hard-Life" class="headerlink" title="8.Hard Life"></a><a href="https://www.luogu.com.cn/problem/UVA1389">8.Hard Life</a></h4><p>é€šè¿‡01åˆ†æ•°è§„åˆ’æ±‚è§£ã€‚äºŒåˆ† $\frac{|E|}{|V|}$ï¼ˆè®°ä¸º$g$ï¼‰ã€‚è¦åˆ¤æ–­æ˜¯å¦æœ‰</p><script type="math/tex; mode=display">\begin{align}\frac{|E|}{|V|} &> g \\|E|-g|V| &> 0\end{align}</script><p>å³æ±‚å‡ºå½“å‰ $|E|-g|V|$ çš„æœ€å¤§å€¼ã€‚</p><p>äºŒåˆ†çš„ä¸‹é™ä¸º $\frac{1}{n}$ ï¼Œä¸Šé™ä¸º $m$ ï¼Œä¸¤ä¸ªä¸åŒçš„å¯†åº¦å·®æœ€å°‘ä¸º $\frac{1}{n^2}$ è¿™å†³å®šäº†ç²¾åº¦ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨æœ€å°å‰²æ±‚è§£$\left|E\right|-g\left|V\right |$ çš„æœ€å¤§å€¼ã€‚</p><p>å°†æ— å‘è¾¹æ‹†ä¸ºä¸¤æ¡æœ‰å‘è¾¹ã€‚</p><p>è®° $V$ ä¸ºä¸ $s$ ç›¸è¿çš„ç‚¹é›†ï¼Œå…¶è¡¥é›†ä¸º $Vâ€™$ï¼Œ$C[V,Vâ€™]$ ä¸ºèµ·ç‚¹åœ¨ $V$ï¼Œç»ˆç‚¹åœ¨ $Vâ€™$ çš„è¾¹çš„ä¸ªæ•°ã€‚åˆ™</p><script type="math/tex; mode=display">|E|=\frac{\sum_{u \in V}out_u-C[V,V']}{2}</script><p>è¿™æ ·å°±å°†è¾¹çš„ä¿¡æ¯è½¬åŒ–ä¸ºç‚¹çš„ä¿¡æ¯äº†ã€‚</p><p>è€ƒè™‘å¦‚ä½•å‡‘å‡ºåŸå¼ã€‚æœ€å°å‰²ä¸ºä¸‹é¢ä¸‰ç§è¾¹çš„å®¹é‡å’Œ</p><ul><li><p>$s \to Vâ€™$</p></li><li><p>$V \to t$</p></li><li><p>$V \to Vâ€™$</p></li></ul><p>å¯¹äºè¾¹ä¸‰ï¼Œå¯ä»¥å°†åŸå›¾ä¸­çš„è¾¹çš„å®¹é‡è®¾ä¸º $1$ï¼Œå¾—åˆ° $C[V,Vâ€™]$ã€‚å¯¹äºè¾¹äºŒï¼Œè®¾å®¹é‡ä¸º $2g-out_i$ï¼Œä½†æ˜¯è¿™æ ·ä¼šä½¿æœ‰çš„å®¹é‡ä¸ºè´Ÿï¼ŒåŠ ä¸€ä¸ª $\Delta$ å³å¯ï¼ˆç”¨ $m$ï¼‰ã€‚è¿™æ ·ä¼šå¤šç®— $|V|m$ï¼Œè®©è¾¹ä¸€å®¹é‡ä¸º $m$ã€‚</p><p>æœ€å°å‰²å³ä¸º</p><script type="math/tex; mode=display">mn+C[V,V']+2g|V|-\sum_{u \in V}out_u = mn+2gn-2m</script><p>æ‰€ä»¥ $m-gn=\frac{(mn-\texttt{maxflow})}{2}$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/epvrztkw">code</a></p><h4 id="9-æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜"><a href="#9-æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜" class="headerlink" title="9.æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜"></a><a href="https://www.luogu.com.cn/problem/P2764">9.æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜</a></h4><p>å°†æ¯ä¸ªç‚¹çœ‹ä½œä¸€æ¡è·¯å¾„ï¼Œæ¯æ¬¡å¯ä»¥é¦–å°¾åˆå¹¶ä¸¤æ¡è·¯å¾„ã€‚</p><p>å°†æ¯ä¸ªç‚¹æ‹†ä¸º $in,out$ï¼Œå¯¹äºè¾¹ $u \to v$ï¼Œè¿è¾¹ $(out_u,in_v,1)$ã€‚</p><p>è·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…å³å¯ã€‚</p><p>å¯¹äºå…è®¸é“¾ç›¸äº¤çš„é—®é¢˜ï¼Œå…ˆè·‘ä¼ é€’é—­åŒ…ï¼Œå†è·‘äºŒåˆ†å›¾æœ€å¤§åŒ¹é…ã€‚</p><h4 id="10-CTSC2008-ç¥­ç¥€"><a href="#10-CTSC2008-ç¥­ç¥€" class="headerlink" title="10.[CTSC2008] ç¥­ç¥€"></a><a href="https://www.luogu.com.cn/problem/P4298">10.[CTSC2008] ç¥­ç¥€</a></h4><blockquote><p>ä¸€ä¸ª DAG ä¸­æœ€é•¿åé“¾çš„å¤§å°ï¼Œç­‰äºæœ€å°é“¾è¦†ç›–çš„å¤§å°ã€‚</p></blockquote><p>ç”±é¸½å·¢åŸç†å¯çŸ¥ï¼Œæœ€é•¿åé“¾ $\le$ æœ€å°é“¾è¦†ç›–ã€‚åªéœ€æ„é€ æ–¹æ¡ˆå³å¯ã€‚</p><p>å°†åŸå›¾ä¼ é€’é—­åŒ…åæ‹†ç‚¹å»ºå‡ºäºŒåˆ†å›¾ï¼Œæ ‡è®°æœ€å¤§ç‹¬ç«‹é›†ä¸­çš„ç‚¹ï¼Œè‹¥åŸå›¾ä¸­ç‚¹çš„å…¥ç‚¹ä¸å‡ºç‚¹å‡è¢«æ ‡è®°ï¼Œåˆ™è¯¥ç‚¹å±äºæœ€é•¿åé“¾ã€‚</p><p>ä¸€ä¸ªç‚¹çš„å…¥ç‚¹ä¸å‡ºç‚¹å‡åœ¨ç‹¬ç«‹é›†ä¸­ï¼Œåæ˜ åˆ°åŸå›¾ä¸Šï¼Œåˆ™å®ƒä¸å…¶ä»–åé“¾ä¸Šçš„ç‚¹å‡æœªç›´æ¥ç›¸è¿ï¼Œæ‰€ä»¥é€‰å‡ºçš„ç‚¹ä¸€å®šä¸ºåé“¾ã€‚</p><p>ç”±äºæœ€å°é“¾è¦†ç›– $=n-$ æœ€å¤§åŒ¹é…æ•°ã€æœ€å¤§ç‹¬ç«‹é›† $=2n-$ æœ€å¤§åŒ¹é…æ•°ï¼Œæ‰€ä»¥æœ€å°é“¾è¦†ç›– $=$ æœ€å¤§ç‹¬ç«‹é›† $-n$ã€‚</p><p>é‚£ä¹ˆåªè¦æ¯ä¸ªç‚¹è‡³å°‘æœ‰ä¸€ä¸ªå…¥ç‚¹æˆ–å‡ºç‚¹è¢«æ ‡è®°ï¼Œåˆ™é€‰å‡ºçš„æ–¹æ¡ˆä¸ºæœ€å¤§åé“¾ã€‚å¯ä»¥åè¯æ³•è¯æ˜ã€‚</p><p>è‹¥ç‚¹ $i$ çš„å…¥ç‚¹ï¼ˆ$iâ€™$ï¼‰ä¸å‡ºç‚¹ï¼ˆ $iâ€™â€™$ ï¼‰å‡æœªè¢«æ ‡è®°ï¼Œåˆ™å¿…æœ‰ $jâ€™â€™$ ä¸ $iâ€™$ ç›¸è¿ï¼Œ$kâ€™$ ä¸ $iâ€™â€™$ ç›¸è¿ï¼Œä¸” $jâ€™â€™,kâ€™$ å‡è¢«æ ‡è®°ã€‚</p><p>ç”±äºåŸå›¾ä¸º DAG æ‰€ä»¥ $j,k$ ä¸ä¸ºåŒä¸€ç‚¹ã€‚</p><p>ç”±äºå…ˆè¿›è¡Œäº†ä¼ é€’é—­åŒ…ï¼Œæ‰€ä»¥è‹¥ $j \to i$ ä¸” $i \to k$ ï¼Œåˆ™å¿…æœ‰ $j \to k$ ï¼Œå³ $jâ€™â€™$ ä¸ $kâ€™$ ç›¸è¿ï¼Œæ­¤æ—¶ä¸æ»¡è¶³ç‹¬ç«‹é›†çš„æ¡ä»¶ï¼Œæ•…è¯¥æƒ…å†µä¸æˆç«‹ã€‚</p><p>å¯¹äºç¬¬ä¸‰é—®ï¼Œæšä¸¾æ¯ä¸ªç‚¹ï¼Œå°†ä¸å®ƒç›¸è¿çš„ç‚¹åˆ å»ï¼Œå†è®¡ç®—æœ€é•¿åé“¾ã€‚è‹¥æ­¤æ—¶çš„æœ€é•¿åé“¾ $=ans-1$ï¼Œåˆ™è¯¥ç‚¹å¯é€‰ï¼Œåä¹‹ä¸å¯é€‰ã€‚</p><p><a href="https://www.luogu.com.cn/paste/uog5xvyx">code</a></p><h4 id="11-æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜"><a href="#11-æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜" class="headerlink" title="11.æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜"></a><a href="https://www.luogu.com.cn/problem/P3358">11.æœ€é•¿kå¯é‡åŒºé—´é›†é—®é¢˜</a></h4><p>é™åˆ¶æ˜¯ $\le k$ è€ƒè™‘ç½‘ç»œæµï¼Œå»ºå›¾çœ‹çœ‹å¾—äº†ï¼Œæ„Ÿè§‰å°±æ˜¯å¦™æ‰‹å¶å¾—å•Šï¼Œä¸ä¼šè®²ã€‚</p><h4 id="12-CTSC1999-å®¶å›­-æ˜Ÿé™…è½¬ç§»é—®é¢˜"><a href="#12-CTSC1999-å®¶å›­-æ˜Ÿé™…è½¬ç§»é—®é¢˜" class="headerlink" title="12.[CTSC1999] å®¶å›­/æ˜Ÿé™…è½¬ç§»é—®é¢˜"></a><a href="https://www.luogu.com.cn/problem/P2754">12.[CTSC1999] å®¶å›­/æ˜Ÿé™…è½¬ç§»é—®é¢˜</a></h4><p>å¤ªç©ºèˆ¹åªå¯å®¹çº³ $h$ ä¸ªäººï¼Œå³å¤ªç©ºèˆ¹æœ€å¤šå®¹çº³ $h$ ä¸ªäººï¼Œå¯ä»¥å‘ç°æ˜¯å®¹é‡çš„å®šä¹‰ï¼Œç”¨ç½‘ç»œæµæ±‚è§£</p><p>ç”±äºå¤ªç©ºèˆ¹ç§»åŠ¨çš„ç‰¹æ®Šæ€§å’Œæå°çš„æ•°æ®èŒƒå›´ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³åˆ°æšä¸¾ç­”æ¡ˆã€åŠ¨æ€åŠ è¾¹ï¼Œç›´åˆ° $k$ ä¸ªäººè¿å‡ºè¾“å‡ºæ­¤æ—¶çš„ç­”æ¡ˆã€‚</p><p>æ¯æ¬¡åœ¨å¯ä»¥ä¸Šä¸€æ¬¡çš„æ®‹é‡ç½‘ç»œä¸Šè·‘æœ€å¤§æµã€‚</p><p>å¯¹äºæ— è§£çš„åˆ¤æ–­ï¼Œå¦‚æœåœ°çƒå’Œæœˆçƒæ— æ³•é€šè¿‡å¤ªç©ºèˆ¹ç›¸è¿å³æ— è§£ï¼Œç”¨å¹¶æŸ¥é›†åˆ¤æ–­ã€‚</p><p><a href="https://www.luogu.com.cn/paste/cl4n46ve">code</a></p><h4 id="13-NOI2010-æµ·æ‹”"><a href="#13-NOI2010-æµ·æ‹”" class="headerlink" title="13.[NOI2010] æµ·æ‹”"></a><a href="https://www.luogu.com.cn/problem/P2046">13.[NOI2010] æµ·æ‹”</a></h4><p>å…ˆè´ªå¿ƒä¸€ä¸‹ï¼Œæœ€åçš„å›¾ä¸€å®šä¸ºä¸€ç‰‡ $1$ ä¸ä¸€ç‰‡ $0$ã€‚</p><p>æ‰€ä»¥è¯¥é¢˜å°±è½¬åŒ–ä¸ºäº†æœ€å°å‰²é—®é¢˜ï¼Œä½†æ˜¯ç”¨æœ€å¤§æµæ±‚æœ€å°å‰²ä¼šè¶…æ—¶ã€‚</p><p>å›¾ä¸ºå¹³é¢å›¾ï¼Œæˆ‘ä»¬å¯ä»¥å°†å¹³é¢å›¾æœ€å°å‰²è½¬åŒ–ä¸ºå¯¹å¶å›¾æœ€çŸ­è·¯ã€‚</p><p>å…·ä½“åœ°ï¼Œå°†å¹³é¢å›¾ä¸­æ¯ä¸€ä¸ªå¹³é¢çœ‹ä½œä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†ä¸¤ä¸ªå¹³é¢ä¹‹é—´çš„é‚»è¾¹è½¬åŒ–ä¸ºä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è¾¹ã€‚</p><p>å¯¹äºæœ€ä¸Šä¾§å’Œæœ€å³ä¾§çš„è¾¹ï¼Œå°†å®ƒçœ‹ä½œ $s$ ä¸æ‰€åœ¨å¹³é¢çš„è¾¹ã€‚</p><p>å¯¹äºæœ€ä¸‹ä¾§å’Œæœ€å·¦ä¾§çš„è¾¹ï¼Œå°†å®ƒçœ‹ä½œ $t$ ä¸æ‰€åœ¨å¹³é¢çš„è¾¹ã€‚</p><p>ä¾‹å¦‚ï¼Œ$i$ ä¸ $j$ å¹³é¢ä¸Šä¸‹ç›¸é‚»ï¼Œå¯¹äºä¸­é—´ä»è¥¿åˆ°ä¸œçš„é‚»è¾¹ï¼Œå°†å…¶è½¬åŒ–ä¸º $i \to j$ã€‚</p><p>å› ä¸ºè‹¥è¯¥è¾¹è®¡å…¥ç­”æ¡ˆï¼Œåˆ™è¥¿è¾¹çš„èŠ‚ç‚¹ä¸º $0$ ï¼Œä¸œè¾¹çš„èŠ‚ç‚¹ä¸º $1$ï¼Œæ‰€ä»¥è½¬åŒ–ä¸ºä»ä¸Šåˆ°ä¸‹çš„è¾¹</p><p>å°†å…¶ä»–æƒ…å†µéƒ½æ¨ä¸€éï¼Œå¯ä»¥å‘ç°æ˜¯å°†åŸå›¾ä¸­çš„è¾¹é¡ºæ—¶é’ˆæ—‹è½¬ $90$ åº¦ã€‚</p><p><a href="https://www.luogu.com.cn/paste/pssi03u7">code</a></p><h4 id="14-AHOI2009-æœ€å°å‰²"><a href="#14-AHOI2009-æœ€å°å‰²" class="headerlink" title="14.[AHOI2009] æœ€å°å‰²"></a><a href="https://www.luogu.com.cn/problem/P4126">14.[AHOI2009] æœ€å°å‰²</a></h4><ul><li><p>æ»¡æµä¸”ä¸¤ç«¯ç‚¹ä¸åœ¨åŒä¸€è¿é€šåˆ†é‡çš„è¾¹ä¸ºå¯è¡Œè¾¹ã€‚</p></li><li><p>æ»¡æµä¸”ä¸¤ç«¯ç‚¹åˆ†åˆ«åœ¨ $s,t$ çš„å¼ºè¿é€šåˆ†é‡çš„è¾¹ä¸ºå¿…é¡»è¾¹ã€‚</p></li></ul><p>å°†è·‘ä»»æ„æœ€å¤§æµåå¾—åˆ°çš„æ®‹é‡ç½‘ç»œç¼©ç‚¹ï¼Œå¾—åˆ°ä¸€å¼  DAGï¼ŒDAG ä¸Šä»»æ„ç´§çš„å‰²éƒ½æ˜¯åŸå›¾çš„æœ€å°å‰²ã€‚</p><h2 id="æ‚é¢˜"><a href="#æ‚é¢˜" class="headerlink" title="æ‚é¢˜"></a>æ‚é¢˜</h2><h4 id="1-A-Plug-for-UNIX"><a href="#1-A-Plug-for-UNIX" class="headerlink" title="1.A Plug for UNIX"></a><a href="https://www.luogu.com.cn/problem/UVA753">1.A Plug for UNIX</a></h4><p>ç±»ä¼¼äºäºŒåˆ†å›¾æœ€å¤§åŒ¹é…å»ºå›¾</p><ul><li><p>å¯¹äºæ’åº§ $i$ è¿ $(i,t,1)$ã€‚</p></li><li><p>å¯¹äºæ’å¤´ $i$ è¿ $(s,i,1)$ã€‚</p></li><li><p>å¯¹äºè½¬æ¢å™¨ $u \to v$ è¿ $(u,v,\infty)$ã€‚</p></li></ul><p>è·‘æœ€å¤§æµå³å¯ã€‚</p><p><a href="https://www.luogu.com.cn/paste/smekujoo">code</a></p><h4 id="2-æ–¹æ ¼å–æ•°åŠ å¼ºç‰ˆ"><a href="#2-æ–¹æ ¼å–æ•°åŠ å¼ºç‰ˆ" class="headerlink" title="2.æ–¹æ ¼å–æ•°åŠ å¼ºç‰ˆ"></a><a href="https://www.luogu.com.cn/problem/P2045">2.æ–¹æ ¼å–æ•°åŠ å¼ºç‰ˆ</a></h4><h4 id="3-SCOI2007-ä¿®è½¦"><a href="#3-SCOI2007-ä¿®è½¦" class="headerlink" title="3.[SCOI2007] ä¿®è½¦"></a><a href="https://www.luogu.com.cn/problem/P2053">3.[SCOI2007] ä¿®è½¦</a></h4><p>ç­‰å¾…ç›¸å½“äºæ¯æ¬¡ä»å¤´å¼€å§‹èµ°ä¸€éã€‚è´¹ç”¨æµè§£å†³ã€‚</p><h4 id="4-NOI2008-å¿—æ„¿è€…æ‹›å‹Ÿ"><a href="#4-NOI2008-å¿—æ„¿è€…æ‹›å‹Ÿ" class="headerlink" title="4.[NOI2008] å¿—æ„¿è€…æ‹›å‹Ÿ"></a><a href="https://www.luogu.com.cn/problem/P3980">4.[NOI2008] å¿—æ„¿è€…æ‹›å‹Ÿ</a></h4><p>ç±»ä¼¼æœ€å°è·¯å¾„è¦†ç›–é—®é¢˜ï¼Œå®¹é‡ä¸º $\infty-a_i$ å³å¯ã€‚</p><h4 id="5-Help-Little-Laura"><a href="#5-Help-Little-Laura" class="headerlink" title="5.Help Little Laura"></a><a href="https://www.luogu.com.cn/problem/UVA1659">5.Help Little Laura</a></h4><p>ç»™ä½ ä¸€ä¸ªæœ‰å‘å›¾ï¼Œæ¯æ¡è¾¹çš„æƒå€¼ä¸º $len \times x-y$ ï¼Œæ‰¾ä¸€äº›ä¸ç›¸äº¤çš„ç¯ï¼Œä½¿å¾—æƒå€¼å’Œæœ€å¤§ã€‚</p><p>è‹¥å°†æ¯æ¡è¾¹çš„æµé‡å®šä¸º $1$ ï¼Œåˆ™ä¸€ä¸ªåˆæ³•çš„æ¶‚è‰²æ–¹å¼ä¸­æ¯ä¸ªç‚¹çš„å…¥æµä¸å‡ºæµç›¸ç­‰ï¼Œè·‘å¯è¡Œæµå³å¯ã€‚</p><p><a href="https://www.luogu.com.cn/paste/8e71oeqk">code</a></p><p>è¿˜å¯ä»¥æ¯æ¬¡ç”¨ spfa æ‰¾ä¸€ä¸ªè´Ÿç¯å¢å¹¿ã€‚</p><h4 id="6-Euler-Circuit"><a href="#6-Euler-Circuit" class="headerlink" title="6.Euler Circuit"></a><a href="https://www.luogu.com.cn/problem/UVA10735">6.Euler Circuit</a></h4><p>ç”±äºæ¬§æ‹‰å›è·¯ä¸­æ¯æ¡è¾¹åªèƒ½ç»è¿‡ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸èƒ½ç®€å•åœ°å°†æ— å‘è¾¹æ‹†ä¸ºæœ‰å‘è¾¹ã€‚</p><p>æˆ‘ä»¬éœ€è¦æ‰¾ä¸€ä¸ªå°†æ— å‘è¾¹å®šå‘çš„æ–¹æ¡ˆï¼Œä½¿åŸå›¾å­˜åœ¨æ¬§æ‹‰å›è·¯ã€‚é‚£ä¹ˆéœ€è¦æ»¡è¶³æ¯ä¸ªç‚¹çš„å…¥åº¦å‡å‡ºåº¦ä¸º $0$ã€‚</p><p>å…ˆéšæ„å°†æ— å‘è¾¹å®šå‘ï¼Œè®° $in_i$ ä¸ºç‚¹içš„å…¥åº¦å‡å‡ºåº¦ã€‚</p><p>å°† $u \to v$ çš„æ— å‘è¾¹å–ååˆ™ $in_u+=2,in_v-=2$ï¼Œç›¸å½“äºæµé‡ä» $u$ æµå…¥ $v$ã€‚</p><p>æŒ‰æ®‹é‡ç½‘ç»œå»ºå›¾ï¼Œå†è·‘æ¬§æ‹‰å›è·¯å³å¯ã€‚</p><p><a href="https://www.luogu.com.cn/paste/820sgya9">code</a></p><h4 id="7-Chips-Challenge"><a href="#7-Chips-Challenge" class="headerlink" title="7.Chips Challenge"></a><a href="https://www.luogu.com.cn/problem/UVA1104">7.Chips Challenge</a></h4><p>ç”±äºæ¯ä¸€è¡Œä¸æ¯ä¸€åˆ—çš„èŠ¯ç‰‡æ•°ç›¸åŒï¼Œå¯ä»¥å°†è¡Œä¸åˆ—çœ‹æˆä¸€ä¸ªç‚¹ã€‚</p><p>å¯¹äº $.(i,j)$ï¼Œè¿ $(i,j,1,1)$ã€‚</p><p>å¯¹äº $C(i,j)$ï¼Œç”±äºè¦å¼ºåˆ¶é€‰æ‹©ï¼Œè¿ $(i,j,1,\infty)$ã€‚</p><p>æ‰€ä»¥é¢˜ç›®å°±è½¬åŒ–ä¸ºä¸€ä¸ªæœ€å¤§è´¹ç”¨å¯è¡Œæµé—®é¢˜ï¼Œé™¤å» $\infty$ çš„è´¹ç”¨å’Œå³ä¸ºæ·»åŠ çš„éƒ¨ä»¶ä¸ªæ•°ã€‚</p><p>å†è€ƒè™‘ $A/B$ è¿™ä¸ªé™åˆ¶ã€‚ç”±äº $N$ è¾ƒå°ï¼Œå¯ä»¥è€ƒè™‘æšä¸¾è¡Œæˆ–åˆ—æœ€å¤šçš„éƒ¨ä»¶æ•° $k$ã€‚æ‹†ç‚¹ï¼Œè¿ $(iâ€™,iâ€™â€™,k,0)$ã€‚ </p><p>å¦‚æœ $å½“å‰Cçš„ä¸ªæ•° \times A&gt;=Bk$ åˆ™åˆæ³•ï¼Œå–æœ€å¤§å€¼å³ä¸º $ans$ã€‚</p><p>å¯¹äºæœ€å¤§è´¹ç”¨å¯è¡Œæµé—®é¢˜ï¼Œæˆ‘ä»¬å…ˆå°†è¾¹æƒå–åï¼Œè½¬åŒ–ä¸ºæœ€å°è´¹ç”¨å¯è¡Œæµã€‚</p><p>è‡ªå·±æ¨ä¸€ä¸‹å³å¯å¾—åˆ°å¦‚ä¸‹è¿è¾¹æ–¹å¼</p><ul><li><p>$(iâ€™,iâ€™â€™,k,0)$ã€‚</p></li><li><p>$(s,iâ€™,maxl_i,0)$ã€‚</p></li><li><p>$(iâ€™â€™,t,maxh_i,0)$ã€‚</p></li></ul><p>å¯¹äº$.(i,j)$ï¼Œè¿ $(jâ€™,iâ€™â€™,1,1)$ï¼Œæ­¤å¤„è¿è¾¹æ˜¯ä¸ºäº†åˆ è¾¹ï¼Œç”±äº $C$ è¿çš„è¾¹ä¸éœ€è¦åˆ ï¼Œæ‰€ä»¥å¯ä¸è¿è¯¥è¾¹ã€‚</p><p><a href="https://www.luogu.com.cn/paste/6votwsa6">code</a></p><h4 id="8-ZJOI2011-è¥æ•‘çš®å¡ä¸˜"><a href="#8-ZJOI2011-è¥æ•‘çš®å¡ä¸˜" class="headerlink" title="8.[ZJOI2011] è¥æ•‘çš®å¡ä¸˜"></a><a href="https://www.luogu.com.cn/problem/P4542">8.[ZJOI2011] è¥æ•‘çš®å¡ä¸˜</a></h4><p><a href="https://www.luogu.com.cn/paste/wrbsbni5">code</a></p><h4 id="9-æ— é™ä¹‹ç¯"><a href="#9-æ— é™ä¹‹ç¯" class="headerlink" title="9.æ— é™ä¹‹ç¯"></a><a href="https://www.luogu.com.cn/problem/P4003">9.æ— é™ä¹‹ç¯</a></h4><p><a href="https://www.luogu.com.cn/paste/js4jzhd0">code</a></p><h4 id="10-WC2007-å‰ªåˆ€çŸ³å¤´å¸ƒ"><a href="#10-WC2007-å‰ªåˆ€çŸ³å¤´å¸ƒ" class="headerlink" title="10.[WC2007] å‰ªåˆ€çŸ³å¤´å¸ƒ"></a><a href="https://www.luogu.com.cn/problem/P4249">10.[WC2007] å‰ªåˆ€çŸ³å¤´å¸ƒ</a></h4><p>æ¯ä¸ªç‚¹çš„è´¡çŒ®å¯ä»¥å†™æˆç­‰å·®æ•°åˆ—å½¢å¼ï¼Œä¾æ¬¡è¿è¾¹å³å¯ã€‚</p><h2 id="zkw-è´¹ç”¨æµ"><a href="#zkw-è´¹ç”¨æµ" class="headerlink" title="zkw è´¹ç”¨æµ"></a>zkw è´¹ç”¨æµ</h2><p>è²Œä¼¼å°±æ˜¯å€’ç€è·‘ spfa çš„ dinicï¼Ÿ</p><h2 id="æœ€å¤§æµå”¯ä¸€æ€§åˆ¤å®š"><a href="#æœ€å¤§æµå”¯ä¸€æ€§åˆ¤å®š" class="headerlink" title="æœ€å¤§æµå”¯ä¸€æ€§åˆ¤å®š"></a>æœ€å¤§æµå”¯ä¸€æ€§åˆ¤å®š</h2><p>è·‘å‡ºæ®‹é‡ç½‘ç»œï¼Œç›¸å½“äºåˆ¤æ–­æ··åˆå›¾æ˜¯å¦æœ‰ç¯ï¼Œå°†æ— å‘è¾¹ç¼©ç‚¹è·‘æ‹“æ‰‘æ’åºå³å¯ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/uid001/p/10465580.html">EK æ—¶é—´å¤æ‚åº¦è¯æ˜</a></p><p><a href="https://www.cnblogs.com/myee/p/dinic-algorithm.html">Dinicçš„å‡ ç§å¤æ‚åº¦</a></p><p><a href="https://web.eecs.umich.edu/~pettie/matching/Karzanov-unit-flow-msqrtm-mntwothirds-msqrtn-matching-ENGLISH.pdf">On finding a maximum flow in a network with special structureand some applications 1</a></p><p><a href="https://www.luogu.com.cn/article/li2xfw2r">EKä¸å¤Ÿå¿«ï¼Ÿå†å­¦ä¸ªDinicå§</a></p><p><a href="https://www.luogu.com.cn/article/k2hh2bok">ç½‘ç»œæµ</a></p><p>æŸè¯¾ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ”¯é…ç‚¹å¯¹</title>
      <link href="/notes/%E6%94%AF%E9%85%8D%E7%82%B9%E5%AF%B9/"/>
      <url>/notes/%E6%94%AF%E9%85%8D%E7%82%B9%E5%AF%B9/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æœ‰ç”¨çš„ç‚¹å¯¹ï¼Ÿ</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-Tree-Distance"><a href="#1-Tree-Distance" class="headerlink" title="1.Tree Distance"></a><a href="https://qoj.ac/contest/1053/problem/5148">1.Tree Distance</a></h4><p>ç‚¹åˆ†æ²»ï¼Œè®° $d_u$ ä¸º $u$ åˆ°åˆ†æ²»ä¸­å¿ƒçš„è·ç¦»ï¼Œä¸¤ç‚¹é—´çš„è·ç¦» $\le d_i + d_j$ã€‚</p><p>è€ƒè™‘å¯¹äºæ¯ä¸ªç‚¹æ‰¾åˆ°ä»¥å…¶ä¸º $d$ æœ€å¤§å€¼çš„ç‚¹å¯¹ã€‚</p><p>å¯¹äº $i &lt; j &lt; k$ï¼Œè‹¥ $d_i \ge d_j,d_k$ é‚£ä¹ˆ $(i,k)$ ä¼šè¢« $(j,k)$ å®Œå…¨åŒ…å«ã€‚</p><p>å…ˆæŒ‰ç¼–å·æ’åºï¼Œå¯¹äºæ¯ä¸ªç‚¹æ‰¾åˆ°å‰é¢/åé¢ç¬¬ä¸€ä¸ª $d$ æ¯”å®ƒå°çš„ç‚¹ï¼Œç»„æˆç‚¹å¯¹ã€‚</p><p>æ€»å…± $O(n\log n)$ ä¸ªæ”¯é…ç‚¹å¯¹ã€‚è¯¢é—®ç›¸å½“äºäºŒç»´ååºï¼Œæ‰«æçº¿+çº¿æ®µæ ‘å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h4 id="2-Ynoi2008-rdCcot"><a href="#2-Ynoi2008-rdCcot" class="headerlink" title="2.[Ynoi2008] rdCcot"></a><a href="https://www.luogu.com.cn/problem/P7126">2.[Ynoi2008] rdCcot</a></h4><p>æ¯ä¸ª C-å— å– bfs åºæœ€å°ç‚¹ä½œä¸ºä»£è¡¨å…ƒã€‚</p><p>æŒ‰ç¼–å·æ’åºï¼Œå¯¹æ¯ä¸ªç‚¹æ±‚å‡º $L_i,R_i$ åˆ†åˆ«ä¸ºå…¶å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ª bfs åºæ¯”å®ƒå°ä¸”èƒ½ä¸å®ƒ C è¿é€šçš„ç‚¹ã€‚</p><p>è¯¢é—® $[l,r]$ çš„ç­”æ¡ˆä¸º $\sum_{i=l}^{r} [L_i&lt;l][r&lt;R_i]$ï¼Œæ‰«æçº¿è§£å†³ã€‚</p><p>å¯¹äº $L,R$ çš„æ±‚è§£ï¼Œç”±äºä¸è·ç¦»æœ‰å…³ï¼Œç”¨ç‚¹åˆ†æ²»ï¼Œå°†å­æ ‘èŠ‚ç‚¹æŒ‰ bfs åºæ‰«æçº¿ï¼Œçº¿æ®µæ ‘äºŒåˆ†æ±‚å‡º $L_i,R_i$ å³å¯ã€‚</p><h4 id="3-Ynoi2003-é“ƒåŸéœ²éœ²"><a href="#3-Ynoi2003-é“ƒåŸéœ²éœ²" class="headerlink" title="3.[Ynoi2003] é“ƒåŸéœ²éœ²"></a><a href="https://www.luogu.com.cn/problem/P8528">3.[Ynoi2003] é“ƒåŸéœ²éœ²</a></h4><p>å°†èŠ‚ç‚¹ç¼–å·æŒ‰ $a$ æ’åºã€‚è‹¥åŒºé—´æ»¡è¶³é¢˜é¢ä¸­ $[L,R]$ çš„é™åˆ¶ï¼Œé‚£ä¹ˆå®ƒæ˜¯åˆæ³•çš„ã€‚å¯¹äº $(x,y,lca(x,y))$</p><ul><li><p>è‹¥ $lca(x,y) \in [x,y]$ æ— å½±å“ã€‚</p></li><li><p>è‹¥ $lca(x,y)&lt;x$ é‚£ä¹ˆåŒºé—´ $[l,r] (l \in (lca(x,y),x],r \in [y,n])$ æ˜¯ä¸åˆæ³•çš„ã€‚</p></li><li><p>è‹¥ $y&lt;lca(x,y)$ é‚£ä¹ˆåŒºé—´ $[l,r] (l \in [1,x],r \in [y,lca(x,y)))$ æ˜¯ä¸åˆæ³•çš„ã€‚</p></li></ul><p>ç›¸å½“äºäºŒç»´åŒºé—´åŠ ï¼ŒæŸ¥è¯¢äºŒç»´åŒºé—´ $=0$ çš„å…ƒç´ ä¸ªæ•°ã€‚</p><p>æ‰«æçº¿ï¼Œçº¿æ®µæ ‘ç»´æŠ¤åŒºé—´æœ€å°å€¼åŠå…¶ä¸ªæ•°ï¼Œå†å² $=0$ çš„å…ƒç´ ä¸ªæ•°ï¼ŒæŸ¥è¯¢åŒºé—´å†å²å’Œã€‚</p><p>å¯¹äºè¿™ç§ä¸ lca æœ‰å…³çš„ç‚¹å¯¹æ±‚è§£ï¼Œä¸€èˆ¬ç”¨ dsu on tree é’¦å®š lca æ±‚è§£ã€‚</p><p>å¯¹äºç‰¹å®šçš„ $x$ï¼Œå–å‰é©±åç»§ä½œä¸º $y$ å³å¯ï¼Œæ€»å…± $O(n\log n)$ ä¸ªæ”¯é…ç‚¹å¯¹ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/TetrisCandy/p/18095815">æ”¯é…ç‚¹å¯¹</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>è«é˜Ÿ</title>
      <link href="/notes/%E8%8E%AB%E9%98%9F/"/>
      <url>/notes/%E8%8E%AB%E9%98%9F/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å°†è¯¢é—®ç¦»çº¿ï¼ŒæŒ‰ç‰¹å®šæ–¹å¼æ’åºï¼Œä½¿å¾—è¯¢é—®ä¹‹é—´ç§»åŠ¨çš„ä»£ä»·è¾ƒå°ã€‚</p><p>æ±‚æ‰€å±å—ä»£ç </p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) bk[i]=(i<span class="number">-1</span>)/LEN;</span><br></pre></td></tr></tbody></table></figure><p>å¸¸è§å¸¸æ•°ä¼˜åŒ–</p><ul><li><p>å·¦ç«¯ç‚¹æ‰€åœ¨å—ç›¸åŒæ—¶ï¼ŒæŒ‰å—ç¼–å·çš„å¥‡å¶å°†å³ç«¯ç‚¹å°åˆ°å¤§æˆ–å¤§åˆ°å°æ’åº</p>  <figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">cmp0</span><span class="params">(Q a,Q b)</span></span>{ <span class="keyword">return</span> bk[a.l]!=bk[b.l]?bk[a.l]&lt;bk[b.l]:bk[a.l]&amp;<span class="number">1</span>?a.r&lt;b.r:a.r&gt;b.r; }</span><br></pre></td></tr></tbody></table></figure></li><li><p>å°†ç®€å•çš„ add/del å†™å…¥ while å¾ªç¯å†…</p>  <figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span>(ql&lt;dl) dans+=<span class="number">2</span>*cnt[col[--dl]],cnt[col[dl]]++;</span><br><span class="line"><span class="keyword">while</span>(qr&gt;dr) dans+=<span class="number">2</span>*cnt[col[++dr]],cnt[col[dr]]++;</span><br><span class="line"><span class="keyword">while</span>(ql&gt;dl) cnt[col[dl]]--,dans-=<span class="number">2</span>*cnt[col[dl++]];</span><br><span class="line"><span class="keyword">while</span>(qr&lt;dr) cnt[col[dr]]--,dans-=<span class="number">2</span>*cnt[col[dr--]];</span><br></pre></td></tr></tbody></table></figure></li></ul><h2 id="æ™®é€šè«é˜Ÿ"><a href="#æ™®é€šè«é˜Ÿ" class="headerlink" title="æ™®é€šè«é˜Ÿ"></a>æ™®é€šè«é˜Ÿ</h2><h4 id="1-å›½å®¶é›†è®­é˜Ÿ-å°-Z-çš„è¢œå­"><a href="#1-å›½å®¶é›†è®­é˜Ÿ-å°-Z-çš„è¢œå­" class="headerlink" title="1.[å›½å®¶é›†è®­é˜Ÿ] å° Z çš„è¢œå­"></a><a href="https://www.luogu.com.cn/problem/P1494">1.[å›½å®¶é›†è®­é˜Ÿ] å° Z çš„è¢œå­</a></h4><p>è®°åŒºé—´ä¸­æœ‰ $n$ ç§é¢œè‰²ï¼Œé¢œè‰²ä¸º $i$ çš„æœ‰ $a_i$ ä¸ªï¼Œåˆ™æ¦‚ç‡ä¸º</p><script type="math/tex; mode=display">\frac{\sum_{i=1}^{n}a_i(a_i-1)}{(r-l+1)(r-l)}</script><p>å°†è¯¢é—®ç¦»çº¿ï¼Œç”¨è«é˜Ÿå³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\sqrt{n})$</p><h2 id="å¸¦ä¿®è«é˜Ÿ"><a href="#å¸¦ä¿®è«é˜Ÿ" class="headerlink" title="å¸¦ä¿®è«é˜Ÿ"></a>å¸¦ä¿®è«é˜Ÿ</h2><h4 id="1-å›½å®¶é›†è®­é˜Ÿ-æ•°é¢œè‰²-ç»´æŠ¤é˜Ÿåˆ—"><a href="#1-å›½å®¶é›†è®­é˜Ÿ-æ•°é¢œè‰²-ç»´æŠ¤é˜Ÿåˆ—" class="headerlink" title="1.[å›½å®¶é›†è®­é˜Ÿ] æ•°é¢œè‰² / ç»´æŠ¤é˜Ÿåˆ—"></a><a href="https://www.luogu.com.cn/problem/P1903">1.[å›½å®¶é›†è®­é˜Ÿ] æ•°é¢œè‰² / ç»´æŠ¤é˜Ÿåˆ—</a></h4><p>å°†æ—¶é—´çœ‹ä½œä¸€ç»´ï¼Œå³å¯å˜æˆä¸‰ç»´é—®é¢˜ <a href="https://www.luogu.com.cn/paste/8937lvmc">code</a><br>ã€‚</p><p>åˆ†ææ—¶é—´å¤æ‚åº¦ï¼Œå°†ä¸€æ¬¡æ“ä½œçœ‹ä½œä¸€ä¸ªç‚¹ $(t,x,y)$ï¼Œå°†ç‚¹æŒ‰æŸä¸€é¡ºåºæ’åºï¼Œé‚£ä¹ˆä¸‰ä¸ªæŒ‡é’ˆç§»åŠ¨çš„æ€»è·ç¦»å°±æ˜¯ç›¸é‚»ç‚¹æ›¼å“ˆé¡¿è·ç¦»ä¹‹å’Œã€‚åˆ†åˆ«è€ƒè™‘ä¸‰ä¸ªæŒ‡é’ˆçš„ç§»åŠ¨å³å¯ï¼Œä¸€èˆ¬å–å—é•¿ä¸º $n^{\frac{2}{3}}$ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º $O(n^{\frac{3}{5}})$ã€‚</p><h4 id="2-Machine-Learning"><a href="#2-Machine-Learning" class="headerlink" title="2.Machine Learning"></a><a href="https://www.luogu.com.cn/problem/CF940F">2.Machine Learning</a></h4><p>å¦‚æœæ²¡æœ‰ä¿®æ”¹å¯ä»¥ç”¨åªå‡ä¸åŠ çš„å›æ»šè«é˜Ÿã€‚</p><p>æ­¤é¢˜ mex æ˜¯å‡ºç°ä¸ªæ•°çš„ï¼Œæœ€å¤§ä¸º $\sqrt{n}$ã€‚</p><p>æ‰€ä»¥æ¯æ¬¡ç§»åŠ¨å®Œï¼Œç›´æ¥æš´åŠ›æ±‚è§£å³å¯ã€‚</p><p><a href="https://www.luogu.com.cn/paste/mbw2kj1q">code</a></p><h2 id="å›æ»šè«é˜Ÿ"><a href="#å›æ»šè«é˜Ÿ" class="headerlink" title="å›æ»šè«é˜Ÿ"></a>å›æ»šè«é˜Ÿ</h2><h4 id="1-ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ-amp-ä¸åˆ é™¤è«é˜Ÿ"><a href="#1-ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ-amp-ä¸åˆ é™¤è«é˜Ÿ" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ&amp;ä¸åˆ é™¤è«é˜Ÿ"></a><a href="https://www.luogu.com.cn/problem/P5906">1.ã€æ¨¡æ¿ã€‘å›æ»šè«é˜Ÿ&amp;ä¸åˆ é™¤è«é˜Ÿ</a></h4><p>ä¸€äº›é¢˜ç›®åˆ é™¤æ“ä½œå¹¶ä¸å¥½åšï¼Œå¯ä»¥å°†å…¶é¿å…ã€‚</p><p>è€ƒè™‘è®¡ç®—å¤æ‚åº¦çš„è¿‡ç¨‹ï¼Œæ¯æ¬¡ $l$ æŒ‡é’ˆçš„ç§»åŠ¨æˆ‘ä»¬éƒ½æ˜¯æŒ‰ $\sqrt{n}$ çš„æ¬¡æ•°è®¡ç®—ã€‚</p><p>è¿™ç»™äº†æˆ‘ä»¬å¾ˆå¤§çš„æ“ä½œç©ºé—´ï¼šå¯¹äºæ¯æ¬¡è¯¢é—®æˆ‘ä»¬éƒ½å¯ä»¥å°† $l$ æŒ‡é’ˆç§»åŠ¨ $\sqrt{n}$ æ¬¡ï¼Œè€Œä¸æ”¹å˜æ—¶é—´å¤æ‚åº¦ã€‚</p><p>æ¯ä¸ªå—å†…å³æŒ‡é’ˆéƒ½æ˜¯å¢åŠ æ“ä½œï¼Œå·¦æŒ‡é’ˆæš´åŠ›è®¡ç®—å³å¯ã€‚è¿™æ ·å°±åªæœ‰å¢åŠ æ“ä½œäº†ã€‚</p><p>å¯¹äº $l$ å’Œ $r$ åœ¨ä¸€ä¸ªå—å†…çš„ï¼Œéœ€è¦ç›´æ¥æš´åŠ›è®¡ç®—ã€‚</p><h2 id="æ ‘ä¸Šè«é˜Ÿ"><a href="#æ ‘ä¸Šè«é˜Ÿ" class="headerlink" title="æ ‘ä¸Šè«é˜Ÿ"></a>æ ‘ä¸Šè«é˜Ÿ</h2><p>å°†æ ‘æ‹æ‰è½¬åŒ–ä¸ºåºåˆ—é—®é¢˜ã€‚ä¸€èˆ¬å¯å¤„ç†å­æ ‘é—®é¢˜ï¼ˆ dfs åºï¼‰ã€é“¾é—®é¢˜ï¼ˆæ¬§æ‹‰åºï¼‰ã€‚</p><h4 id="1-WC2013-ç³–æœå…¬å›­"><a href="#1-WC2013-ç³–æœå…¬å›­" class="headerlink" title="1.[WC2013] ç³–æœå…¬å›­"></a><a href="https://www.luogu.com.cn/problem/P4074">1.[WC2013] ç³–æœå…¬å›­</a></h4><p>å…ˆæ±‚å‡ºæ¬§æ‹‰åºã€‚å¯¹äº $(x,y)(dep[x]&lt;dep[y])$ è·¯å¾„ï¼Œåˆ†è®¨ä¸€ä¸‹</p><ul><li><p>$lca = x$ æ—¶ï¼ŒåŒºé—´ä¸º $[in_x,in_y]$ã€‚</p></li><li><p>$lca \ne x$ æ—¶ï¼ŒåŒºé—´ä¸º $[out_x,in_y] \cup \{lca\}$ã€‚</p></li></ul><p>å‡ºç°ä¸¤æ¬¡çš„ç‚¹ä¸è®¡å…¥ç­”æ¡ˆï¼Œå¯ä»¥ç”¨å¼‚æˆ–å®ç°ã€‚</p><h4 id="2-Ynoi2016-è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜"><a href="#2-Ynoi2016-è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜" class="headerlink" title="2.[Ynoi2016] è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜"></a><a href="https://www.luogu.com.cn/problem/P4689">2.[Ynoi2016] è¿™æ˜¯æˆ‘è‡ªå·±çš„å‘æ˜</a></h4><p>å…ˆæ±‚å‡º dfs åºï¼Œå¯ä»¥è½¬åŒ–ä¸ºåŒºé—´æŸ¥è¯¢ï¼ˆå¯¹äºæ¢æ ¹ï¼Œåˆ†è®¨ä¸€ä¸‹ï¼‰ã€‚</p><p>å·®åˆ†ä¸€ä¸‹ï¼Œå¯ä»¥è½¬åŒ–ä¸ºåŒå…³é”®ç‚¹é—®é¢˜ï¼Œä½¿ç”¨è«é˜Ÿæ±‚è§£ã€‚</p><p>ä½†è¿™æ ·æœ€å¤šæ¯æ¬¡æœ‰ 16 ä¸ªæŸ¥è¯¢</p><p>å‘ç°å½¢å¦‚ $[1,x] \cup [y,n]$ çš„è¯¢é—®å¯ä»¥æ‹†ä¸º $[1,n]-[x+1,y-1]$ï¼Œæœ‰å…³ $[1,n]$ çš„å¯ä»¥é¢„å¤„ç†ä¸€ä¸‹</p><p>å…·ä½“åœ°ï¼Œä»¥ $[1,x] \cup [y,n] \times [1,xâ€™] \cup [yâ€™,n]$ ä¸ºä¾‹</p><p>å¯¹æŸä¸€é¢œè‰²ï¼Œå®ƒçš„è´¡çŒ®å³ä¸º</p><script type="math/tex; mode=display">(cnt_{[1,n]}-cnt_{[x+1,y-1]})*(cnt_{[1,n]}-cnt_{[x'+1,y'-1]}) \\=cnt_{[1,n]} \times cnt_{[1,n]}-cnt_{[1,n]} \times (cnt_{[x+1,y-1]}+cnt_{[x'+1,y'-1]})+cnt_{[x+1,y-1]} \times cnt_{x'+1,y'-1}</script><p>å·¦ä¸€é¢„å¤„ç†ä¸€ä¸‹ã€‚å·¦äºŒæ˜¯ä¸€ç»´é—®é¢˜ï¼Œæ’åºæ±‚è§£ã€‚å³ä¸€ç”¨è«é˜Ÿè§£ã€‚</p><p>è¿™æ ·æ¯ä¸ªè¯¢é—®åªéœ€æ‹†æˆ 4 ä¸ªæŸ¥è¯¢ï¼Œå¯è¿‡ã€‚</p><h2 id="è«é˜ŸäºŒæ¬¡ç¦»çº¿"><a href="#è«é˜ŸäºŒæ¬¡ç¦»çº¿" class="headerlink" title="è«é˜ŸäºŒæ¬¡ç¦»çº¿"></a>è«é˜ŸäºŒæ¬¡ç¦»çº¿</h2><p>ã€‚ã€‚ã€‚</p><h2 id="æ‚é¢˜"><a href="#æ‚é¢˜" class="headerlink" title="æ‚é¢˜"></a>æ‚é¢˜</h2><h4 id="1-permu"><a href="#1-permu" class="headerlink" title="1.permu"></a><a href="https://hydro.ac/d/bzoj/p/4358">1.permu</a></h4><p>ä¸€ä¸ªæ’åˆ—ï¼Œä¸€å †è¯¢é—®ï¼Œæ±‚åŒºé—´æœ€é•¿å€¼åŸŸè¿ç»­æ®µï¼Œå¯ç¦»çº¿</p><p>å¯¹äºåŒºé—´è¯¢é—®ï¼Œè€ƒè™‘è«é˜Ÿã€‚å°†å­˜åœ¨çš„æ•°çœ‹ä½œ $1$ï¼ŒæŸ¥è¯¢å³ä¸ºæœ€é•¿çš„è¿ç»­ $1$ã€‚</p><p>æ¯æ¬¡éœ€è¦å°† $0$ å˜ $1$ å’Œå°† $1$ å˜ $0$ï¼Œæˆ–åªéœ€è¦å…¶ä¸­ä¸€ä¸ªå¹¶æ”¯æŒæ’¤é”€ã€‚</p><p>æ˜æ˜¾è¦ç”¨å¹¶æŸ¥é›†ï¼Œå˜ $0$ ä¸º $1$ æ˜¯å¥½åšçš„ï¼Œæ’¤é”€ç”¨å¯æ’¤é”€å¹¶æŸ¥é›†å³å¯ã€‚</p><p>æŒ‰æ·±åº¦åˆå¹¶ï¼Œç­”æ¡ˆä¸ºæœ€å¤§ $siz$ï¼Œæ¯æ¬¡åˆå¹¶æ—¶è®°å½•ä¸€ä¸‹å³å¯ã€‚</p><p>åˆå§‹æ—¶æ¯ä¸ªç‚¹éƒ½ä¸º $0$ï¼Œå¯ä»¥è®°ä¸€ä¸ª $vis$ è®°å½•æ¯ä¸ªèŠ‚ç‚¹æ˜¯å¦ä¸º $1$ï¼Œå½“åˆå¹¶æ—¶ç‰¹åˆ¤ä¸€ä¸‹ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n\sqrt n\log n)$ã€‚</p><p>ä¹Ÿå¯ä»¥è§‚å¯Ÿæœ€é•¿è¿ç»­ $1$ æ€§è´¨ã€‚å½“åŠ å…¥ $x$ æ—¶ï¼Œæ›´æ–° $x$ ç‚¹ä¸å½“å‰æ®µå·¦å³ç«¯ç‚¹ï¼Œå› ä¸ºä¸­é—´ä¸ä¼šå†åŠ æ•°ï¼Œä¸æ¯” $x$ ç‚¹æ›´ä¼˜ã€‚</p><p><a href="https://www.luogu.com.cn/paste/ubj5vw0y">code</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/WAMonster/p/10118934.html">è«é˜Ÿç®—æ³•â€”â€”ä»å…¥é—¨åˆ°é»‘é¢˜</a></p><p><a href="https://www.luogu.com.cn/article/psut3omr">è«é˜ŸäºŒæ¬¡ç¦»çº¿</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ğŸ˜¨â¤ï¸âŒ CF1558E Down Below</title>
      <link href="/solutions/CF1558E/"/>
      <url>/solutions/CF1558E/</url>
      
        <content type="html"><![CDATA[<p>äºŒåˆ†ç­”æ¡ˆè½¬åŒ–ä¸ºåˆ¤å®šæ€§é—®é¢˜ã€‚</p><p>è‹¥æ²¡æœ‰ä¸èƒ½å›å¤´èµ°çš„é™åˆ¶ï¼Œé‚£ä¹ˆå¯ä»¥ç»´æŠ¤æ‰€æœ‰å·²ç»ç»è¿‡çš„ç‚¹ï¼Œé€‰æ‹© $a$ æœ€å°çš„é‚»ç‚¹æ‰©å±•ã€‚</p><p>åŠ ä¸Šé™åˆ¶åæˆ‘ä»¬ä»ç»´æŠ¤å·²ç»éå†åˆ°çš„èŠ‚ç‚¹ï¼Œè®°èŠ‚ç‚¹é›†åˆä¸º $S$ï¼Œæ­¤æ—¶åŠ›é‡å€¼ä¸º $åˆå€¼+\sum_{i \in S} b_i$ï¼Œè€ƒè™‘æ€æ ·è¿›è¡Œæ‰©å±•ã€‚</p><ul><li><p>å­˜åœ¨åˆæ³•è·¯å¾„ $x \to p_1 \to p_2 \to â€¦ \to p_k \to y$ æ»¡è¶³ $x,y \in S,p_i \notin S$ã€‚</p></li><li><p>å­˜åœ¨åˆæ³•è·¯å¾„ $x \to p_1 \to p_2 \to â€¦ \to p_1 \to x$ æ»¡è¶³ $x \in S,p_i \notin S$ï¼Œå³ä¸€æ®µé‡å¤è·¯å¾„å’Œç¯ã€‚</p></li></ul><p>å¯¹äºç¬¬ä¸€ç§è·¯å¾„ï¼Œdfs æŸ¥æ‰¾å³å¯ã€‚å¯¹äºç¬¬äºŒç§è·¯å¾„ï¼Œå‘ç°å…¶å¯ä»¥è¢«æ‹†ä¸ºä¸¤æ¡åŒèµ·ç‚¹çš„åˆæ³•è·¯å¾„ $x \to p_1 \to â€¦ $,$x \to pâ€™_1 \to pâ€™_2 \to â€¦$ï¼Œä¸”åŒèµ·ç‚¹çš„ä¸¤æ¡åˆæ³•è·¯å¾„ä¸€å®šå¯ä»¥åˆæˆç¬¬äºŒç§è·¯å¾„ã€‚æ¯æ¬¡æ‰©å±•ä¸€æ¡å³å¯ï¼Œå¦ä¸€æ¡ä¼šåœ¨ä¹‹åè¢«æ‰©å±•ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(nm\log V)$ã€‚</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> U(x) ((int)x.size()) </span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e3</span><span class="number">+100</span>,INF=<span class="number">1e18</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,a[N],b[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; G[N],vc;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> pre[N],vis[N],cur;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fu,<span class="type">int</span> w)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(cur) <span class="keyword">return</span>; <span class="keyword">if</span>(pre[u]) <span class="keyword">return</span> cur=u,<span class="built_in">void</span>(); pre[u]=fu;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> v:G[u]){</span><br><span class="line"><span class="keyword">if</span>(a[v]&gt;=w||v==fu) <span class="keyword">continue</span>;</span><br><span class="line"><span class="keyword">if</span>(vis[v]) <span class="keyword">return</span> cur=u,<span class="built_in">void</span>();</span><br><span class="line"><span class="built_in">dfs</span>(v,u,w+b[v]);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">chk</span><span class="params">(<span class="type">int</span> mid)</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) pre[i]=vis[i]=<span class="number">0</span>;</span><br><span class="line">vis[<span class="number">1</span>]=<span class="number">1</span>,vc={<span class="number">1</span>};</span><br><span class="line"><span class="keyword">while</span>(<span class="built_in">U</span>(vc)&lt;n){</span><br><span class="line">cur=<span class="number">0</span>; <span class="keyword">for</span>(<span class="type">int</span> u:vc) <span class="keyword">for</span>(<span class="type">int</span> v:G[u]) <span class="keyword">if</span>(a[v]&lt;mid&amp;&amp;!vis[v]) <span class="built_in">dfs</span>(v,u,mid+b[v]);</span><br><span class="line"><span class="keyword">if</span>(!cur) <span class="keyword">break</span>; <span class="keyword">for</span>(;!vis[cur];cur=pre[cur]) vc.<span class="built_in">pb</span>(cur),mid+=b[cur],vis[cur]=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) pre[i]=<span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">U</span>(vc)==n;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">solve</span><span class="params">()</span></span>{</span><br><span class="line">n=rd,m=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) a[i]=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;++i) b[i]=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,x,y;i&lt;=m;++i) G[x=rd].<span class="built_in">pb</span>(y=rd),G[y].<span class="built_in">pb</span>(x);</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> l=<span class="number">0</span>,r=INF;</span><br><span class="line"><span class="keyword">while</span>(l&lt;r){</span><br><span class="line"><span class="type">int</span> mid=l+r&gt;&gt;<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">chk</span>(mid)) r=mid;</span><br><span class="line"><span class="keyword">else</span> l=mid<span class="number">+1</span>;</span><br><span class="line">}</span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%lld\n"</span>, l);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) G[i]={};</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> T=rd;</span><br><span class="line"><span class="keyword">while</span>(T--) <span class="built_in">solve</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>]]></content>
      
      
      <categories>
          
          <category> solutions </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>å·¦åæ ‘</title>
      <link href="/notes/%E5%B7%A6%E5%81%8F%E6%A0%91/"/>
      <url>/notes/%E5%B7%A6%E5%81%8F%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>äºŒå‰å †é¢å¤–ç»´æŠ¤ä¸€ä¸ª $dis$ï¼Œè¡¨ç¤ºåˆ°ç©ºèŠ‚ç‚¹çš„æœ€çŸ­é•¿åº¦ï¼Œä¿è¯ $dis_{lc} &gt; dis_{rc}$ å³å¯ä¿è¯æ ¹èŠ‚ç‚¹çš„ $dis$ ä¸º $O(\log n)$ã€‚</p><p>åˆå¹¶æ—¶è·³å³å„¿å­å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(\log n)$ã€‚</p><p><a href="https://www.luogu.com.cn/problem/P3377">1.ã€æ¨¡æ¿ã€‘å·¦åæ ‘/å¯å¹¶å †</a></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">1e5</span><span class="number">+100</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,a[N];</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lc(x) (t[x].ls)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rc(x) (t[x].rs)</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TREE</span>{ <span class="type">int</span> ls,rs,dis,fa,v; }t[N];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">find</span><span class="params">(<span class="type">int</span> x)</span></span>{ <span class="keyword">return</span> t[x].fa==x?x:t[x].fa=<span class="built_in">find</span>(t[x].fa); }</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">mer</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x^y;</span><br><span class="line"><span class="keyword">if</span>(t[x].v&gt;t[y].v||(t[x].v==t[y].v&amp;&amp;x&gt;y)) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="built_in">rc</span>(x)=<span class="built_in">mer</span>(<span class="built_in">rc</span>(x),y);</span><br><span class="line"><span class="keyword">if</span>(t[<span class="built_in">lc</span>(x)].dis&lt;t[<span class="built_in">rc</span>(x)].dis) <span class="built_in">swap</span>(<span class="built_in">lc</span>(x),<span class="built_in">rc</span>(x));</span><br><span class="line">t[x].dis=t[<span class="built_in">rc</span>(x)].dis<span class="number">+1</span>,t[<span class="built_in">lc</span>(x)].fa=t[<span class="built_in">rc</span>(x)].fa=x;</span><br><span class="line"><span class="keyword">return</span> x;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> x)</span></span>{ t[x].v=<span class="number">-1</span>,t[<span class="built_in">lc</span>(x)].fa=<span class="built_in">lc</span>(x),t[<span class="built_in">rc</span>(x)].fa=<span class="built_in">rc</span>(x),t[x].fa=<span class="built_in">mer</span>(<span class="built_in">lc</span>(x),<span class="built_in">rc</span>(x)); }</span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> lc(x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">undef</span> rc(x)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) t[i]={<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,i,rd};</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,op,x,y;i&lt;=m;++i){</span><br><span class="line">op=rd,x=rd; <span class="keyword">if</span>(op==<span class="number">1</span>) y=rd;</span><br><span class="line"><span class="keyword">if</span>(op==<span class="number">1</span>){</span><br><span class="line"><span class="keyword">if</span>(t[x].v==<span class="number">-1</span>||t[y].v==<span class="number">-1</span>) <span class="keyword">continue</span>;</span><br><span class="line">x=<span class="built_in">find</span>(x),y=<span class="built_in">find</span>(y);</span><br><span class="line"><span class="keyword">if</span>(x!=y) t[x].fa=t[y].fa=<span class="built_in">mer</span>(x,y);</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span>{</span><br><span class="line"><span class="keyword">if</span>(t[x].v==<span class="number">-1</span>) <span class="built_in">printf</span>(<span class="string">"-1\n"</span>);</span><br><span class="line"><span class="keyword">else</span> x=<span class="built_in">find</span>(x),<span class="built_in">printf</span>(<span class="string">"%d\n"</span>, t[x].v),<span class="built_in">del</span>(x);</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure><h2 id="ã€æ¨¡æ¿ã€‘k-çŸ­è·¯-SDOI2010-é­”æ³•çŒªå­¦é™¢"><a href="#ã€æ¨¡æ¿ã€‘k-çŸ­è·¯-SDOI2010-é­”æ³•çŒªå­¦é™¢" class="headerlink" title="ã€æ¨¡æ¿ã€‘k çŸ­è·¯ / [SDOI2010] é­”æ³•çŒªå­¦é™¢"></a><a href="https://www.luogu.com.cn/problem/P2483">ã€æ¨¡æ¿ã€‘k çŸ­è·¯ / [SDOI2010] é­”æ³•çŒªå­¦é™¢</a></h2><p>æœ€ä¼˜ç­–ç•¥æ˜¯ï¼Œæ¯æ¬¡æ‰¾åˆ°ä¸€æ¡æœªè€ƒè™‘çš„æœ€çŸ­è·¯å¾„ã€‚</p><p>ä»¥ $n$ ä¸ºæ ¹å»ºå‡ºåå›¾çš„æœ€çŸ­è·¯æ ‘ã€‚</p><p>å¯¹äºä¸åœ¨æ ‘ä¸Šçš„è¾¹ $e: (u \to v,w)$ï¼Œè®° $\delta(e) = dis_v+w-dis_u$ã€‚</p><p>å¯¹äºä¸€æ¡ $1 \to n$ è·¯å¾„ï¼Œè®° $S$ ä¸ºè·¯å¾„ä¸Šä¸åœ¨æœ€çŸ­æ ‘ä¸Šçš„è¾¹çš„é›†åˆï¼Œé‚£ä¹ˆè·¯å¾„é•¿åº¦ä¸º $dis_1 + \sum_{e \in S} \delta(e)$ã€‚</p><p>$dis_1$ æ˜¯å®šå€¼ï¼Œåªéœ€æ±‚å‡ºåé¢çš„æœªå‡ºç°çš„æœ€å°å€¼å³å¯ã€‚</p><p>å°†è¾¹çš„é¡ºåºé’¦å®šå¥½ï¼Œæ­¤æ—¶è¾¹çš„é›†åˆå”¯ä¸€å¯¹åº”ä¸€æ¡ $1 \to n$ çš„è·¯å¾„ã€‚</p><p>è€ƒè™‘åŠ¨æ€åŠ è¾¹ï¼Œé‚£ä¹ˆæ¯æ¬¡ä¼šå°†æœ€åä¸€æ¡è¾¹æ¢æ‰ï¼Œæˆ–è€…åŠ ä¸€æ¡æ–°è¾¹ã€‚</p><p>è€ƒè™‘å¯¹æ¯ä¸ªç‚¹ç»´æŠ¤ä¸€ä¸ªè¾¹é›†ï¼Œå­˜ä»¥å…¶åˆ° $n$ é“¾ä¸Šä¸ºèµ·ç‚¹çš„éæ ‘è¾¹ã€‚</p><p>ç”¨å †ç»´æŠ¤ï¼Œæ¯æ¬¡ç›¸å½“äºå‘ä¸‹ç§»åŠ¨ä¸€æ­¥ã€‚</p><p>åˆå§‹åŒ–æ—¶éœ€è¦ç»§æ‰¿ä¹‹å‰çš„ä¿¡æ¯ï¼Œç”¨å¯æŒä¹…åŒ–å †ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n\log n+m\log m+V\log V)$</p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> db=<span class="type">double</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pid pair<span class="string">&lt;int,db&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> fi first</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> se second</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> pb push_back</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> U(x) ((int)x.size())</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">5e4</span><span class="number">+100</span>,M=<span class="number">2e5</span><span class="number">+100</span>;</span><br><span class="line"><span class="type">const</span> db INF=<span class="number">1e15</span>,eps=<span class="number">1e-8</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">sgn</span><span class="params">(db x)</span></span>{ <span class="keyword">return</span> (x&gt;eps)-(x&lt;-eps); }</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">chkmin</span><span class="params">(db &amp;x,db y)</span></span>{ <span class="keyword">return</span> <span class="built_in">sgn</span>(y-x)&lt;<span class="number">0</span>?x=y,<span class="number">1</span>:<span class="number">0</span>; }</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,fa[N],pre[M]; db E;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ADJ</span>{ <span class="type">int</span> v; db w; <span class="type">int</span> i; };</span><br><span class="line">vector&lt;ADJ&gt; G[N],R[N];</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">cmp</span>{ <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> pid &amp;x,<span class="type">const</span> pid &amp;y)</span></span>{ <span class="keyword">return</span> <span class="built_in">sgn</span>(x.se-y.se)&gt;<span class="number">0</span>; } };</span><br><span class="line">priority_queue&lt;pid,vector&lt;pid&gt;,cmp&gt; q; <span class="type">int</span> vis[N]; db dis[N];</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dij</span><span class="params">()</span></span>{</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) vis[i]=<span class="number">0</span>,dis[i]=INF; q.<span class="built_in">push</span>({n,dis[n]=<span class="number">0</span>});</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">        <span class="type">int</span> u=q.<span class="built_in">top</span>().fi; q.<span class="built_in">pop</span>(); <span class="keyword">if</span>(vis[u]) <span class="keyword">continue</span>; vis[u]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> [v,w,i]:R[u]) <span class="keyword">if</span>(<span class="built_in">chkmin</span>(dis[v],dis[u]+w)) fa[v]=u,pre[v]=i,q.<span class="built_in">push</span>({v,dis[v]});</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> HEAP{</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lc(x) (t[(x)].ls)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rc(x) (t[(x)].rs)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> v(x) (t[(x)].v)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> dis(x) (t[(x)].dis)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> to(x) (t[(x)].to)</span></span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TREE</span>{ <span class="type">int</span> ls,rs,dis,to; db v; }t[N&lt;&lt;<span class="number">5</span>]; <span class="type">int</span> tot=<span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">make</span><span class="params">(<span class="type">int</span> to,db v)</span></span>{ <span class="keyword">return</span> t[++tot]={<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,to,v},tot; }</span><br><span class="line">    <span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">clone</span><span class="params">(<span class="type">int</span> x)</span></span>{ <span class="keyword">return</span> t[++tot]=t[x],tot; }</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">mer</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line"><span class="keyword">if</span>(!x||!y) <span class="keyword">return</span> x^y;</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">v</span>(x)&gt;<span class="built_in">v</span>(y)) <span class="built_in">swap</span>(x,y);</span><br><span class="line"><span class="type">int</span> z=<span class="built_in">clone</span>(x); <span class="built_in">rc</span>(z)=<span class="built_in">mer</span>(<span class="built_in">rc</span>(z),y);</span><br><span class="line"><span class="keyword">if</span>(t[<span class="built_in">lc</span>(z)].dis&lt;(t[<span class="built_in">rc</span>(z)].dis)) <span class="built_in">swap</span>(<span class="built_in">lc</span>(z),<span class="built_in">rc</span>(z));</span><br><span class="line"><span class="built_in">dis</span>(z)=(t[<span class="built_in">rc</span>(z)].dis)<span class="number">+1</span>; <span class="keyword">return</span> z;</span><br><span class="line">    }</span><br><span class="line">};</span><br><span class="line"><span class="type">int</span> rt[N];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span>{</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> HEAP;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i) q.<span class="built_in">push</span>({i,dis[i]});</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">        <span class="type">int</span> u=q.<span class="built_in">top</span>().fi; q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> [v,w,i]:G[u]) <span class="keyword">if</span>(pre[u]!=i) rt[u]=<span class="built_in">mer</span>(rt[u],<span class="built_in">make</span>(v,dis[v]-dis[u]+w));</span><br><span class="line">        rt[u]=<span class="built_in">mer</span>(rt[u],rt[fa[u]]);</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">()</span></span>{</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> HEAP;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(dis[<span class="number">1</span>]-E)&gt;<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    E-=dis[<span class="number">1</span>]; <span class="type">int</span> res=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">if</span>(!rt[<span class="number">1</span>]) <span class="keyword">return</span> res;</span><br><span class="line">    q.<span class="built_in">push</span>({rt[<span class="number">1</span>],<span class="built_in">v</span>(rt[<span class="number">1</span>])});</span><br><span class="line">    <span class="keyword">while</span>(!q.<span class="built_in">empty</span>()){</span><br><span class="line">    <span class="keyword">auto</span> [u,d]=q.<span class="built_in">top</span>(); q.<span class="built_in">pop</span>();</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">sgn</span>(dis[<span class="number">1</span>]+d-E)&gt;<span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">    E-=dis[<span class="number">1</span>]+d,++res;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">lc</span>(u)) q.<span class="built_in">push</span>({<span class="built_in">lc</span>(u),d-<span class="built_in">v</span>(u)+<span class="built_in">v</span>(<span class="built_in">lc</span>(u))});</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">rc</span>(u)) q.<span class="built_in">push</span>({<span class="built_in">rc</span>(u),d-<span class="built_in">v</span>(u)+<span class="built_in">v</span>(<span class="built_in">rc</span>(u))});</span><br><span class="line">    <span class="keyword">if</span>(rt[<span class="built_in">to</span>(u)]) q.<span class="built_in">push</span>({rt[<span class="built_in">to</span>(u)],d+<span class="built_in">v</span>(rt[<span class="built_in">to</span>(u)])});</span><br><span class="line">}</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd,<span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;E);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>,u,v;i&lt;=m;++i){</span><br><span class="line">        u=rd,v=rd; db w; <span class="built_in">scanf</span>(<span class="string">"%lf"</span>, &amp;w);</span><br><span class="line">        <span class="keyword">if</span>(u==n) <span class="keyword">continue</span>;</span><br><span class="line">        G[u].<span class="built_in">pb</span>({v,w,i}),R[v].<span class="built_in">pb</span>({u,w,i});</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> u=<span class="number">1</span>;u&lt;=n;++u) <span class="built_in">reverse</span>(G[u].<span class="built_in">begin</span>(),G[u].<span class="built_in">end</span>()),<span class="built_in">reverse</span>(R[u].<span class="built_in">begin</span>(),R[u].<span class="built_in">end</span>());</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">dij</span>(),<span class="built_in">init</span>();</span><br><span class="line">    </span><br><span class="line"><span class="built_in">printf</span>(<span class="string">"%d\n"</span>, <span class="built_in">calc</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/uoeyv3gq">å¯åˆå¹¶å †</a></p><p><a href="https://www.cnblogs.com/-Wallace-/p/kth-path.html">k çŸ­è·¯</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ ¹å·åˆ†æ²»</title>
      <link href="/notes/%E6%A0%B9%E5%8F%B7%E5%88%86%E6%B2%BB/"/>
      <url>/notes/%E6%A0%B9%E5%8F%B7%E5%88%86%E6%B2%BB/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-Remainder-Problem"><a href="#1-Remainder-Problem" class="headerlink" title="1.Remainder Problem"></a><a href="https://www.luogu.com.cn/problem/CF1207F">1.Remainder Problem</a></h4><p>ä¸¤ç§æš´åŠ›</p><ul><li><p>æŒ‰é¢˜æ„æ¨¡æ‹Ÿï¼Œä¿®æ”¹æ—¶é—´å¤æ‚åº¦ $O(1)$ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ $O(n)$ã€‚</p></li><li><p>ç»´æŠ¤ä¸€ä¸ª $b$ æ•°ç»„ï¼Œ$b_{ij}$ è¡¨ç¤ºæ‰€æœ‰æ¨¡ $i$ å¾— $j$ çš„ä¸‹æ ‡çš„æ•°ä¹‹å’Œï¼Œä¿®æ”¹æ—¶é—´å¤æ‚åº¦ $O(n)$ï¼ŒæŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ $O(1)$ã€‚</p></li></ul><p>ä¸¤ç§æš´åŠ›æ—¶é—´å¤æ‚åº¦æä¸å¹³è¡¡ã€‚è€ƒè™‘è®¾è®¡ä¸€ä¸ªé˜ˆå€¼ $B$ï¼Œå°†è¯¢é—®åˆ†æˆä¸¤å—ï¼Œåˆ†åˆ«å¤„ç†ã€‚å¯¹äº $\le B$ çš„ï¼Œç”¨æ³•äºŒã€‚å¯¹äºå¤§äº $B$ çš„ï¼Œç”¨æ³•ä¸€ã€‚</p><p>å– $B=\sqrt n$ï¼Œæ—¶é—´å¤æ‚åº¦ $O(q\sqrt n)$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/4ufgboau">code</a></p><p>ç”±äºæ•°æ®é—®é¢˜ï¼Œå—é•¿å–ç†è®ºæœ€ä¼˜å—é•¿ä¸ä¸€å®šæœ€ä¼˜ã€‚</p><h4 id="2-Two-Arithmetic-Progressions"><a href="#2-Two-Arithmetic-Progressions" class="headerlink" title="2.Two Arithmetic Progressions"></a><a href="https://www.luogu.com.cn/problem/CF710D">2.Two Arithmetic Progressions</a></h4><p>ä¸å¦¨è®¾ $a_1&gt;=a_2$ã€‚æœ‰ä¸¤ç§æš´åŠ›</p><ul><li><p>æšä¸¾ã€‚æ—¶é—´å¤æ‚åº¦ $O(\frac{n}{a_1})$ã€‚</p></li><li><p>å¾ªç¯èŠ‚å¤§å°ä¸º $lcm(a_1,a_2)$ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªé‡å¤çš„ä½ç½® $x$ï¼Œç­”æ¡ˆå³ä¸º $\left\lfloor \frac{R-x}{lcm(a_1,a_2)}\right\rfloor +1$ã€‚æ—¶é—´å¤æ‚åº¦ $O(\frac{lcm(a_1,a_2)}{a_1})$ã€‚</p></li></ul><p>å°†ä¸¤ä¸ªæš´åŠ›æ‹¼ä¸€èµ·ï¼Œè®° $B=\sqrt{2 \times 10^9} \approx 44722$ã€‚å°äºæˆ–ç­‰äº $\le B$ çš„ç”¨æ³•äºŒï¼Œå¦åˆ™ç”¨æ³•ä¸€ã€‚</p><p><a href="https://www.luogu.com.cn/paste/ekx6s5k3">code</a></p><h4 id="3-IOI2009-Regions"><a href="#3-IOI2009-Regions" class="headerlink" title="3.[IOI2009] Regions"></a><a href="https://www.luogu.com.cn/problem/P5901">3.[IOI2009] Regions</a></h4><p>ç‚¹æŸ“è‰²å¾ˆæ˜¾ç„¶å¯ä»¥æ ¹å·åˆ†æ²»ï¼Œç„¶åå°± $O(n\sqrt{n})$ äº†ã€‚</p><p>å¯¹äºéƒ½ä¸ºå°é¢œè‰²çš„ï¼Œæˆ‘ä½¿ç”¨äº†è™šæ ‘æ±‚è§£ã€‚éœ€è¦å¤§åŠ›å¡å¸¸ï¼ŒåŒ…æ‹¬ä½†ä¸é™äº</p><ul><li><p>ç”¨ dfs åºæ±‚ lcaã€‚</p></li><li><p>æŒ‰ dfs åºæ’åºæ—¶ç”¨å½’å¹¶æ’åºã€‚</p></li><li><p>é™åˆ¶å¤§é¢œè‰²çš„æ•°é‡ï¼Œå°†æ¯ä¸ªé¢œè‰²å¯¹åº”çš„ç‚¹çš„ä¸ªæ•°æ±‚å‡ºï¼Œå–ç¬¬ $k$ å¤§ä¸ºé˜ˆå€¼ã€‚</p></li><li><p>é‚»æ¥è¡¨æ¢ä¸ºé“¾å¼å‰å‘æ˜Ÿã€‚</p></li></ul><p><a href="https://www.luogu.com.cn/paste/d3n55f9l">code</a></p><h4 id="4-ARC052D-9"><a href="#4-ARC052D-9" class="headerlink" title="4.[ARC052D] 9"></a><a href="https://www.luogu.com.cn/problem/AT_arc052_d">4.[ARC052D] 9</a></h4><p>æ•°ä½ä¹‹å’Œæœ€å¤§ä¸º $90$ã€‚å¯¹ $K$ åˆ†è®¨</p><ul><li><p>$K \le \sqrt{M}$ï¼Œç›´æ¥æšä¸¾ã€‚</p></li><li><p>$K \le \sqrt{M}$ï¼Œæ•°ä½ DPã€‚</p></li></ul><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/5gtqzd4a">æ ¹å·åˆ†æ²»</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¯›æ¯›è™«å‰–åˆ†</title>
      <link href="/notes/%E6%AF%9B%E6%AF%9B%E8%99%AB%E5%89%96%E5%88%86/"/>
      <url>/notes/%E6%AF%9B%E6%AF%9B%E8%99%AB%E5%89%96%E5%88%86/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä¸€ç§æ ‘çš„é‡æ ‡å·æ–¹å¼ã€‚</p><p>å…ˆå¯¹æ ‘è¿›è¡Œé‡å‰–ã€‚å¯¹æ ‘è¿›è¡Œ dfsï¼Œå½“éå†åˆ° $u$ æ—¶</p><ul><li><p>è‹¥ $u$ æœªè¢«æ ‡å·ï¼Œå¯¹ $u$ è¿›è¡Œæ ‡å·ã€‚</p></li><li><p>è‹¥ $u$ ä¸ºé‡é“¾çš„çš„é“¾å¤´ï¼Œéå†è¿™æ¡é‡é“¾ï¼Œå¯¹ç›¸é‚»éé‡é“¾ä¸Šçš„èŠ‚ç‚¹ä¾æ¬¡æ ‡å·</p></li><li><p>è‹¥ $u$ æœ‰é‡å„¿å­ï¼Œéå†é‡å„¿å­ã€‚</p></li><li><p>éå†éé‡å„¿å­ã€‚</p></li></ul><p>è¿™æ ·æ ‡å·æ»¡è¶³</p><ul><li><p>ä¸€æ¡é‡é“¾é™¤é“¾å¤´å¤–æ ‡å·è¿ç»­ã€‚</p></li><li><p>ä¸€æ¡é‡é“¾çš„é‚»ç‚¹æ ‡å·è¿ç»­ã€‚</p></li><li><p>å­æ ‘æ ‡å·ä¸ºä¸¤æ®µä¸ç›¸äº¤çš„è¿ç»­åŒºé—´ã€‚</p></li></ul><p>é‚£ä¹ˆé“¾ã€å­æ ‘ã€é“¾çš„é‚»ç‚¹çš„ä¿¡æ¯éƒ½å¯ä»¥ç»´æŠ¤äº†ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-NOI2021-è½»é‡è¾¹"><a href="#1-NOI2021-è½»é‡è¾¹" class="headerlink" title="1.[NOI2021] è½»é‡è¾¹"></a><a href="https://www.luogu.com.cn/problem/P7735">1.[NOI2021] è½»é‡è¾¹</a></h4><h4 id="2-ã€ŒGLR-R3ã€è°·é›¨"><a href="#2-ã€ŒGLR-R3ã€è°·é›¨" class="headerlink" title="2.ã€ŒGLR-R3ã€è°·é›¨"></a><a href="https://www.luogu.com.cn/problem/P8479">2.ã€ŒGLR-R3ã€è°·é›¨</a></h4><p>åªéœ€è¦ç»´æŠ¤æ¯›æ¯›è™«çš„ä¿¡æ¯ï¼Œæ‰€ä»¥å¯ä»¥å¯¹æ¯›æ¯›è™«é¡ºåºæ ‡å·ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.cnblogs.com/A-Quark/p/16435243.html">æ¯›æ¯›è™«å‰–åˆ†</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>ç‚¹åˆ†æ ‘</title>
      <link href="/notes/%E7%82%B9%E5%88%86%E6%A0%91/"/>
      <url>/notes/%E7%82%B9%E5%88%86%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å°†ç‚¹åˆ†æ²»çš„è¿‡ç¨‹ç¦»çº¿ä¸‹æ¥ï¼Œå³å°†é‡å¿ƒç›¸è¿ï¼Œå¯ä»¥å½¢æˆä¸€æ£µæ ‘ï¼Œç§°ä½œç‚¹åˆ†æ ‘ã€‚å®ƒæœ‰å¾ˆå¥½çš„æ€§è´¨</p><ul><li><p>æ ‘çš„æ·±åº¦ä¸º $O(\log n)$ã€‚</p></li><li><p>æ‰€æœ‰ç‚¹å­æ ‘å¤§å°ä¸º $O(n\log n)$ã€‚</p></li><li><p>ç‚¹åˆ†æ ‘ä¸Š $lca(u,v)$ ä¸€å®šåœ¨<strong>åŸæ ‘</strong> $u \leadsto v$ ä¸Šã€‚</p></li></ul><p>å¯¹äºä»»æ„ç‚¹ $u$ï¼Œä¸€èˆ¬ä¼šç”¨æ•°æ®ç»“æ„ç»´æŠ¤ $u$ çš„å­æ ‘çš„å¯¹ $u$ ä¿¡æ¯ï¼Œ$u$ çš„å­æ ‘å¯¹ $fa_u$ çš„ä¿¡æ¯ã€‚åè€…ç”¨äºå®¹æ–¥ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-ã€æ¨¡æ¿ã€‘ç‚¹åˆ†æ ‘-éœ‡æ³¢"><a href="#1-ã€æ¨¡æ¿ã€‘ç‚¹åˆ†æ ‘-éœ‡æ³¢" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘ç‚¹åˆ†æ ‘ | éœ‡æ³¢"></a><a href="https://www.luogu.com.cn/problem/P6329">1.ã€æ¨¡æ¿ã€‘ç‚¹åˆ†æ ‘ | éœ‡æ³¢</a></h4><p>å»ºå‡ºç‚¹åˆ†æ ‘ã€‚å¯¹äºæŸ¥è¯¢ï¼Œæšä¸¾ $x$ åœ¨ç‚¹åˆ†æ ‘ä¸Šçš„ç¥–å…ˆï¼Œç»Ÿè®¡ç¥–å…ˆçš„å­æ ‘å¯¹ç­”æ¡ˆçš„è´¡çŒ®ï¼Œå°†é‡å¤çš„å®¹æ–¥æ‰ã€‚å¯¹äºä¿®æ”¹ï¼Œç”¨æ ‘çŠ¶æ•°ç»„ç»´æŠ¤ä¿¡æ¯ï¼Œå°† $x$ åœ¨ç‚¹åˆ†æ ‘ä¸Šçš„ç¥–å…ˆéƒ½æ”¹ä¸€ä¸‹å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/9s306omk">code</a></p><h4 id="2-HNOI2015-å¼€åº—"><a href="#2-HNOI2015-å¼€åº—" class="headerlink" title="2.[HNOI2015] å¼€åº—"></a><a href="https://www.luogu.com.cn/problem/P3241">2.[HNOI2015] å¼€åº—</a></h4><p>ä¸€æ£µæ ‘ï¼Œç‚¹æœ‰ç‚¹æƒï¼Œå¤šæ¬¡è¯¢é—®ï¼Œæ¯æ¬¡è¯¢é—®ç‚¹æƒ $&lt;=k$ çš„ç‚¹åˆ° $u$ çš„è·ç¦»å’Œï¼Œå¼ºåˆ¶åœ¨çº¿ã€‚</p><p>ç”±äºæ²¡æœ‰ä¿®æ”¹ï¼Œå¯¹æ¯ä¸ªç‚¹å¼€ä¸ª vector æŒ‰æƒå€¼æ’åºå¹¶é¢„å¤„ç†å‰ç¼€å’Œï¼ŒæŸ¥è¯¢æ—¶äºŒåˆ†ä¸€ä¸‹å³å¯ã€‚</p><h4 id="3-ZJOI2015-å¹»æƒ³ä¹¡æˆ˜ç•¥æ¸¸æˆ"><a href="#3-ZJOI2015-å¹»æƒ³ä¹¡æˆ˜ç•¥æ¸¸æˆ" class="headerlink" title="3.[ZJOI2015] å¹»æƒ³ä¹¡æˆ˜ç•¥æ¸¸æˆ"></a><a href="https://www.luogu.com.cn/problem/P3345">3.[ZJOI2015] å¹»æƒ³ä¹¡æˆ˜ç•¥æ¸¸æˆ</a></h4><p>åœ¨ç‚¹åˆ†æ ‘ä¸Šæ¯æ¬¡å‘é‡å¿ƒç§»åŠ¨ä¸€æ­¥ï¼Œæœ€ååˆ°è¾¾é‡å¿ƒï¼Œç§»åŠ¨æ¬¡æ•°ä¸º $O(\log n)$ã€‚</p><p>è€ƒè™‘é‡å¿ƒç¡®å®šæ—¶å¦‚ä½•å¿«é€Ÿè®¡ç®—ç­”æ¡ˆï¼Œç±»ä¼¼æ¢æ ¹ DPï¼Œæ¯æ¬¡è·³çˆ¶äº²è®¡ç®—ç­”æ¡ˆå³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h4 id="4-å°æ¸…æ–°æ•°æ®ç»“æ„é¢˜"><a href="#4-å°æ¸…æ–°æ•°æ®ç»“æ„é¢˜" class="headerlink" title="4.å°æ¸…æ–°æ•°æ®ç»“æ„é¢˜"></a><a href="https://www.luogu.com.cn/problem/P3676">4.å°æ¸…æ–°æ•°æ®ç»“æ„é¢˜</a></h4><p>è®¾æ ¹ä¸º $1$ï¼Œæ¨å¼å­å¾—åˆ°</p><script type="math/tex; mode=display">ans = \sum_{i} siz_i^2 + siz_1(dep_u-1) - 2siz_{[u,1)}siz_1</script><p>å…¶ä¸­ $siz{[u,1)}$ ä¸º $u \to 1$ ä¸åŒ…æ‹¬ $1$ çš„ $siz$ å’Œã€‚æ ‘å‰–ç®€å•ç»´æŠ¤ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><p>ä½†æ˜¯ç°åœ¨åœ¨å­¦ç‚¹åˆ†æ ‘ï¼Œè€ƒè™‘ç‚¹åˆ†æ ‘åšæ³•ã€‚è¿˜æ˜¯æ¨å¼å­ï¼Œè€ƒè™‘å°†å¹³æ–¹æ‹†å¼€ã€‚</p><script type="math/tex; mode=display">\begin{align}ans &= \sum_{i}siz_i^2 \\&= \sum_{x}\sum_{y} a_xa_yd_{lca(x,y)} \\&= \frac{1}{2}\sum_{x}\sum_{y} a_xa_y(d_x+d_y-dis(x,y)) \\&= (\sum_{x}a_xdis(x,u) + \sum_{x}a_x)(\sum_{x}a_x) + \frac{1}{2}\sum_{x}\sum_{y}a_xa_ydis(x,y)\end{align}</script><p>å¯¹äºå‰é¢çš„ï¼Œéœ€è¦å¿«é€ŸæŸ¥è¯¢ $\sum_{x}a_xdis(x,u)$ã€‚</p><p>å¯¹äºåé¢çš„ï¼Œå®ƒå’Œæ ¹æ²¡æœ‰å…³ç³»ï¼Œåˆå§‹å€¼æ˜¯å¥½æ±‚çš„ï¼Œå½“ $a_u+v$ æ—¶ï¼Œå®ƒå¢åŠ  $2v\sum_{x}a_xdis(x,u)$ã€‚</p><p>ç‚¹åˆ†æ ‘ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log n)$ã€‚</p><h4 id="5-Ynoi2011-æˆéƒ½ä¸ƒä¸­"><a href="#5-Ynoi2011-æˆéƒ½ä¸ƒä¸­" class="headerlink" title="5.[Ynoi2011] æˆéƒ½ä¸ƒä¸­"></a><a href="https://www.luogu.com.cn/problem/P5311">5.[Ynoi2011] æˆéƒ½ä¸ƒä¸­</a></h4><p>å¯¹äºè¯¢é—® $(l,r,u)$ï¼Œå¯ä»¥å°†æ¯ä¸ªç‚¹åˆ° $u$ è·¯å¾„ä¸Šçš„æœ€å¤§/å°ç¼–å·é¢„å¤„ç†å‡ºæ¥ï¼Œè®°ä¸º $(x,y)$ã€‚</p><p>é‚£ä¹ˆç‚¹ $(x,y)$ ä¸ $u$ åœ¨åŒä¸€ä¸ªè¿é€šå—å½“ä¸”ä»…å½“ $l \le x,y \le r$ã€‚æ‰«ä¸€éæ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦ $O(mn)$ã€‚</p><p>åªè¦ $u,v$ åœ¨åŒä¸€è¿é€šå—ä¸­ï¼Œé‚£ä¹ˆ $(l,r,u)$ ä¸ $(l,r,v)$ ç­”æ¡ˆç›¸åŒã€‚</p><p>å»ºå‡ºç‚¹åˆ†æ ‘ï¼Œæ±‚å‡ºç‚¹åˆ†æ ‘ä¸Šä¸ $u$ åœ¨åŒä¸€è¿é€šå—çš„æœ€æµ…ç‚¹ $v$ï¼Œæ­¤æ—¶è¯¢é—®å˜ä¸º $(l,r,v)$ï¼Œå¥½å¤„æ˜¯ç‚¹åˆ†æ ‘çš„å­æ ‘å’Œä¸º $O(n\log n)$ã€‚</p><p>å¯¹äº $v$ çš„æ±‚è§£å¯ä»¥åœ¨ç‚¹åˆ†æ ‘ä¸Šæš´åŠ›å¾€ä¸Šè·³ï¼Œç”¨å€å¢ç»´æŠ¤è·¯å¾„æœ€å¤§/å°ç¼–å·ï¼Œè¿˜å¯ä»¥é¢„å¤„ç†ç‚¹åˆ†æ ‘ä¸Šæ¯ä¸ªç‚¹åˆ°ç¥–å…ˆèŠ‚ç‚¹è·¯å¾„çš„æœ€å¤§/å°ç¼–å·ã€‚</p><p>ä¸€ä¸ªç‚¹ä¼šæŒ‚å¤šä¸ªè¯¢é—®ï¼Œç¦»çº¿æ ‘çŠ¶æ•°ç»„æ±‚è§£ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h4 id="6-Iqea"><a href="#6-Iqea" class="headerlink" title="6.Iqea"></a><a href="https://www.luogu.com.cn/problem/CF936E">6.Iqea</a></h4><p>ä¿è¯å‰©ä½™éƒ¨åˆ†ä¹Ÿè¿é€šã€‚</p><p>è€ƒè™‘å°†æé•¿è¡Œè¿é€šå—ç¼©æˆä¸€ä¸ªç‚¹ï¼Œå°†ç›¸é‚»ç‚¹è¿è¾¹ï¼Œå½¢æˆä¸€æ£µæ ‘ã€‚</p><p>æ ‘ä¸ŠåŠ¨æ€åŠ ç‚¹ï¼Œæ±‚è·ç¦»æœ€å°ç‚¹ï¼Œè€ƒè™‘ç‚¹åˆ†æ ‘ã€‚</p><p>è€ƒè™‘å¦‚ä½•é€šè¿‡ä¸­é—´ç‚¹è®¡ç®—ç­”æ¡ˆï¼Œéœ€è¦è®¡ç®—æŸç‚¹åˆ°ç‰¹å®šè¿é€šå—çš„è·ç¦»ï¼Œç”¨ bfsã€‚</p><p>æ‹†å¼å­ï¼Œéœ€è¦å¯¹è¿é€šå—æ¯ä¸ªç‚¹ç»´æŠ¤å‰åç¼€æœ€å°å€¼ã€‚</p><h4 id="7-WC2014-ç´«è†èŠ±ä¹‹æ‹"><a href="#7-WC2014-ç´«è†èŠ±ä¹‹æ‹" class="headerlink" title="7.[WC2014] ç´«è†èŠ±ä¹‹æ‹"></a><a href="https://www.luogu.com.cn/problem/P3920">7.[WC2014] ç´«è†èŠ±ä¹‹æ‹</a></h4><p>éœ€è¦æ¯åŠ å…¥ä¸€ä¸ªç‚¹æ—¶å°†ä¸å®ƒç›¸å…³çš„ç‚¹å¯¹çš„æ•°é‡æ±‚å‡ºæ¥ï¼Œå†åŠ å…¥è¯¥ç‚¹ã€‚</p><p>å¦‚æœä¸å¼ºåˆ¶åœ¨çº¿ï¼Œé‚£ä¹ˆå¯ä»¥å…ˆå»ºå‡ºç‚¹åˆ†æ ‘ã€‚éœ€è¦æ”¯æŒåŠ å…¥ï¼ŒæŸ¥è¯¢æ¯” $v$ å°çš„æ•°çš„ä¸ªæ•°ã€‚å¯ä»¥ç”¨å¹³è¡¡æ ‘ã€‚</p><p>è¿˜æœ‰ä¸€ç§æ ¹å·åˆ†æ²»çš„åšæ³•ã€‚ç»´æŠ¤ä¸¤ä¸ª â€˜vectorâ€™ Aã€Bï¼Œåœ¨ $A$ ä¸­æš´åŠ›åŠ å…¥ç‚¹ $v$ï¼Œè‹¥ $|A| &gt; S$ é‚£ä¹ˆå¯¹ A,B è¿›è¡Œå½’å¹¶æ’åºï¼Œå°† A æ¸…ç©ºã€‚æŸ¥è¯¢æ—¶åœ¨ A,B ä¸­äºŒåˆ†å³å¯ã€‚</p><p>ç”±äºå¼ºåˆ¶åœ¨çº¿ï¼Œè€ƒè™‘è®¾è®¡ä¸€ä¸ªå¹³è¡¡å› å­ $\alpha$ï¼Œè‹¥å­˜åœ¨ $siz_u &gt; \alpha siz_{fa_u}$ï¼Œé‚£ä¹ˆå°† $fa_u$ çš„å­æ ‘é‡æ„ï¼Œè¿™æ ·æ¥ç»´æŒç‚¹åˆ†æ ‘çš„é«˜åº¦ä¸º $O(\log n)$ã€‚å– $\alpha=0.9$ è¾ƒä¼˜ã€‚</p><p>å– $S=\sqrt{n}$ å¯ä»¥åšåˆ° $O(n\sqrt{n}\log n)$ã€‚</p><p>å®ç°ä¸Šä¸€å †ç»†èŠ‚ï¼Œå…·ä½“çœ‹ä»£ç ã€‚</p><p><a href="https://www.luogu.com.cn/paste/84yw15yw">code</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/bscuomom">ç‚¹åˆ†æ ‘</a></p><p><a href="https://www.luogu.com.cn/training/78277">ffffyc çš„ç‚¹åˆ†æ ‘å­¦ä¹ é¢˜å•</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>åˆ†å—</title>
      <link href="/notes/block/"/>
      <url>/notes/block/</url>
      
        <content type="html"><![CDATA[<h2 id="åˆ†å—å†™æ³•"><a href="#åˆ†å—å†™æ³•" class="headerlink" title="åˆ†å—å†™æ³•"></a>åˆ†å—å†™æ³•</h2><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> st(i) ((i-1)*len+1)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ed(i) min(i*len,n)</span></span><br><span class="line">len=...; <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++) bk[i]=(i<span class="number">-1</span>)/len<span class="number">+1</span>;</span><br></pre></td></tr></tbody></table></figure><p>å—çš„ç¼–å·ï¼š$1$ åˆ° $bk[n]$ã€‚</p><h2 id="åºåˆ—åˆ†å—"><a href="#åºåˆ—åˆ†å—" class="headerlink" title="åºåˆ—åˆ†å—"></a>åºåˆ—åˆ†å—</h2><h3 id="1-æ•°åˆ—åˆ†å—å…¥é—¨1-9"><a href="#1-æ•°åˆ—åˆ†å—å…¥é—¨1-9" class="headerlink" title="1.æ•°åˆ—åˆ†å—å…¥é—¨1-9"></a><a href="https://loj.ac/p?keyword=%E5%88%86%E5%9D%97">1.æ•°åˆ—åˆ†å—å…¥é—¨1-9</a></h3><h4 id="4"><a href="#4" class="headerlink" title="4"></a>4</h4><p>åŒºé—´åŠ æ³•ï¼ŒåŒºé—´æ±‚å’Œã€‚</p><p>æ‡’æ ‡è®°ã€‚<br>æ—¶é—´å¤æ‚åº¦ $O(m\sqrt{n})$ã€‚</p><p>å¯ä»¥æ ‘çŠ¶æ•°ç»„/çº¿æ®µæ ‘ã€‚</p><h4 id="2"><a href="#2" class="headerlink" title="2"></a>2</h4><p>åŒºé—´åŠ æ³•ï¼Œè¯¢é—®åŒºé—´ $\le x$ çš„å…ƒç´ ä¸ªæ•°ã€‚</p><p>å—å†…æ’åºï¼ŒæŸ¥è¯¢æ—¶äºŒåˆ†ã€‚<br>æ—¶é—´å¤æ‚åº¦ $O(m\sqrt{n}\log n)$ã€‚<br>å½’å¹¶æ’åº+æ¡å—é•¿å¯ä»¥åšåˆ° $O(m\sqrt{n\log n})$ã€‚</p><h4 id="6"><a href="#6" class="headerlink" title="6"></a>6</h4><p>å•ç‚¹æ’å…¥ï¼Œå•ç‚¹è¯¢é—®ã€‚</p><p>å®šæœŸé‡æ„ã€‚</p><p>å¯ä»¥å¹³è¡¡æ ‘ã€‚</p><h4 id="9"><a href="#9" class="headerlink" title="9"></a>9</h4><p>åŒºé—´ä¼—æ•°ã€‚</p><p>ä¸€æ®µåŒºé—´çš„ä¼—æ•°å¯èƒ½æ˜¯ä¸­é—´å—å†…çš„ä¼—æ•°æˆ–ä¸¤è¾¹æ•£å—çš„ä¼—æ•°ã€‚</p><p>å¯ä»¥å›æ»šè«é˜Ÿã€‚</p><p><a href="/notes/æ•°åˆ—åˆ†å—å…¥é—¨">code</a></p><h4 id="2-HNOI2010-å¼¹é£ç»µç¾Š"><a href="#2-HNOI2010-å¼¹é£ç»µç¾Š" class="headerlink" title="2.[HNOI2010] å¼¹é£ç»µç¾Š"></a><a href="https://www.luogu.com.cn/problem/P3203">2.[HNOI2010] å¼¹é£ç»µç¾Š</a></h4><p>æ¯ä¸ªå—é¢„å¤„ç†æ¯ä¸ªå…ƒç´ èµ°å‡ºæœ¬å—éœ€è¦çš„æ­¥æ•°å’Œåˆ°è¾¾çš„ç‚¹ã€‚</p><h4 id="3-ç®€å•çš„æ•°åˆ—é¢˜"><a href="#3-ç®€å•çš„æ•°åˆ—é¢˜" class="headerlink" title="3.ç®€å•çš„æ•°åˆ—é¢˜"></a><a href="https://loj.ac/p/6546">3.ç®€å•çš„æ•°åˆ—é¢˜</a></h4><p>å—å†…ç»´æŠ¤ä¸‹å‡¸å£³ã€‚</p><h4 id="4-ä½œè¯—"><a href="#4-ä½œè¯—" class="headerlink" title="4.ä½œè¯—"></a><a href="https://www.luogu.com.cn/problem/P4135">4.ä½œè¯—</a></h4><p>ç»´æŠ¤å‰ç¼€å’Œï¼Œæ•£å—æš´åŠ›åˆ¤æ–­ã€‚æ—¶é—´å¤æ‚åº¦ $O(m\sqrt{n})$ã€‚</p><h4 id="5-Ynoi2019-æ¨¡æ‹Ÿèµ›-Yuno-loves-sqrt-technology-III"><a href="#5-Ynoi2019-æ¨¡æ‹Ÿèµ›-Yuno-loves-sqrt-technology-III" class="headerlink" title="5.[Ynoi2019 æ¨¡æ‹Ÿèµ›] Yuno loves sqrt technology III"></a><a href="https://www.luogu.com.cn/problem/P5048">5.[Ynoi2019 æ¨¡æ‹Ÿèµ›] Yuno loves sqrt technology III</a></h4><p>éœ€è¦åˆ¤æ–­ä¸€ä¸ªæ•°åœ¨åŒºé—´ä¸­å‡ºç°æ¬¡æ•°æ˜¯å¦ $&gt; k$ï¼Œè®°å½•æ‰€æœ‰åŒç±»æ•°çš„ä½ç½®ï¼Œåˆ¤æ–­å³å¯ã€‚</p><h4 id="6-Ynoi2019-æ¨¡æ‹Ÿèµ›-Yuno-loves-sqrt-technology-I"><a href="#6-Ynoi2019-æ¨¡æ‹Ÿèµ›-Yuno-loves-sqrt-technology-I" class="headerlink" title="6.[Ynoi2019 æ¨¡æ‹Ÿèµ›] Yuno loves sqrt technology I"></a><a href="https://www.luogu.com.cn/problem/P5046">6.[Ynoi2019 æ¨¡æ‹Ÿèµ›] Yuno loves sqrt technology I</a></h4><p>å½’å¹¶ã€‚</p><h4 id="7-Chef-and-Churu"><a href="#7-Chef-and-Churu" class="headerlink" title="7.Chef and Churu"></a>7.Chef and Churu</h4><p>ç»™ä½ ä¸€ä¸ªé•¿ä¸º $n$ çš„åºåˆ—å’Œ $m$ ä¸ªåŒºé—´ï¼Œæ”¯æŒåºåˆ—å•ç‚¹ä¿®æ”¹ï¼ŒæŸ¥è¯¢èŒƒå›´åŒºé—´å’Œã€‚</p><p>å°†åŒºé—´åˆ†å—ï¼Œç»Ÿè®¡åºåˆ—æ¯ä¸ªå…ƒç´ åœ¨æ¯ä¸ªå—å†…çš„å‡ºç°æ¬¡æ•°ã€‚å—å†…çš„åŒºé—´å’Œå¯ä»¥ç®€å•ç»´æŠ¤ã€‚</p><p>å¯¹äºæ•£å—ï¼Œéœ€è¦ $O(\sqrt{m})$ æ¬¡åŒºé—´æ±‚å’Œã€‚å¯¹åºåˆ—åˆ†å—ï¼Œç»´æŠ¤åºåˆ—å‰ç¼€å’Œã€‚</p><h4 id="8-å¸¦æ’å…¥åŒºé—´Kå°å€¼"><a href="#8-å¸¦æ’å…¥åŒºé—´Kå°å€¼" class="headerlink" title="8.å¸¦æ’å…¥åŒºé—´Kå°å€¼"></a><a href="https://www.luogu.com.cn/problem/P4278">8.å¸¦æ’å…¥åŒºé—´Kå°å€¼</a></h4><p>aaaï¼ï¼ï¼</p><h2 id="æ ‘åˆ†å—"><a href="#æ ‘åˆ†å—" class="headerlink" title="æ ‘åˆ†å—"></a>æ ‘åˆ†å—</h2><h3 id="éšæœºæ’’ç‚¹"><a href="#éšæœºæ’’ç‚¹" class="headerlink" title="éšæœºæ’’ç‚¹"></a>éšæœºæ’’ç‚¹</h3><h4 id="1-Count-on-a-tree-II-ã€æ¨¡æ¿ã€‘æ ‘åˆ†å—"><a href="#1-Count-on-a-tree-II-ã€æ¨¡æ¿ã€‘æ ‘åˆ†å—" class="headerlink" title="1.Count on a tree II/ã€æ¨¡æ¿ã€‘æ ‘åˆ†å—"></a><a href="https://www.luogu.com.cn/problem/P6177">1.Count on a tree II/ã€æ¨¡æ¿ã€‘æ ‘åˆ†å—</a></h4><h3 id="ç‹å®¤è”é‚¦åˆ†å—"><a href="#ç‹å®¤è”é‚¦åˆ†å—" class="headerlink" title="ç‹å®¤è”é‚¦åˆ†å—"></a>ç‹å®¤è”é‚¦åˆ†å—</h3><h4 id="1-SCOI2005-ç‹å®¤è”é‚¦"><a href="#1-SCOI2005-ç‹å®¤è”é‚¦" class="headerlink" title="1.[SCOI2005] ç‹å®¤è”é‚¦"></a><a href="https://www.luogu.com.cn/problem/P2325">1.[SCOI2005] ç‹å®¤è”é‚¦</a></h4><h3 id="åŸºäº-top-cluster-çš„æ ‘åˆ†å—"><a href="#åŸºäº-top-cluster-çš„æ ‘åˆ†å—" class="headerlink" title="åŸºäº top cluster çš„æ ‘åˆ†å—"></a>åŸºäº top cluster çš„æ ‘åˆ†å—</h3><p>ã€‚ã€‚ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com/article/funv5guk">åˆ†å—</a></p><p><a href="https://www.cnblogs.com/IzayoiMiku/p/14691521.html">æ ‘åˆ†å—</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>DLX</title>
      <link href="/notes/DLX/"/>
      <url>/notes/DLX/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ç¥ç§˜çš„æœç´¢ä¼˜åŒ–ï¼Ÿ</p><p><a href="https://www.luogu.com.cn/problem/P4929">ã€æ¨¡æ¿ã€‘èˆè¹ˆé“¾ï¼ˆDLXï¼‰</a></p><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N=<span class="number">500</span><span class="number">+10</span>,M=<span class="number">6e3</span><span class="number">+100</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> gc getchar()</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rd read()</span></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span>{</span><br><span class="line"><span class="type">int</span> x=<span class="number">0</span>,f=<span class="number">0</span>; <span class="type">char</span> c=gc;</span><br><span class="line"><span class="keyword">for</span>(;c&lt;<span class="string">'0'</span>||c&gt;<span class="string">'9'</span>;c=gc) f|=(c==<span class="string">'-'</span>);</span><br><span class="line"><span class="keyword">for</span>(;c&gt;=<span class="string">'0'</span>&amp;&amp;c&lt;=<span class="string">'9'</span>;c=gc) x=(x&lt;&lt;<span class="number">1</span>)+(x&lt;&lt;<span class="number">3</span>)+(c^<span class="number">48</span>);</span><br><span class="line"><span class="keyword">return</span> f?-x:x;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m,a[N][N],col[M],cow[M],siz[N],head[N],U[M],D[M],L[M],R[M],tot=<span class="number">0</span>,sta[N],tp=<span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">bui</span><span class="params">(<span class="type">int</span> n,<span class="type">int</span> m)</span></span>{ <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=m;++i) L[i]=(i==<span class="number">0</span>?m:i<span class="number">-1</span>),R[i]=(i==m?<span class="number">0</span>:i<span class="number">+1</span>),U[i]=D[i]=i; tot=m; }</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> y)</span></span>{</span><br><span class="line">D[++tot]=D[y],U[tot]=y,U[D[y]]=tot,D[y]=tot,cow[tot]=x,++siz[col[tot]=y];</span><br><span class="line"><span class="keyword">if</span>(!head[x]) head[x]=L[tot]=R[tot]=tot;</span><br><span class="line"><span class="keyword">else</span> R[tot]=R[head[x]],L[tot]=head[x],L[R[head[x]]]=tot,R[head[x]]=tot;</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">del</span><span class="params">(<span class="type">int</span> c)</span></span>{</span><br><span class="line">R[L[c]]=R[c],L[R[c]]=L[c];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=D[c];i!=c;i=D[i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=R[i];j!=i;j=R[j])</span><br><span class="line">U[D[j]]=U[j],D[U[j]]=D[j],--siz[col[j]];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">rev</span><span class="params">(<span class="type">int</span> c)</span></span>{</span><br><span class="line">R[L[c]]=L[R[c]]=c;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=U[c];i!=c;i=U[i])</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L[i];j!=i;j=L[j])</span><br><span class="line">U[D[j]]=D[U[j]]=j,++siz[col[j]];</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dance</span><span class="params">()</span></span>{</span><br><span class="line"><span class="keyword">if</span>(!R[<span class="number">0</span>]) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> c=R[<span class="number">0</span>]; <span class="keyword">for</span>(<span class="type">int</span> i=R[<span class="number">0</span>];i!=<span class="number">0</span>;i=R[i]) <span class="keyword">if</span>(siz[i]&lt;siz[c]) c=i;</span><br><span class="line"><span class="built_in">del</span>(c);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=D[c];i!=c;i=D[i]){</span><br><span class="line">sta[++tp]=cow[i];</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=R[i];j!=i;j=R[j]) <span class="built_in">del</span>(col[j]);</span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">dance</span>()) <span class="keyword">return</span> <span class="number">1</span>; --tp;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=L[i];j!=i;j=L[j]) <span class="built_in">rev</span>(col[j]);</span><br><span class="line">}</span><br><span class="line"><span class="built_in">rev</span>(c);</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span>{</span><br><span class="line"></span><br><span class="line">n=rd,m=rd,<span class="built_in">bui</span>(n,m);</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;++i)</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">1</span>;j&lt;=m;++j)</span><br><span class="line"><span class="keyword">if</span>(rd) <span class="built_in">ins</span>(i,j);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="built_in">dance</span>()) <span class="keyword">return</span> <span class="built_in">printf</span>(<span class="string">"No Solution!\n"</span>),<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=tp;++i) <span class="built_in">printf</span>(<span class="string">"%d "</span>, sta[i]);</span><br><span class="line"></span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-æ•°ç‹¬"><a href="#1-æ•°ç‹¬" class="headerlink" title="1.æ•°ç‹¬"></a><a href="https://www.luogu.com.cn/problem/P1784">1.æ•°ç‹¬</a></h4><p>$(x,y,z)$ ä¸‰å…ƒç»„ï¼Œè¡¨ç¤º $(x,y)$ å¡« $z$ã€‚é‚£ä¹ˆé™åˆ¶æœ‰</p><ul><li><p>æ¯è¡Œæ•°ä¸é‡å¤</p></li><li><p>æ¯åˆ—æ•°ä¸é‡å¤</p></li><li><p>æ¯å®«æ•°ä¸é‡å¤</p></li><li><p>æ¯æ ¼æ•°ä¸é‡å¤</p></li></ul><p>æœ‰ $9^3=729$ ä¸ªä¸‰å…ƒç»„ï¼Œé™åˆ¶éœ€è¦ $4 \times 9^2=324$ ä½ï¼Œæ€»å…±æœ‰ $3 \times 729=2187$ ä¸ª $1$ã€‚</p><h4 id="2-NOIP2009-æé«˜ç»„-é¶å½¢æ•°ç‹¬"><a href="#2-NOIP2009-æé«˜ç»„-é¶å½¢æ•°ç‹¬" class="headerlink" title="2.[NOIP2009 æé«˜ç»„] é¶å½¢æ•°ç‹¬"></a><a href="https://www.luogu.com.cn/problem/P1074">2.[NOIP2009 æé«˜ç»„] é¶å½¢æ•°ç‹¬</a></h4><figure class="highlight c++"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">int</span> val[<span class="number">10</span>][<span class="number">10</span>]={</span><br><span class="line">{<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">10</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">8</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">7</span>,<span class="number">6</span>},</span><br><span class="line">{<span class="number">0</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>,<span class="number">6</span>}</span><br><span class="line">};</span><br></pre></td></tr></tbody></table></figure><h4 id="3-NOI2005-æ™ºæ…§ç æ¸¸æˆ"><a href="#3-NOI2005-æ™ºæ…§ç æ¸¸æˆ" class="headerlink" title="3.[NOI2005] æ™ºæ…§ç æ¸¸æˆ"></a><a href="https://www.luogu.com.cn/problem/P4205">3.[NOI2005] æ™ºæ…§ç æ¸¸æˆ</a></h4><p>ç”¨äº”å…ƒç»„è¡¨ç¤ºä¸€æ¬¡æ“ä½œï¼Œå³ç±»å‹ï¼Œä½ç½®ï¼Œæ—‹è½¬æ¬¡æ•°ï¼Œæ˜¯å¦ç¿»è½¬ã€‚<br>é™åˆ¶æ˜¯</p><ul><li><p>ä½ç½®è¢«å </p></li><li><p>ç å­è¢«å </p></li></ul><p>æœ€ç»ˆæ‰€æœ‰ä½ç½®ä¸ç å­éƒ½è¦è¢«å ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/rjhni32v">DLX</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æ¡å¸¦çŠ¶çŸ©é˜µçš„æ¶ˆå…ƒ</title>
      <link href="/notes/band_matrix/"/>
      <url>/notes/band_matrix/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>é«˜æ–¯æ¶ˆå…ƒçš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^3)$ã€‚</p><p>å¯¹äºæ¡å¸¦çŠ¶çŸ©é˜µï¼Œå³æ»¡è¶³å¯¹äºä»»æ„ $i$ï¼Œä» $(i,i)$ å‘å³æ‹“å±•æœ‰ä¸è¶…è¿‡ $d-1$ ä¸ªæ•°å­—ï¼Œå‘ä¸‹æ‹“å±•æœ‰ä¸è¶…è¿‡ $d-1$ ä¸ªæ•°å­—çš„çŸ©é˜µã€‚å¯ä»¥åšåˆ° $O(nd^2)$ã€‚</p><p>å®ç°æ˜¯ç®€å•çš„ï¼Œç±»ä¼¼é«˜æ–¯æ¶ˆå…ƒï¼Œé™åˆ¶èŒƒå›´å³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“ä¸»å…ƒä¸º $0$ æ—¶éœ€è¦æ¢è¡Œï¼Œé‚£ä¹ˆæ¶ˆå…ƒæ—¶éœ€è¦å‘å³æ¶ˆ $2d$ ä¸ªä½ç½®ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-Broken-robot"><a href="#1-Broken-robot" class="headerlink" title="1.Broken robot"></a><a href="https://www.luogu.com.cn/problem/CF24D">1.Broken robot</a></h4><h4 id="2-å…­çœè”è€ƒ-2017-åˆ†æ‰‹æ˜¯ç¥æ„¿"><a href="#2-å…­çœè”è€ƒ-2017-åˆ†æ‰‹æ˜¯ç¥æ„¿" class="headerlink" title="2.[å…­çœè”è€ƒ 2017] åˆ†æ‰‹æ˜¯ç¥æ„¿"></a><a href="https://www.luogu.com.cn/problem/P3750">2.[å…­çœè”è€ƒ 2017] åˆ†æ‰‹æ˜¯ç¥æ„¿</a></h4><h4 id="3-Circles-of-Waiting"><a href="#3-Circles-of-Waiting" class="headerlink" title="3.Circles of Waiting"></a><a href="https://www.luogu.com.cn/problem/CF963E">3.Circles of Waiting</a></h4><p>DPï¼Œåªæœ‰ $x^2+y^2 \le R^2$ çš„ä¸ä¸º $0$ï¼Œæœ‰ $O(R^2)$ ä¸ªç‚¹ã€‚</p><p>è¿ç»­æ ‡å·ï¼Œé‚£ä¹ˆæ˜¯ä¸€ä¸ªæ»¡è¶³ $d=R+1$ çš„çŸ©é˜µï¼Œæ¶ˆå…ƒæ—¶é—´å¤æ‚åº¦ $O(R^4)$ã€‚</p><h4 id="4-BJOI2018-æ²»ç–—ä¹‹é›¨"><a href="#4-BJOI2018-æ²»ç–—ä¹‹é›¨" class="headerlink" title="4.[BJOI2018] æ²»ç–—ä¹‹é›¨"></a><a href="https://www.luogu.com.cn/problem/P4457">4.[BJOI2018] æ²»ç–—ä¹‹é›¨</a></h4><p>çŸ©é˜µæ˜¯ä¸‹ä¸‰è§’çš„ï¼Œåç€æ¶ˆå˜ä¸ºä¸Šä¸‰è§’çš„ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n^2d)$ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/3zspg7qj">æµ…è°ˆé«˜æ–¯æ¶ˆå…ƒæ‹“å±•ä¹‹ band-matrix</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>æœ€çŸ­è·¯æ ‘</title>
      <link href="/notes/%E6%9C%80%E7%9F%AD%E8%B7%AF%E6%A0%91/"/>
      <url>/notes/%E6%9C%80%E7%9F%AD%E8%B7%AF%E6%A0%91/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>åŸå›¾çš„ä¸€æ£µç”Ÿæˆæ ‘ï¼Œæ»¡è¶³æ¯ä¸ªç‚¹åˆ°æºç‚¹çš„æœ€çŸ­è·¯é•¿åº¦ç­‰äºç”Ÿæˆæ ‘ä¸­æ¯ä¸ªç‚¹åˆ°æ ¹èŠ‚ç‚¹çš„è·ç¦»ã€‚</p><p>åœ¨ dij è¿‡ç¨‹ä¸­æ‰¾æ¯ä¸ªç‚¹çš„å‰é©±å³å¯ã€‚</p><p>å°†æ‰€æœ‰æ»¡è¶³ $dis_v=dis_u+w$ çš„è¾¹ $(u \to v)$ åŠ å…¥ï¼Œå¾—åˆ°æœ€çŸ­è·¯ DAGï¼Œæœ€çŸ­è·¯ DAG çš„ç”Ÿæˆæ ‘ä¸ºæœ€çŸ­è·¯æ ‘ã€‚</p><h2 id="ä¾‹é¢˜"><a href="#ä¾‹é¢˜" class="headerlink" title="ä¾‹é¢˜"></a>ä¾‹é¢˜</h2><h4 id="1-Paths-and-Trees"><a href="#1-Paths-and-Trees" class="headerlink" title="1.Paths and Trees"></a><a href="https://www.luogu.com.cn/problem/CF545E">1.Paths and Trees</a></h4><p>ç›´æ¥è´ªå¿ƒã€‚</p><h4 id="2-Edge-Deletion"><a href="#2-Edge-Deletion" class="headerlink" title="2.Edge Deletion"></a><a href="https://www.luogu.com.cn/problem/CF1076D">2.Edge Deletion</a></h4><p>ã€‚ã€‚ã€‚</p><h4 id="3-Berland-and-the-Shortest-Paths"><a href="#3-Berland-and-the-Shortest-Paths" class="headerlink" title="3.Berland and the Shortest Paths"></a><a href="https://www.luogu.com.cn/problem/CF1005F">3.Berland and the Shortest Paths</a></h4><p>æ¯ä¸ªç‚¹æ˜¯ç‹¬ç«‹çš„ã€‚ã€‚ã€‚</p><h4 id="4-åˆ è¾¹æœ€çŸ­è·¯"><a href="#4-åˆ è¾¹æœ€çŸ­è·¯" class="headerlink" title="4.åˆ è¾¹æœ€çŸ­è·¯"></a>4.åˆ è¾¹æœ€çŸ­è·¯</h4><p>ç»™å®šä¸€å¼  æ— å‘æ­£æƒå›¾ï¼Œå¯¹å›¾ä¸Šçš„æ¯æ¡è¾¹ï¼Œæ±‚åˆ å»è¯¥è¾¹åçš„æœ€çŸ­è·¯ã€‚</p><p>æ±‚å‡ºä¸€æ¡ $1 \to n$ çš„æœ€çŸ­è·¯ï¼Œè®°ä¸º $P$ï¼Œ$T_1,T_n$ è¡¨ç¤ºä»¥ $1,n$ ä¸ºæºç‚¹çš„æœ€çŸ­è·¯æ ‘ã€‚<br>è‹¥ $e \notin P$ï¼Œé‚£ä¹ˆæœ€çŸ­è·¯ä¸å˜ã€‚</p><p>å¦åˆ™æœ€çŸ­è·¯å½¢å¦‚ $(1 \to u) + (u \to v) + (v \to n)$ã€‚</p><p><a href="https://www.luogu.com.cn/problem/CF1163F">Indecisive Taxi Fee</a></p><p>æšä¸¾æ¯æ¡è¾¹ä½œä¸ºéæœ€çŸ­è·¯æ ‘ä¸Šçš„è¾¹ï¼Œå…¶å¯¹ $P$ çš„ä¸€æ®µåŒºé—´æœ‰è´¡çŒ®ï¼Œç¦»çº¿æ‰«æçº¿å³å¯ã€‚</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com.cn/article/86gevhsv">æœ€çŸ­è·¯æ ‘</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>çº¿æ®µæ ‘è¿›é˜¶</title>
      <link href="/notes/%E7%BA%BF%E6%AE%B5%E6%A0%91%E8%BF%9B%E9%98%B6/"/>
      <url>/notes/%E7%BA%BF%E6%AE%B5%E6%A0%91%E8%BF%9B%E9%98%B6/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¿å­"><a href="#æ¿å­" class="headerlink" title="æ¿å­"></a>æ¿å­</h2><h4 id="1-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘-1"><a href="#1-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘-1" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘ 1"></a><a href="https://www.luogu.com.cn/problem/P3372">1.ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘ 1</a></h4><p><a href="https://www.luogu.com.cn/paste/vwkwqr8x">code</a></p><h4 id="2-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘-2"><a href="#2-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘-2" class="headerlink" title="2.ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘ 2"></a><a href="https://www.luogu.com.cn/problem/P3373">2.ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘ 2</a></h4><p><a href="https://www.luogu.com.cn/paste/aatmfvej">code</a></p><h2 id="çº¿æ®µæ ‘ç»“æ„åˆ†æ"><a href="#çº¿æ®µæ ‘ç»“æ„åˆ†æ" class="headerlink" title="çº¿æ®µæ ‘ç»“æ„åˆ†æ"></a>çº¿æ®µæ ‘ç»“æ„åˆ†æ</h2><h4 id="1-THUPC2021-åˆèµ›-çº¿æ®µæ ‘"><a href="#1-THUPC2021-åˆèµ›-çº¿æ®µæ ‘" class="headerlink" title="1.[THUPC2021 åˆèµ›] çº¿æ®µæ ‘"></a><a href="https://www.luogu.com.cn/problem/P7143">1.[THUPC2021 åˆèµ›] çº¿æ®µæ ‘</a></h4><blockquote><p>$[1,n]$ ä¸Šçš„å¹¿ä¹‰çº¿æ®µæ ‘å†… $[l,r]$ çš„æœ€å°æ‹†åˆ†å¤§å°ä¸º $2(r-l+1)-|S|$ï¼Œå…¶ä¸­ $S$ ä¸ºåŒ…å«äº $[l,r]$ çš„çº¿æ®µæ ‘èŠ‚ç‚¹ã€‚</p></blockquote><p><strong>è¯æ˜</strong></p><p>å°†åŒ…å«äº $[l,r]$ çš„çº¿æ®µæ ‘èŠ‚ç‚¹å–å‡ºï¼Œå½¢æˆæ»¡äºŒå‰æ ‘æ£®æ—ï¼Œæ ¹èŠ‚ç‚¹çš„ä¸ªæ•°ä¸ºæœ€å°æ‹†åˆ†å¤§å°ã€‚<br>å¶å­èŠ‚ç‚¹çš„ä¸ªæ•°ä¸º $r-l+1$ï¼Œé‚£ä¹ˆ $|S|=2(r-l+1)-æ ¹èŠ‚ç‚¹çš„ä¸ªæ•°$ã€‚</p><h4 id="2-ZJOI2017-çº¿æ®µæ ‘"><a href="#2-ZJOI2017-çº¿æ®µæ ‘" class="headerlink" title="2.[ZJOI2017] çº¿æ®µæ ‘"></a><a href="https://www.luogu.com.cn/problem/P5210">2.[ZJOI2017] çº¿æ®µæ ‘</a></h4><blockquote><p>$[l,r]$ çš„æ‹†åˆ†å¯ä»¥çœ‹æˆ $[l-1,l-1],[r+1,r+1]$ ä¸äºŒè€… lcaï¼Œçš„è·¯å¾„çš„å·¦/å³å„¿å­ã€‚</p></blockquote><p>ä¸æƒ³å†™äº†ã€‚ã€‚ã€‚</p><h4 id="3-ZJOI2019-çº¿æ®µæ ‘"><a href="#3-ZJOI2019-çº¿æ®µæ ‘" class="headerlink" title="3.[ZJOI2019] çº¿æ®µæ ‘"></a><a href="https://www.luogu.com.cn/problem/P5280">3.[ZJOI2019] çº¿æ®µæ ‘</a></h4><p>å¯¹ç‚¹åˆ†ç±»ã€‚ã€‚ã€‚</p><h4 id="4-ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½"><a href="#4-ZJOI2020-ä¼ ç»Ÿè‰ºèƒ½" class="headerlink" title="4.[ZJOI2020] ä¼ ç»Ÿè‰ºèƒ½"></a><a href="https://www.luogu.com.cn/problem/P6630">4.[ZJOI2020] ä¼ ç»Ÿè‰ºèƒ½</a></h4><h2 id="æ‰«æçº¿"><a href="#æ‰«æçº¿" class="headerlink" title="æ‰«æçº¿"></a>æ‰«æçº¿</h2><p>è¿™æ˜¯ä¸€ç§æ€æƒ³ã€‚ç‹­ä¹‰ä¸Šæ›´åå‘äºè®¡ç®—å‡ ä½•ã€‚</p><h4 id="1-ã€æ¨¡æ¿ã€‘æ‰«æçº¿"><a href="#1-ã€æ¨¡æ¿ã€‘æ‰«æçº¿" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘æ‰«æçº¿"></a><a href="https://www.luogu.com.cn/problem/P5490">1.ã€æ¨¡æ¿ã€‘æ‰«æçº¿</a></h4><p><a href="https://www.luogu.com.cn/paste/ckicgynk">code</a> è¿™é‡Œä¹Ÿå¯ä»¥ç»´æŠ¤åŒºé—´æœ€å°å€¼åŠå…¶ä¸ªæ•°ã€‚</p><h4 id="2-IOI1998-USACO5-5-çŸ©å½¢å‘¨é•¿Picture"><a href="#2-IOI1998-USACO5-5-çŸ©å½¢å‘¨é•¿Picture" class="headerlink" title="2.[IOI1998] [USACO5.5] çŸ©å½¢å‘¨é•¿Picture"></a><a href="https://www.luogu.com.cn/problem/P1856">2.[IOI1998] [USACO5.5] çŸ©å½¢å‘¨é•¿Picture</a></h4><p><a href="https://www.luogu.com.cn/paste/572dp688">code</a></p><h4 id="3-SDOI2009-HHçš„é¡¹é“¾"><a href="#3-SDOI2009-HHçš„é¡¹é“¾" class="headerlink" title="3.[SDOI2009] HHçš„é¡¹é“¾"></a><a href="https://www.luogu.com.cn/problem/P1972">3.[SDOI2009] HHçš„é¡¹é“¾</a></h4><p>åŒºé—´ $[l,r]$ è½¬åŒ–ä¸ºç‚¹ $(l,r)$ï¼Œå‘ç°åªéœ€æ±‚æ¯ä¸ªç‚¹è¢«è¦†ç›–ä¸ªæ•°ï¼Œæ‰«æçº¿+æ ‘çŠ¶æ•°ç»„å®ç°ã€‚</p><p>äº‹å®ä¸Šå•çº¯ä»å·¦åˆ°å³æ‰«æï¼Œç”¨çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤ä¿¡æ¯å°±æ˜¯æ‰«æçº¿æ€æƒ³äº†ã€‚è¿™é¢˜ä¹Ÿå¯ä»¥è¿™æ ·ç†è§£ã€‚</p><h2 id="å¯æŒä¹…åŒ–çº¿æ®µæ ‘"><a href="#å¯æŒä¹…åŒ–çº¿æ®µæ ‘" class="headerlink" title="å¯æŒä¹…åŒ–çº¿æ®µæ ‘"></a>å¯æŒä¹…åŒ–çº¿æ®µæ ‘</h2><h4 id="1-ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘-2"><a href="#1-ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘-2" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2"></a><a href="https://www.luogu.com.cn/problem/P3834">1.ã€æ¨¡æ¿ã€‘å¯æŒä¹…åŒ–çº¿æ®µæ ‘ 2</a></h4><p>å¯¹ä¸‹æ ‡æ‰«æçº¿ï¼Œæ„å»ºå¯æŒä¹…åŒ–æƒå€¼çº¿æ®µæ ‘ã€‚</p><h4 id="2-Rmq-Problem-mex"><a href="#2-Rmq-Problem-mex" class="headerlink" title="2.Rmq Problem / mex"></a><a href="https://www.luogu.com.cn/problem/P4137">2.Rmq Problem / mex</a></h4><p>æƒå€¼çº¿æ®µæ ‘ç»´æŠ¤æ¯ä¸ªå€¼æœ€åå‡ºç°çš„ä½ç½®ã€‚ç¦»çº¿æ‰«æçº¿æˆ–å¯æŒä¹…åŒ–çº¿æ®µæ ‘å‡å¯ã€‚</p><h4 id="3-CQOI2015-ä»»åŠ¡æŸ¥è¯¢ç³»ç»Ÿ"><a href="#3-CQOI2015-ä»»åŠ¡æŸ¥è¯¢ç³»ç»Ÿ" class="headerlink" title="3.[CQOI2015] ä»»åŠ¡æŸ¥è¯¢ç³»ç»Ÿ"></a><a href="https://www.luogu.com.cn/problem/P3168">3.[CQOI2015] ä»»åŠ¡æŸ¥è¯¢ç³»ç»Ÿ</a></h4><p>å¯¹æ—¶é—´æ‰«æçº¿ï¼Œç”¨æƒå€¼çº¿æ®µæ ‘ç»´æŠ¤ä¼˜å…ˆçº§ï¼Œç”±äºå¼ºåˆ¶åœ¨çº¿ï¼Œç”¨å¯æŒä¹…åŒ–çº¿æ®µæ ‘å³å¯ã€‚</p><h4 id="4-Destiny"><a href="#4-Destiny" class="headerlink" title="4.Destiny"></a><a href="https://www.luogu.com.cn/problem/CF840D">4.Destiny</a></h4><p>ç±»ä¼¼ç»å¯¹ä¼—æ•°ä¸ºæ’åºåç¬¬ $\left \lceil \frac{n}{2} \right \rceil$ ä¸ªå…ƒç´ ã€‚</p><p>è®° $d=\left \lceil \frac{r-l+1}{k} \right \rceil$ï¼ŒæŸ¥è¯¢åŒºé—´ç¬¬ $d,2d,â€¦$ å¤§ï¼Œåˆ¤æ–­æ¬¡æ•°æ˜¯å¦ç¬¦åˆå³å¯ã€‚</p><p>å¯æŒä¹…åŒ–çº¿æ®µæ ‘ç»´æŠ¤ï¼Œæ—¶é—´å¤æ‚åº¦ $O(kn\log n)$ã€‚</p><h2 id="çº¿æ®µæ ‘åˆå¹¶"><a href="#çº¿æ®µæ ‘åˆå¹¶" class="headerlink" title="çº¿æ®µæ ‘åˆå¹¶"></a>çº¿æ®µæ ‘åˆå¹¶</h2><p>éœ€è¦è€ƒè™‘çš„æ˜¯ä¸¤ä¸ªå¶å­èŠ‚ç‚¹çš„åˆå¹¶å’Œå¦‚ä½•åªå–ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><h3 id="æ ‘ä¸Šé—®é¢˜"><a href="#æ ‘ä¸Šé—®é¢˜" class="headerlink" title="æ ‘ä¸Šé—®é¢˜"></a>æ ‘ä¸Šé—®é¢˜</h3><h4 id="1-é›¨å¤©çš„å°¾å·´"><a href="#1-é›¨å¤©çš„å°¾å·´" class="headerlink" title="1.é›¨å¤©çš„å°¾å·´"></a><a href="https://www.luogu.com.cn/problem/P4556">1.é›¨å¤©çš„å°¾å·´</a></h4><p><a href="https://www.luogu.com.cn/paste/3y9u0025">code</a></p><h4 id="2-NOIP2016-æé«˜ç»„-å¤©å¤©çˆ±è·‘æ­¥"><a href="#2-NOIP2016-æé«˜ç»„-å¤©å¤©çˆ±è·‘æ­¥" class="headerlink" title="2.[NOIP2016 æé«˜ç»„] å¤©å¤©çˆ±è·‘æ­¥"></a><a href="https://www.luogu.com.cn/problem/P1600">2.[NOIP2016 æé«˜ç»„] å¤©å¤©çˆ±è·‘æ­¥</a></h4><p>å¯ä»¥æŠŠç©å®¶æ‹†æˆå‘ä¸Šå’Œå‘ä¸‹çš„ä¸¤æ¡é“¾ï¼Œä¸¤æ¡é“¾æ—¶é—´å‡é€’å‡/å¢ï¼Œä¸æ·±åº¦è”ç³»ä¸€ä¸‹å°±èƒ½è½¬åŒ–ä¸ºé›¨å¤©çš„å°¾å·´ã€‚</p><h3 id="æ•´ä½“-DP"><a href="#æ•´ä½“-DP" class="headerlink" title="æ•´ä½“ DP"></a>æ•´ä½“ DP</h3><p>å¯¹äºæ ‘ä¸Š DP é—®é¢˜ï¼Œå¯ç”¨çº¿æ®µæ ‘ç»´æŠ¤å…¶ä¸­ä¸€ç»´ï¼ŒåŠ å…¥å­èŠ‚ç‚¹æ—¶ç”¨çº¿æ®µæ ‘åˆå¹¶è½¬ç§»ï¼Œå¯ä»¥ä¼˜åŒ–æ—¶é—´å’Œç©ºé—´ã€‚</p><h4 id="1-PKUWC2018-Minimax"><a href="#1-PKUWC2018-Minimax" class="headerlink" title="1.[PKUWC2018] Minimax"></a><a href="https://www.luogu.com.cn/problem/P5298">1.[PKUWC2018] Minimax</a></h4><p>æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½æœ‰æ¦‚ç‡è¢«å–åˆ°ï¼Œå…ˆç¦»æ•£åŒ–ä¸€ä¸‹ï¼Œè®¡ç®—å‡ºæ ¹èŠ‚ç‚¹å–ç¬¬ $i$ å°æƒå€¼çš„æ¦‚ç‡å³å¯è®¡ç®—ç­”æ¡ˆã€‚</p><p>è®° $f[u][i]$ ä¸º $u$ èŠ‚ç‚¹å– $i$ å·æƒå€¼ï¼ˆå³ä¸ºç¬¬ $i$ å°ï¼‰çš„æ¦‚ç‡ã€‚ç”±äºå­èŠ‚ç‚¹æ•°å°äº $2$ ï¼Œå¯ä»¥åˆ†è®¨ä¸€ä¸‹</p><ul><li>è‹¥ $u$ ä¸ºå¶å­èŠ‚ç‚¹ï¼Œç›´æ¥æ›´æ–°ã€‚</li><li>è‹¥ $u$ åªæœ‰ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œç›´æ¥å–å­èŠ‚ç‚¹çš„å€¼ã€‚</li><li>è‹¥ $u$ æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚<script type="math/tex; mode=display">  f[u][i]=f[lc][i](p[u]\sum_{j=1}^{i-1} f[rc][j]+(1-p[u])\sum_{j=i+1}^{m} f[rc][j])+f[rc][i](p[u]\sum_{j=1}^{i-1} f[lc][j]+(1-p[u])\sum_{j=i+1}^{m} f[lc][j])</script></li></ul><p>å¯ä»¥å‰ç¼€å’Œåç¼€å’Œä¼˜åŒ– $O(n^2)$ æš´åŠ›è®¡ç®—ã€‚</p><p>è€ƒè™‘æƒå€¼çº¿æ®µæ ‘ç»´æŠ¤ç¬¬äºŒç»´åŒºé—´å’Œï¼ˆå…¶å®å°±æ˜¯æ¦‚ç‡å’Œï¼‰ã€‚éœ€è¦åˆå¹¶ä¸¤ä¸ªå­èŠ‚ç‚¹çš„å€¼ï¼Œè€ƒè™‘å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ä¸ºç©ºçš„æƒ…å†µï¼Œå‘ç°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰å€¼éƒ½éœ€è¦ä¹˜åŒä¸€ä¸ªå€¼ï¼Œå†™ä¸€ä¸ªåŒºé—´ä¹˜å³å¯ã€‚å…·ä½“å®ç°æ—¶ï¼Œä¸€è¾¹åˆå¹¶ï¼Œä¸€è¾¹è®°å½•å‰ç¼€åç¼€å’Œã€‚</p><h4 id="2-NOI2020-å‘½è¿"><a href="#2-NOI2020-å‘½è¿" class="headerlink" title="2.[NOI2020] å‘½è¿"></a><a href="https://www.luogu.com.cn/problem/P6773">2.[NOI2020] å‘½è¿</a></h4><p>è€ƒè™‘æ ‘ä¸Š DPã€‚åœ¨æšä¸¾ $u$ ç‚¹æ—¶ï¼Œéœ€è¦ç®¡çš„é“¾è‚¯å®šæ˜¯ä¸‹ç«¯ç‚¹åœ¨å­æ ‘ä¸­ä¸”æœªè¢«æ»¡è¶³çš„ï¼Œæ­¤æ—¶åº”è€ƒè™‘ $u$ åˆ°å­èŠ‚ç‚¹çš„è¾¹çš„å–å€¼ã€‚</p><p>ä¸éš¾å‘ç°åªéœ€è¦è€ƒè™‘ä¸Šç«¯ç‚¹åœ¨ $u$ ä¸Šæ–¹ä¸”æ·±åº¦æœ€å¤§çš„é“¾ï¼Œå¦‚æœå®ƒè¢«æ»¡è¶³ï¼Œåˆ™å…¶ä»–æ‰€æœ‰é“¾éƒ½è¢«æ»¡è¶³ï¼ˆåœ¨ $u$ ä¸Šæ–¹è¿™ä¸ªé™åˆ¶ä¸ç”¨ç‰¹æ„æ³¨æ„ï¼‰ã€‚</p><p>å¯ä»¥è®° $f(u,i)$ ä¸ºä¸‹ç«¯ç‚¹åœ¨ $u$ çš„å­æ ‘å†…ä¸”æœªè¢«æ»¡è¶³çš„é“¾çš„ä¸Šç«¯ç‚¹çš„æœ€å¤§æ·±åº¦ä¸º $i$ çš„æ–¹æ¡ˆæ•°ã€‚æ¯æ¬¡åŠ ä¸€ä¸ªå­èŠ‚ç‚¹è½¬ç§»</p><script type="math/tex; mode=display">f(u,i)'=f(u,i)(sum(v,dep_u)+sum(v,i))+sum(u,i-1)f(v,i)</script><p>ä¸å‰ç¼€å’Œæœ‰å…³ï¼Œä¸”å¼€å§‹æœ‰å€¼çš„ç‚¹å¾ˆå°‘ï¼Œç”¨çº¿æ®µæ ‘åˆå¹¶ä¼˜åŒ–ã€‚å…·ä½“å®ç°æ—¶åœ¨ <code>merge</code> ä¸­è®°å½•ä¸¤æ£µçº¿æ®µæ ‘çš„å‰ç¼€å’Œå¯ä»¥å‡å°‘æŸ¥è¯¢çš„ $\log$ã€‚å¯¹äº $sum(u,i-1)$ åœ¨æœ‰ä¸ªèŠ‚ç‚¹ä¸ºç©ºæ—¶ä¸éœ€è¦ç®¡ï¼Œå› ä¸ºç©ºèŠ‚ç‚¹å€¼ä¸º $0$ã€‚å½“ $l=r$ æ—¶ï¼Œéœ€è¦è€ƒè™‘ï¼Œåº”è¯¥åæ›´æ–°è¯¥èŠ‚ç‚¹çš„å‰ç¼€å’Œã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log n)$ã€‚</p><h2 id="çº¿æ®µæ ‘åˆ†è£‚"><a href="#çº¿æ®µæ ‘åˆ†è£‚" class="headerlink" title="çº¿æ®µæ ‘åˆ†è£‚"></a>çº¿æ®µæ ‘åˆ†è£‚</h2><h4 id="1-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†è£‚"><a href="#1-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†è£‚" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†è£‚"></a><a href="https://www.luogu.com.cn/problem/P5494">1.ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†è£‚</a></h4><p><a href="https://www.luogu.com.cn/paste/iuk6h36n">code</a> è¿˜å¯ä»¥å¹³è¡¡æ ‘åˆå¹¶ã€‚</p><h2 id="æ ‘å¥—æ ‘"><a href="#æ ‘å¥—æ ‘" class="headerlink" title="æ ‘å¥—æ ‘"></a>æ ‘å¥—æ ‘</h2><p><a href="/notes/æ ‘å¥—æ ‘">è¯¦è§</a></p><h2 id="æè¶…çº¿æ®µæ ‘"><a href="#æè¶…çº¿æ®µæ ‘" class="headerlink" title="æè¶…çº¿æ®µæ ‘"></a>æè¶…çº¿æ®µæ ‘</h2><p>æ”¯æŒæ’å…¥çº¿æ®µï¼ŒæŸ¥è¯¢æŸä½ç½®äº¤ç‚¹æœ€å€¼ã€‚</p><h4 id="1-ã€æ¨¡æ¿ã€‘æè¶…çº¿æ®µæ ‘-HEOI2013-Segment"><a href="#1-ã€æ¨¡æ¿ã€‘æè¶…çº¿æ®µæ ‘-HEOI2013-Segment" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘æè¶…çº¿æ®µæ ‘ / [HEOI2013] Segment"></a><a href="https://www.luogu.com.cn/problem/P4097">1.ã€æ¨¡æ¿ã€‘æè¶…çº¿æ®µæ ‘ / [HEOI2013] Segment</a></h4><p><a href="https://www.luogu.com.cn/paste/q18lbhyl">code</a></p><h4 id="2-ä¸ä¹‹å‰²"><a href="#2-ä¸ä¹‹å‰²" class="headerlink" title="2.ä¸ä¹‹å‰²"></a><a href="https://www.luogu.com.cn/problem/P6047">2.ä¸ä¹‹å‰²</a></h4><p>ä¸ºäº†æ–¹ä¾¿ï¼Œå…ˆå°†ç¬¬ä¸€è¡Œåè½¬ä¸€ä¸‹ï¼Œå¹¶å°†çº¿çš„ä½ç½®åŠ  $1$ã€‚ä¸€äº›è¢«åŒ…å«çš„çº¿æ˜¯æ²¡ç”¨çš„å°†å…¶å»æ‰ã€‚å‰©ä¸‹çš„æŒ‰ç¬¬ä¸€è¡Œçš„ä½ç½®æ’åºï¼Œç¬¬äºŒè¡Œçš„ä½ç½®æ˜¯å•å‡çš„ã€‚</p><p>è€ƒè™‘ DPï¼Œè®° $f(i)$ ä¸ºå¤„ç†åˆ°ç¬¬ $i$ ä¸ªçš„æœ€å°èŠ±è´¹ã€‚è½¬ç§»æ˜¾ç„¶å¯ä»¥æ–œç‡ä¼˜åŒ–ã€‚ç”¨æè¶…çº¿æ®µæ ‘å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log n)$ï¼ˆæ˜¯å• $\log$ å› ä¸ºæ˜¯æ’å…¥ç›´çº¿ï¼‰ã€‚</p><h4 id="3-Escape-Through-Leaf"><a href="#3-Escape-Through-Leaf" class="headerlink" title="3.Escape Through Leaf"></a><a href="https://www.luogu.com.cn/problem/CF932F">3.Escape Through Leaf</a></h4><p>æš´åŠ›æ ‘ä¸Š DP æ˜¾ç„¶ï¼Œç”¨æè¶…çº¿æ®µæ ‘åˆå¹¶ç»´æŠ¤ã€‚çº¿æ®µæ ‘åˆå¹¶çš„æ—¶é—´å¤æ‚åº¦æ˜¯ $O(n\log n)$ çš„ï¼Œç¬¬ä¸€ç¯‡é¢˜è§£æœ‰åŠ¿èƒ½åˆ†æã€‚</p><p>dsu on tree å¯ä»¥åšåˆ° $O(n\log^2n)$ã€‚</p><h4 id="4-Sum-of-Prefix-Sums"><a href="#4-Sum-of-Prefix-Sums" class="headerlink" title="4.Sum of Prefix Sums"></a><a href="https://www.luogu.com.cn/problem/CF1303G">4.Sum of Prefix Sums</a></h4><p>æœ‰ç‚¹ç±»ä¼¼ç›´å¾„ï¼Œä½†æ˜¯å¾ˆå¤æ‚ï¼Œä¸èƒ½ DP æˆ–è´ªå¿ƒã€‚è€ƒè™‘ç‚¹åˆ†æ²»ï¼Œåˆå¹¶è·¯å¾„æ—¶ç”¨æè¶…çº¿æ®µæ ‘ã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h2 id="çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µ"><a href="#çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µ" class="headerlink" title="çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µ"></a>çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µ</h2><h3 id="åºåˆ—é—®é¢˜"><a href="#åºåˆ—é—®é¢˜" class="headerlink" title="åºåˆ—é—®é¢˜"></a>åºåˆ—é—®é¢˜</h3><h4 id="1-Bear-and-Cavalry"><a href="#1-Bear-and-Cavalry" class="headerlink" title="1.Bear and Cavalry"></a><a href="https://www.luogu.com.cn/problem/CF573D">1.Bear and Cavalry</a></h4><h3 id="æ ‘ä¸Šé—®é¢˜-1"><a href="#æ ‘ä¸Šé—®é¢˜-1" class="headerlink" title="æ ‘ä¸Šé—®é¢˜"></a>æ ‘ä¸Šé—®é¢˜</h3><h4 id="1-ã€æ¨¡æ¿ã€‘â€åŠ¨æ€-DPâ€-amp-åŠ¨æ€æ ‘åˆ†æ²»"><a href="#1-ã€æ¨¡æ¿ã€‘â€åŠ¨æ€-DPâ€-amp-åŠ¨æ€æ ‘åˆ†æ²»" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘â€åŠ¨æ€ DPâ€&amp;åŠ¨æ€æ ‘åˆ†æ²»"></a><a href="https://www.luogu.com.cn/problem/P4719">1.ã€æ¨¡æ¿ã€‘â€åŠ¨æ€ DPâ€&amp;åŠ¨æ€æ ‘åˆ†æ²»</a></h4><p>å¦‚æœæ²¡æœ‰ä¿®æ”¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•ç”¨ DP æ±‚è§£ã€‚è®° $dp(u,0/1)$ ä¸º $u$ çš„å­æ ‘ï¼Œ$u$ é€‰æˆ–ä¸é€‰çš„æœ€å¤§ç‹¬ç«‹é›†ï¼Œæœ‰</p><script type="math/tex; mode=display">dp(u,0)=\sum_{v}\max(dp(v,0),dp(v,1)) \\dp(u,1)=\sum_{v}dp(v,0)+a_u</script><p>å¯¹äºæ¯ä¸ªç‚¹é€‰å‡ºä¸€ä¸ªç‰¹æ®Šçš„å­èŠ‚ç‚¹ $x$ï¼Œè®° $f_u=\sum_{v \ne x} \max(dp(v,0),dp(v,1))$ï¼Œ$g_u=\sum_{v \ne x}dp(v,0)+a[u]$ã€‚é‚£ä¹ˆæœ‰</p><script type="math/tex; mode=display">dp(u,0)=\max(dp(x,0),dp(x,1))+f_u \\dp(u,1)=dp(x,0)+g_u</script><p>å†™æˆ $(\max,+)$ å¹¿ä¹‰çŸ©é˜µä¹˜æ³•çš„å½¢å¼å°±æ˜¯</p><script type="math/tex; mode=display">\begin{bmatrix}  dp[u][0] \\  dp[u][1]\end{bmatrix}=\begin{bmatrix}  f[u] & f[u] \\  g[u] & -\infty\end{bmatrix}\begin{bmatrix}  dp[x][0] \\  dp[x][1]\end{bmatrix}</script><p>ä»¤ $x$ ä¸º $u$ çš„é‡å„¿å­ï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤çŸ©é˜µä¹˜æ³•ï¼Œé‚£ä¹ˆä¿®æ”¹ä¸€ä¸ªç‚¹ï¼Œåªä¼šå¯¹ $O(\log n)$ æ¡é‡é“¾é€ æˆå½±å“ã€‚</p><p><a href="https://www.luogu.com.cn/paste/jvns0zm5">code</a></p><h4 id="2-ZJOI2019-Minimaxæœç´¢"><a href="#2-ZJOI2019-Minimaxæœç´¢" class="headerlink" title="2.[ZJOI2019] Minimaxæœç´¢"></a><a href="https://www.luogu.com.cn/problem/P5281">2.[ZJOI2019] Minimaxæœç´¢</a></h4><p>é™åˆ¶æ˜¯å– $\max$ çš„å½¢å¼ï¼Œè€ƒè™‘æ±‚å‡º $\max \le k$ çš„æ–¹æ¡ˆæ•°å†å·®åˆ†ã€‚<br>è€ƒè™‘å¦‚ä½•å¯¹å•ä¸ª $k$ å¿«é€Ÿæ±‚å‡ºç­”æ¡ˆã€‚</p><p>è®° $dp_u$ ä¸ºæ²¡æœ‰å˜åŒ–æ—¶ $u$ ç‚¹çš„å€¼ã€‚é‚£ä¹ˆ $1 \to dp_1$ å½¢æˆäº†ä¸€æ¡ $dp$ å€¼éƒ½ä¸º $dp_1$ çš„é“¾ï¼Œåªè¦é“¾ä¸Šä»»æ„èŠ‚ç‚¹çš„ $dp$ å€¼æ”¹å˜ï¼Œç­”æ¡ˆä¸€å®šæ”¹å˜ã€‚</p><p>å¯¹äºå¶å­èŠ‚ç‚¹ $u$ï¼Œè‹¥ $dep_{lca(u,dp_1)}$ ä¸ºå¥‡æ•°ï¼Œé‚£ä¹ˆè‹¥æ”¹å˜ $u$ï¼Œåˆ™ $dp_u$ å˜ä¸º $dp_u + k$ï¼Œå¶æ•°åŒç†ã€‚</p><p>è®° $f_u$ ä¸ºå¯ä»¥ä½¿ $dp_u \le dp_1$ çš„æ–¹æ¡ˆæ•°ï¼ˆå¶å­èŠ‚ç‚¹éœ€è¦ç‰¹åˆ¤ï¼‰$cnt_u$ ä¸º $u$ å­æ ‘ä¸­æ€»æ–¹æ¡ˆæ•°ã€‚ç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">cnt_1 - \prod_{dp_u = dp_1} ([dep_u\%2=1]f_u + [dep_u\%2=0](cnt_u-f_u))</script><p>$f$ ä¹Ÿæ˜¯å¥½è®¡ç®—çš„ï¼Œå°±å¯ä»¥ $O(n)$ æ±‚å‡ºç‰¹å®š $k$ çš„ç­”æ¡ˆäº†ã€‚éšç€ $k$ çš„å˜åŒ–ï¼Œå˜åŒ–çš„ DP å€¼ä¸ºæŸå‡ ä¸ªå¶å­èŠ‚ç‚¹ï¼Œè€ƒè™‘åŠ¨æ€ DPã€‚è®°</p><script type="math/tex; mode=display">g_u = \begin{cases} cnt_u - f_u & \text{ if } dep_u\%2=1\\ f_u & \text{ if } dep_u\%2=0  \end{cases}</script><p>è¿™æ ·è½¬ç§»å¼å­ä¼˜åŒ–ä¸ºä¸€ä¸ªå½¢å¼ï¼ŒåŠ¨æ€ DPï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ã€‚</p><h2 id="çº¿æ®µæ ‘ç»´æŠ¤æ ‘ä¸Šä¿¡æ¯"><a href="#çº¿æ®µæ ‘ç»´æŠ¤æ ‘ä¸Šä¿¡æ¯" class="headerlink" title="çº¿æ®µæ ‘ç»´æŠ¤æ ‘ä¸Šä¿¡æ¯"></a>çº¿æ®µæ ‘ç»´æŠ¤æ ‘ä¸Šä¿¡æ¯</h2><h3 id="ç»´æŠ¤ç›´å¾„"><a href="#ç»´æŠ¤ç›´å¾„" class="headerlink" title="ç»´æŠ¤ç›´å¾„"></a>ç»´æŠ¤ç›´å¾„</h3><h4 id="1-CEOI2019-Dynamic-Diameter"><a href="#1-CEOI2019-Dynamic-Diameter" class="headerlink" title="1.[CEOI2019] Dynamic Diameter"></a><a href="https://www.luogu.com.cn/problem/P6845">1.[CEOI2019] Dynamic Diameter</a></h4><p><strong>è´ªå¿ƒ</strong></p><p>å¹¶é›†çš„ç›´å¾„ç«¯ç‚¹ä¸€å®šåœ¨åŸå››ä¸ªç«¯ç‚¹ä¸­ï¼Œçº¿æ®µæ ‘ç»´æŠ¤å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ï¼Œ$O(1)$ æ±‚ lca å¯ä»¥ä¼˜åŒ–åˆ° $O(n\log n)$ã€‚</p><p>æ³¨æ„ï¼šè´ªå¿ƒåªæœ‰åœ¨è¾¹æƒéè´Ÿçš„æƒ…å†µä¸‹æ‰æ˜¯å¯¹çš„ã€‚</p><p><a href="https://www.luogu.com.cn/paste/i1ypk48w">code</a></p><p><strong>dfs åº</strong></p><p>ä¸€ä¸ªèŠ‚ç‚¹æ— è®ºè®¿é—®è¿˜æ˜¯å›æº¯éƒ½è®°å½•ä¸‹æ¥ï¼Œè¿™æ ·ä¼šå¾—åˆ°ä¸€ä¸ªé•¿ä¸º $2n-1$ åºåˆ—ï¼ˆ $rt$ å‡ºç°æ¬¡æ•°ä¸º$deg[rt]+1$ ï¼Œå…¶ä»–ç‚¹å‡ºç°çš„æ¬¡æ•°ä¸º $deg[u]$ ï¼‰ï¼Œå³ä¸ºæ ‘çš„ dfs åºã€‚</p><p>å®ƒæœ‰ä¸€ä¸ªå¾ˆå¥½çš„æ€§è´¨ï¼šå°†åŸèŠ‚ç‚¹è®°ä¸ºç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œåˆ™ $\min_{i=u}^{v} dep[i] = dep[lca(u,v)]$ ï¼Œè€ƒè™‘ dfs è¿‡ç¨‹ä¸éš¾ç†è§£ã€‚é‚£ä¹ˆ $dis(u,v)=dep[u]+dep[v]-2\min_{i=u}^{v} dep[i]$ã€‚</p><p>ç”¨çº¿æ®µæ ‘ç»´æŠ¤ç›´å¾„ $s$ï¼Œ$\min_{u}dep[u]$ï¼Œ$\max_{u}dep[u]$ï¼Œ$\max_{u}\{dep[u]-2\min_{i=l}^{u}dep[i]\}$ï¼Œ$\max_{u}\{dep[u]-2\min_{i=u}^{r}dep[i]\}$ã€‚</p><p>æ³¨æ„ï¼šè¯¥æ–¹æ³•ä»…é€‚ç”¨äºè¾¹æƒéè´Ÿï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åŒºé—´ä¸­ dep æœ€å°çš„ç‚¹ä¸º lcaã€‚</p><p><a href="https://www.luogu.com.cn/paste/nzwod7r0">code</a></p><h4 id="2-Tree-Generatorâ„¢"><a href="#2-Tree-Generatorâ„¢" class="headerlink" title="2.Tree Generatorâ„¢"></a><a href="https://www.luogu.com.cn/problem/CF1149C">2.Tree Generatorâ„¢</a></h4><p><strong>æ‹¬å·åºåˆ—</strong></p><p>æ„é€ ä¸€æ£µæ ‘çš„æ‹¬å·åºåˆ—ï¼šdfsï¼Œå‘ä¸‹å°±åŠ â€˜ï¼ˆâ€™ï¼Œå‘ä¸Šå°±åŠ â€˜ï¼‰â€™  ã€‚é•¿åº¦ä¸º $2*n-2$ ï¼Œå› ä¸ºæ¯æ¡è¾¹ä¼šè¢«è®¿é—®ä¸¤æ¬¡</p><ul><li><p><strong>æ€§è´¨ä¸€ï¼š</strong> ä¸€æ®µæ‹¬å·åºåˆ—å»æ‰å¯¹åº”çš„æ‹¬å·å¯¹åº”æ ‘çš„ä¸€æ¡é“¾ï¼ˆæ€è€ƒ dfs è¿‡ç¨‹ï¼‰ã€‚</p></li><li><p><strong>æ€§è´¨äºŒï¼š</strong> ä¸€æ®µæ‹¬å·åºåˆ—å»æ‰å¯¹åº”çš„æ‹¬å·æ‰€å¾—åºåˆ—çš„é•¿åº¦è®°ä¸ºæ ‘ä¸Šé“¾çš„é•¿åº¦ã€‚</p></li></ul><p>å»æ‰å¯¹åº”æ‹¬å·çš„åºåˆ—åªæœ‰ä¸‰ç§</p><ul><li><p>))))))â€¦</p></li><li><p>((((((â€¦</p></li><li><p>)))â€¦(((</p></li></ul><p>è€ƒè™‘ä¸€èˆ¬åŒ–ï¼Œå°†â€˜ï¼ˆâ€™è§†ä¸º 1ï¼Œ â€˜ï¼‰â€™è§†ä¸º -1 ï¼Œåˆ™è¯¥é“¾çš„é•¿åº¦ä¸º $\max_{i=l-1}^{r}\{v(i+1,r)-v(l,i)\}$ã€‚ç›´å¾„å³ä¸ºæœ€å¤§çš„é“¾é•¿ï¼Œç±»ä¼¼æœ€å¤§å­æ®µå’Œï¼Œç”¨çº¿æ®µæ ‘ç»´æŠ¤ã€‚</p><p><a href="https://www.luogu.com.cn/paste/69grhz2s">code</a></p><h3 id="ç»´æŠ¤æœ€å°è¿é€šå­æ ‘"><a href="#ç»´æŠ¤æœ€å°è¿é€šå­æ ‘" class="headerlink" title="ç»´æŠ¤æœ€å°è¿é€šå­æ ‘"></a>ç»´æŠ¤æœ€å°è¿é€šå­æ ‘</h3><p>ç»™å®š $n$ ä¸ªå…³é”®ç‚¹ï¼ŒåŠ¨æ€ç»´æŠ¤ $n$ ä¸ªå…³é”®ç‚¹æ‰€å½¢æˆçš„æœ€å°è¿é€šå­æ ‘å¤§å°ã€‚</p><p>å°†nä¸ªç‚¹æŒ‰dfnåºä»å°åˆ°å¤§æ’åºä¸º $0,2,â€¦,n-1$ ï¼Œåˆ™å­æ ‘å¤§å°ä¸º $\frac{1}{2}\sum_{i=0}^{n-1}dis(i,(i+1)\%n)$ã€‚</p><h4 id="1-SDOI2015-å¯»å®æ¸¸æˆ"><a href="#1-SDOI2015-å¯»å®æ¸¸æˆ" class="headerlink" title="1.[SDOI2015] å¯»å®æ¸¸æˆ"></a><a href="https://www.luogu.com.cn/problem/P3320">1.[SDOI2015] å¯»å®æ¸¸æˆ</a></h4><p><strong>çº¿æ®µæ ‘</strong></p><p>ä¸€èˆ¬ç”¨äºå…³é”®ç‚¹</p><script type="math/tex; mode=display">\frac{1}{2}\sum_{i=0}^{n-1}dis(i,(i+1)\%n)</script><script type="math/tex; mode=display">=\sum_{i=0}^{n-1}dep[i]-\sum_{i=0}^{n-1}dep[lca(i,(i+1)\%n)]</script><p>è€ƒè™‘å¦‚ä½•åˆå¹¶ï¼Œæ‹†ä¸€ä¸‹ $\%$</p><script type="math/tex; mode=display">\sum_{i=l}^{r}dep[i]-\sum_{i=l}^{r-1}dep[lca(i,(i+1)]-dep[lca(l,r)]</script><script type="math/tex; mode=display">\sum_{i=l}^{mid}dep[i]+\sum_{i=mid+1}^{r}dep[i]-\sum_{i=l}^{mid-1}dep[lca(i,i+1)]-dep[lca(mid,mid+1)]-\sum_{i=mid+1}^{r-1}dep[lca(i,i+1)]-dep[lca(l,r)]</script><script type="math/tex; mode=display">=ans[lc]+ans[rc]+dep[lca(l,mid-1)]+dep[lca(mid+1,r)]-dep[lca(l,r)]-dep[lca(mid,mid+1)]</script><p>æœ‰ç‚¹éº»çƒ¦ï¼Œè€ƒè™‘ä¸ç»´æŠ¤ $dep[lca(l,r)]$</p><script type="math/tex; mode=display">\sum_{i=l}^{r}dep[i]-\sum_{i=l}^{r-1}dep[lca(i,i+1)]</script><script type="math/tex; mode=display">=ans[lc]+ans[rc]-dep[lca(mid,mid+1)]</script><p>ç®€å•å¤šäº†ï¼Œæœ€åå‡å»å³å¯ã€‚æ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ ï¼Œ $O(1)$ æ±‚ lca å¯åšåˆ° $O(n\log n)$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/dd8wtgon">code</a></p><p><strong>set</strong></p><p>éå¸¸ç®€å•çš„åšæ³•ï¼Œç›´æ¥ç»´æŠ¤æœ€å¼€å§‹çš„å¼å­ï¼Œè®° $ans$ ä¸ºæœ€ç»ˆç­”æ¡ˆã€‚</p><p>æ¯æ¬¡åŠ å…¥ $u$ ï¼Œåˆ™ $ans+=dis(pre(u),u)+dis(u,nxt(u))-dis(pre(u),nxt(u))$ã€‚</p><p>æ¯æ¬¡å‡å» $u$ ï¼Œåˆ™ $ans+=dis(pre(u),,nxt(u))-dis(pre(u),u)-dis(u,nxt(u))$ã€‚</p><p>éœ€è¦åŠ å…¥åˆ é™¤ä¸€ä¸ªæ•°ï¼Œæ±‚å‰é©±åç»§ï¼Œç”¨å¹³è¡¡æ ‘ç»´æŠ¤å³å¯ï¼ˆå¯ä»¥ç”¨ setï¼‰ã€‚</p><p><a href="https://www.luogu.com.cn/paste/rdtcb4fq">code</a></p><h4 id="2-ZJOI2019-è¯­è¨€"><a href="#2-ZJOI2019-è¯­è¨€" class="headerlink" title="2.[ZJOI2019] è¯­è¨€"></a><a href="https://www.luogu.com.cn/problem/P5327">2.[ZJOI2019] è¯­è¨€</a></h4><p>å¯¹äºä¸¤å…ƒå…³ç³»çš„ç»Ÿè®¡ï¼Œå…ˆå›ºå®šä¸€ç‚¹ $u$ï¼Œè€ƒè™‘å¦‚ä½•æ±‚å‡º $(u,x)/(x,u)$ çš„æ•°é‡ã€‚</p><p>å°†æ‰€æœ‰ç»è¿‡ $u$ çš„è·¯å¾„èµ‹å€¼ä¸º 1 ï¼Œç»Ÿè®¡ 1 çš„ä¸ªæ•°ï¼Œé™¤ä»¥äºŒå³ä¸ºç­”æ¡ˆã€‚</p><p>æ ‘ä¸Šçš„è‹¥å¹²æ¡é“¾ï¼Œç»è¿‡åŒä¸€ä¸ªç‚¹ï¼Œé‚£ä¹ˆå°±å½¢æˆäº†ä¸€ä¸ªè¿é€šå­æ ‘ã€‚</p><p>å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥ç”¨çº¿æ®µæ ‘æ¥ç»´æŠ¤æœ€å°è¿é€šå­æ ‘ã€‚</p><p>å·®åˆ†ï¼Œç„¶åçº¿æ®µæ ‘åˆå¹¶å³å¯ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log^2n)$ ï¼ŒåŒä¸Šå¯ä»¥ä¼˜åŒ–ä¸º $O(n\log n)$ã€‚</p><p><a href="https://www.luogu.com.cn/paste/9w7w1rv6">code</a></p><h2 id="çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"><a href="#çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾" class="headerlink" title="çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾"></a>çº¿æ®µæ ‘ä¼˜åŒ–å»ºå›¾</h2><p>ä¸€èˆ¬ä¼˜åŒ–ä¸‰ç§è¿è¾¹</p><ul><li><p>$x \to [l,r]$</p></li><li><p>$[l,r] \to x$</p></li><li><p>$[l,r] \to [lâ€™,râ€™]$</p></li></ul><p>ä¸»è¦æ€æƒ³æ˜¯å»ºè™šç‚¹ä»£è¡¨ä¸€ä¸ªåŒºé—´ã€‚</p><h4 id="1-Legacy"><a href="#1-Legacy" class="headerlink" title="1.Legacy"></a><a href="https://www.luogu.com.cn/problem/CF786B">1.Legacy</a></h4><p>å»ºä¸€æ£µæ ¹å‘çº¿æ®µæ ‘ï¼Œä¸€æ£µå¶å‘çº¿æ®µæ ‘ã€‚</p><p>æˆ‘çš„ dij æ¿å­æ€ä¹ˆæ˜¯é”™çš„ï¼Ÿï¼Ÿï¼Ÿ</p><p><a href="https://codeforces.com/contest/786/submission/296784211">code</a></p><h4 id="2-ã€ŒJOISC-2020-Day4ã€æ²»ç–—è®¡åˆ’"><a href="#2-ã€ŒJOISC-2020-Day4ã€æ²»ç–—è®¡åˆ’" class="headerlink" title="2.ã€ŒJOISC 2020 Day4ã€æ²»ç–—è®¡åˆ’"></a><a href="https://loj.ac/p/3282">2.ã€ŒJOISC 2020 Day4ã€æ²»ç–—è®¡åˆ’</a></h4><p>$O(m^2)$ æ˜¯ç®€å•çš„ã€‚è€ƒè™‘ä¼˜åŒ–ï¼Œå¥—è·¯åœ°æƒ³æ•°æ®ç»“æ„ä¼˜åŒ–ã€‚æ‹†ä¸€ä¸‹ç»å¯¹å€¼ï¼Œå¦‚æœ $i \to j$ï¼Œé‚£ä¹ˆ</p><ul><li><p>$t_j&lt;t_i: r_i-t_i+1 \ge l_j-t_j$.</p></li><li><p>$t_j&gt;t_i: r_i+t_i+1 \ge l_j+t_j$.</p></li></ul><p>ç”±äºè¿å‘æŸä¸ªç‚¹çš„æƒå€¼éƒ½ç›¸åŒï¼Œæ‰€ä»¥æ¯ä¸ªç‚¹åœ¨è¢«æšä¸¾åˆ°æ—¶å…¶ $dis$ å°±å·²ç»ç¡®å®šã€‚è€ƒè™‘å¿«é€Ÿæ‰¾å‡ºé‚»ç‚¹ï¼Œè¿™æ ·å‡æ‘Šæ˜¯å¯¹çš„ã€‚å…ˆæŒ‰ $t$ æ’åºï¼Œç„¶åçº¿æ®µæ ‘ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\log n)$ã€‚</p><h2 id="å•ä¾§é€’å½’çº¿æ®µæ ‘"><a href="#å•ä¾§é€’å½’çº¿æ®µæ ‘" class="headerlink" title="å•ä¾§é€’å½’çº¿æ®µæ ‘"></a>å•ä¾§é€’å½’çº¿æ®µæ ‘</h2><p><a href="/notes/å•ä¾§é€’å½’çº¿æ®µæ ‘">è¯¦è§</a></p><h2 id="çº¿æ®µæ ‘åˆ†æ²»"><a href="#çº¿æ®µæ ‘åˆ†æ²»" class="headerlink" title="çº¿æ®µæ ‘åˆ†æ²»"></a>çº¿æ®µæ ‘åˆ†æ²»</h2><p>ä¸å¦‚å«åŸºäºæ—¶é—´çš„åˆ†æ²»ã€‚</p><h4 id="1-äºŒåˆ†å›¾-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†æ²»"><a href="#1-äºŒåˆ†å›¾-ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†æ²»" class="headerlink" title="1.äºŒåˆ†å›¾ /ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†æ²»"></a><a href="https://www.luogu.com.cn/problem/P5787">1.äºŒåˆ†å›¾ /ã€æ¨¡æ¿ã€‘çº¿æ®µæ ‘åˆ†æ²»</a></h4><h4 id="2-Painting-Edges"><a href="#2-Painting-Edges" class="headerlink" title="2.Painting Edges"></a><a href="https://www.luogu.com.cn/problem/CF576E">2.Painting Edges</a></h4><p>ä¸€æ£µæ ‘ï¼Œæ¯æ¡è¾¹æœ‰é¢œè‰²ï¼ˆå¼€å§‹æ²¡æœ‰ï¼‰ï¼Œå½“åŠ å…¥ä»»æ„ä¸€ç§é¢œè‰²çš„è¾¹æ—¶ï¼Œå›¾éƒ½ä¸ºäºŒåˆ†å›¾ï¼Œåˆ™æ­¤æ—¶åˆæ³•ã€‚æ¯æ¬¡æ“ä½œæ”¹å˜æŸæ¡è¾¹çš„é¢œè‰²ï¼Œåªæœ‰å½“æ”¹å˜ååˆæ³•æ‰ä¼šè¿›è¡Œï¼Œåˆ¤æ–­æ¯æ¬¡æ“ä½œæ˜¯å¦ä¼šè¿›è¡Œã€‚</p><p>é¢œè‰²å¾ˆå°‘ï¼Œè€ƒè™‘å¯¹æ¯ä¸ªé¢œè‰²å¼€ä¸€ä¸ªå¹¶æŸ¥é›†ç»´æŠ¤ã€‚</p><p>æˆ‘ä»¬å¹¶ä¸èƒ½å°†æ“ä½œç¦»çº¿ä¸‹æ¥ï¼Œä½†æ¯ä¸ªæ—¶é—´åªæœ‰ä¸€æ¬¡æ“ä½œï¼Œå¯ä»¥æŒ‰æ—¶é—´å…ˆåçº¿æ®µæ ‘åˆ†æ²»ï¼Œå…ˆå°†æ“ä½œæŒ‚åœ¨å¯¹åº”çš„å¶å­èŠ‚ç‚¹ä¸Šï¼Œé€’å½’åˆ°è¯¥ç‚¹æ—¶åˆ¤æ–­æ˜¯å¦åˆæ³•ï¼Œå¹¶å°†å¯¹åº”åŒºé—´è¿›è¡Œè¦†ç›–ï¼ˆåŸé¢œè‰²æˆ–æ›´æ”¹çš„é¢œè‰²ï¼‰ã€‚</p><p>ç”±äºæ¯æ¬¡æ“ä½œåå›¾ä¸€å®šåˆæ³•ï¼ˆä¸ç„¶ä¸ä¼šæ“ä½œï¼‰ï¼Œæ‰€ä»¥åœ¨å¶å­èŠ‚ç‚¹åªéœ€åˆ¤æ–­åŠ å…¥æŒ‚ç€çš„è¾¹åæ˜¯å¦åˆæ³•å³å¯ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(m\log q\log n+nk)$ã€‚</p><p>æ³¨æ„ï¼šä¸è¦æ‰‹å†™æ ˆï¼Œå› ä¸ºå®é™…åŠ å…¥å †çš„å…ƒç´ ä¸ªæ•°ä¸º $2(æ‹†åçš„æ€»è¾¹æ•°)$ è€Œæ‰‹å†™æ ˆè¦å¼€åˆ° $2k(æ‹†åçš„æ€»è¾¹æ•°)$ ç©ºé—´ä¼šç‚¸ã€‚</p><p><a href="https://www.luogu.com.cn/paste/ky04ivij">code &amp; data_maker</a></p><h2 id="çº¿æ®µæ ‘ç»´æŠ¤å†å²å€¼-amp-segment-tree-beats"><a href="#çº¿æ®µæ ‘ç»´æŠ¤å†å²å€¼-amp-segment-tree-beats" class="headerlink" title="çº¿æ®µæ ‘ç»´æŠ¤å†å²å€¼ &amp; segment tree beats"></a>çº¿æ®µæ ‘ç»´æŠ¤å†å²å€¼ &amp; segment tree beats</h2><p><a href="/notes/seg_beats">è¯¦è§</a></p><h2 id="KTT"><a href="#KTT" class="headerlink" title="KTT"></a>KTT</h2><p><a href="/notes/KTT">è¯¦è§</a></p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://www.luogu.com/article/xjsrcztd">çº¿æ®µæ ‘ç›¸å…³æŠ€å·§çš„å°å°æ€»ç»“ï¼ˆä¿®è®¢ç‰ˆï¼‰</a></p><p><a href="https://www.cnblogs.com/alex-wei/p/18356369/SegmentTreePart1">çº¿æ®µæ ‘è¿›é˜¶ Part 1</a></p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>hash</title>
      <link href="/notes/hash/"/>
      <url>/notes/hash/</url>
      
        <content type="html"><![CDATA[<p>æœ‰ä¸¤ç§æ–¹å¼ï¼Œä¸ªäººä¹ æƒ¯ç”¨ $h(n) = \sum_{i=1}^{n} s_i \times base^i$ã€‚å¸¸ç”¨ $base = 139,MOD = 1011451423$ã€‚</p><p>æœ‰ $h(l,r) = (h(r) - h(l-1)) \times base^{n-r}$ã€‚</p><p>å¯¹äºåä¸²ï¼Œæœ‰ $h(n) = \sum_{i=1}^{n} s_i \times base^{n-i+1},h(l,r) = (h(r) - h(l)) \times base^{l-1}$ã€‚</p><p>å¯ä»¥ç”¨æ ‘çŠ¶æ•°ç»„æˆ–çº¿æ®µæ ‘åŠ¨æ€ç»´æŠ¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>KMP</title>
      <link href="/notes/KMP/"/>
      <url>/notes/KMP/</url>
      
        <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¯¹äºç»Ÿè®¡ $S$ åœ¨ $T$ ä¸­çš„å‡ºç°æ¬¡æ•°çš„é—®é¢˜ã€‚ç§° $S$ ä¸ºæ¨¡æ¿ä¸²ï¼Œ$T$ ä¸ºæ–‡æœ¬ä¸²ã€‚KMP ç®—æ³•å¯ä»¥è§£å†³å•æ¨¡æ¿ä¸²åŒ¹é…é—®é¢˜ã€‚</p><p>å…ˆå¯¹æ¨¡æ¿ä¸²é¢„å¤„ç† nxt æ•°ç»„ï¼Œä»£è¡¨ $[1,i]$ çš„æœ€é•¿ç›¸ç­‰çœŸå‰åç¼€çš„é•¿åº¦ã€‚ä¹Ÿå¯ä»¥ç†è§£ä¸ºåœ¨æ¨¡æ¿ä¸²ä¸Šå»ºç«‹è‡ªåŠ¨æœºã€‚</p><p>ç„¶åéå†æ–‡æœ¬ä¸²è¿›è¡ŒåŒ¹é…ï¼Œæ—¶é—´å¤æ‚åº¦å‡æ‘Šä¸º $O(n+m)$ã€‚</p><p><a href="https://www.luogu.com.cn/problem/P3375">ã€æ¨¡æ¿ã€‘KMP</a> <a href="https://www.luogu.com.cn/record/190450329">code</a></p><h2 id="åº”ç”¨"><a href="#åº”ç”¨" class="headerlink" title="åº”ç”¨"></a>åº”ç”¨</h2><h4 id="æœ€çŸ­å¾ªç¯èŠ‚"><a href="#æœ€çŸ­å¾ªç¯èŠ‚" class="headerlink" title="æœ€çŸ­å¾ªç¯èŠ‚"></a>æœ€çŸ­å¾ªç¯èŠ‚</h4><p>æœ€çŸ­å¾ªç¯èŠ‚å­˜åœ¨å½“ä¸”ä»…å½“ $(n-nxt_n) | n$ï¼Œæ­¤æ—¶æœ€çŸ­å¾ªç¯èŠ‚é•¿åº¦ä¸º $n-nxt_n$ã€‚</p><h4 id="1-Prefix-Function-Queries"><a href="#1-Prefix-Function-Queries" class="headerlink" title="1.Prefix Function Queries"></a><a href="https://www.luogu.com.cn/problem/CF1721E">1.Prefix Function Queries</a></h4><p>å¯ä»¥æ¯æ¬¡åŠ å…¥ $\text{t}$ åä» $\text{t}$ å¼€å§‹è·‘ KMPï¼Œä½†è¿™æ ·æ—¶é—´å¤æ‚åº¦ä¸å¯¹ï¼ˆå› ä¸ºæ—¶é—´å¤æ‚åº¦æ˜¯å‡æ‘Šçš„ï¼‰ã€‚</p><p>å¯ä»¥å¯¹äº $\text{s}$ é¢„å¤„ç†å‡ºä» $i$ å¼€å§‹ï¼Œä¸ $\text{c}$ åŒ¹é…è·³ fail æœ€ç»ˆè·³åˆ°çš„èŠ‚ç‚¹ï¼Œè¿™æ ·å½“ $p \le n$ æ—¶å°±å¯ä»¥ $O(1)$ è½¬ç§»äº†ã€‚</p><p>æ—¶é—´å¤æ‚åº¦ $O(SZ|\text{s}| + \sum |\text{t}|)$ã€‚</p><p>ç”¨å¯æŒä¹…åŒ–çº¿æ®µæ ‘å¯ä»¥ä¼˜åŒ–è‡³ $O(|\text{s}| \log SZ)$</p><h4 id="2-CERC2019-ABB"><a href="#2-CERC2019-ABB" class="headerlink" title="2.[CERC2019] ABB"></a><a href="https://www.luogu.com.cn/problem/P9606">2.[CERC2019] ABB</a></h4><p>ä¸€ä¸ªä¸²æœ€å°‘åŠ å…¥ $n-æœ€é•¿å›æ–‡åç¼€$ ä¸ªå­—ç¬¦å½¢æˆä¸€ä¸ªå›æ–‡ä¸²ã€‚</p><p>æ±‚æœ€é•¿å›æ–‡åç¼€å¯ä»¥æ±‚ $\overline{s} + â€œ!â€ + s$ çš„ $border$</p><h4 id="3-POI2005-SZA-Template"><a href="#3-POI2005-SZA-Template" class="headerlink" title="3.[POI2005] SZA-Template"></a><a href="https://www.luogu.com.cn/problem/P3426">3.[POI2005] SZA-Template</a></h4><p>å°ç« ä¸€å®šæ˜¯åŸä¸²çš„ä¸€æ®µå‰ç¼€ã€‚</p><p>è€ƒè™‘ DPï¼Œè®° $f_i$ ä¸º $[1,i]$ éœ€è¦çš„æœ€çŸ­é•¿åº¦ã€‚</p><p>å‘ç° $f_i$ åªæœ‰ $i$ å’Œ $f_{nxt_i}$ ä¸¤ç§å–å€¼ã€‚æœ€èµ·ç è¦èƒ½è¦†ç›– $[1,nxt_i]$ï¼Œå†å¤šäº†å°±ä¸èƒ½è¦†ç›– $[i-nxt_i+1,i]$ äº†ã€‚</p><p>åªæœ‰å½“ $[i-nxt_i,i]$ ä¸­å­˜åœ¨ $j$ ä½¿å¾— $f_j = f_{nxt_i}$ æ—¶ï¼Œ$f_i$ æ‰å– $f_{nxt_i}$ã€‚ç”¨ä¸ªæ¡¶è®°å½•æœ€å¤§ä½ç½®ã€‚</p><h4 id="4-ã€æ¨¡æ¿ã€‘å¤±é…æ ‘"><a href="#4-ã€æ¨¡æ¿ã€‘å¤±é…æ ‘" class="headerlink" title="4.ã€æ¨¡æ¿ã€‘å¤±é…æ ‘"></a><a href="https://www.luogu.com.cn/problem/P5829">4.ã€æ¨¡æ¿ã€‘å¤±é…æ ‘</a></h4><p>å»ºå‡º $\text{fail}$ æ ‘ï¼Œæ‰¾ä¸¤ä¸ªç‚¹çˆ¶èŠ‚ç‚¹çš„ $\text{LCA}$ã€‚</p><h4 id="5-NOI2014-åŠ¨ç‰©å›­"><a href="#5-NOI2014-åŠ¨ç‰©å›­" class="headerlink" title="5.[NOI2014] åŠ¨ç‰©å›­"></a><a href="https://www.luogu.com.cn/problem/P2375">5.[NOI2014] åŠ¨ç‰©å›­</a></h4><p>å»ºå‡ºå¤±é…æ ‘ï¼Œç»´æŠ¤ $f_{u}$ è¡¨ç¤º $u$ çš„ç­”æ¡ˆï¼Œæ¯æ¬¡å¯¹å­èŠ‚ç‚¹å– $\min$ å†å¾€ä¸Šè·³å³å¯ã€‚æœ€åç­”æ¡ˆä¸ºæ·±åº¦ã€‚</p><p>ä¹Ÿå¯ä»¥ç»´æŠ¤ä¸€ä¸ªæ ˆï¼Œä¸­é—´ç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆï¼Œä¸ªæ•°å³ä¸ºæŒ‡é’ˆçš„ä½ç½®ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Burnside</title>
      <link href="/notes/Burnside/"/>
      <url>/notes/Burnside/</url>
      
        <content type="html"><![CDATA[<p>åªæ˜¯ä¸€äº›å®šä¹‰ï¼Œå…·ä½“ä¾‹å­å»çœ‹ç»„åˆæ•°å­¦ã€‚</p><h2 id="ç½®æ¢"><a href="#ç½®æ¢" class="headerlink" title="ç½®æ¢"></a>ç½®æ¢</h2><p>å¯¹äºæ’åˆ— $X$ï¼Œå°†å‡½æ•° $f:X \to X$ ç§°ä¸ºç½®æ¢ã€‚ä¹Ÿå¯ä»¥è®°ä½œ</p><script type="math/tex; mode=display">\begin{pmatrix}1 & 2 & ... & n \\i_1 & i_2 & ... & i_n\end{pmatrix}</script><p>å®šä¹‰ç½®æ¢çš„åˆæˆ $f \circ g$ï¼Œæœ‰ $(f \circ g)(k) = f(g(k))$ã€‚</p><p>å®šä¹‰ç½®æ¢ç¾¤ $G$ æ»¡è¶³</p><ul><li><p>$\forall f,g \in G, f \circ g \in G$ã€‚</p></li><li><p>å­˜åœ¨å•ä½å…ƒã€‚</p></li><li><p>$\forall f \in G, f^{-1} \in G$ã€‚</p></li></ul><h2 id="ç€è‰²"><a href="#ç€è‰²" class="headerlink" title="ç€è‰²"></a>ç€è‰²</h2><p>è®° $C$ ä¸ºé¢œè‰²é›†åˆï¼Œå°†å‡½æ•° $c:X \to C$ ç§°ä¸ºç€è‰²ã€‚</p><p>å®šä¹‰é¢œè‰²çš„ç½®æ¢ $f*c$ ï¼Œæœ‰ $(f*c)(i_k)=c(k)$ã€‚</p><p>$c_1$ ä¸ $c_2$ ç­‰ä»·å½“ä¸”ä»…å½“ $\exists f \in G, f*c = c$ï¼Œè®°ä½œ $c_1 \sim c_2$ã€‚</p><p>å®šä¹‰ç€è‰²é›† $\mathcal{C}$ æ»¡è¶³</p><ul><li>$\forall f \in G,c \in \mathcal{C}, f*c \in \mathcal{C}$ã€‚</li></ul><h2 id="Burnside-å®šç†"><a href="#Burnside-å®šç†" class="headerlink" title="Burnside å®šç†"></a>Burnside å®šç†</h2><p>å®šä¹‰ $G(c) = \{f|f \in G,f*c=c\},\mathcal{C}(f) = \{c|c \in \mathcal{C},f*c=c\}$ ä¹Ÿç§°ä¸ºä¸åŠ¨ç‚¹ã€‚</p><blockquote><p>ä¸ $c$ ç­‰ä»·çš„ç€è‰²ä¸ªæ•° = $\frac{|G|}{|G(c)|}$ã€‚</p></blockquote><p><strong>è¯æ˜</strong></p><p>$\forall f \in G,g \in G(c)$ æœ‰ $(f \circ g)*c = f*(g*c) = f*c$ã€‚</p><p>è€Œæ¯ä¸ª $f \circ g$ æ˜¯ä¸åŒçš„ï¼Œå› æ­¤å¯¹ $c$ ä½œç”¨ä¸ $f$ ç›¸åŒçš„ç½®æ¢ä¸ªæ•°ä¸º $|G(c)|$ï¼Œæ€»ç½®æ¢ä¸ªæ•°ä¸º $|G|$ï¼Œæ‰€ä»¥ä¸ $c$ ç­‰ä»·çš„ä¸åŒçš„ç€è‰²æœ‰ $\frac{|G|}{|G(c)|}$ ç§ã€‚</p><blockquote><p>Burnside å®šç†ï¼š$éç­‰ä»·ç€è‰²æ•° = \frac{1}{|G|} \sum_{f \in G} |\mathcal{f}|$</p><p>ç”¨äººè¯å°†å°±æ˜¯ï¼Œæœ¬è´¨ä¸åŒçš„ç€è‰²ä¸ªæ•°ä¸ºæ‰€æœ‰ç½®æ¢ä¸åŠ¨ç‚¹ä¸ªæ•°çš„å¹³å‡å€¼ã€‚</p></blockquote><p><strong>è¯æ˜</strong></p><script type="math/tex; mode=display">\begin{align}\sum_{f \in G} |\mathcal{C}(f)| &= \sum_{c \in \mathcal{c}} |G(c)| \\\sum_{f \in G} |\mathcal{C}(f)| &= \sum_{c \in \mathcal{c}} \frac{|G|}{ä¸ c ç­‰ä»·çš„ç€è‰²çš„ä¸ªæ•°} \\\sum_{f \in G} |\mathcal{C}(f)| &= |G|(éç­‰ä»·ç€è‰²æ•°) \\(éç­‰ä»·ç€è‰²æ•°) &= \frac{1}{|G|} \sum_{f \in G} |\mathcal{C}(f)|\end{align}</script><h2 id="Polya-å®šç†"><a href="#Polya-å®šç†" class="headerlink" title="Polya å®šç†"></a>Polya å®šç†</h2><p>æµ…æµ…å†™ä¸€ä¸‹ã€‚</p><p>ç½®æ¢å¯ä»¥è¢«å‡ ä¸ªå¾ªç¯çš„åˆå¹¶ä»£æ›¿ã€‚ä¾‹</p><script type="math/tex; mode=display">\begin{pmatrix}1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 \\4 & 9 & 1 & 7 & 6 & 5 & 3 & 8 & 2\end{pmatrix} = [1 \ 4 \ 7 \ 3] \circ [2 \ 9] \circ [5 \ 6] \circ [8]</script><p>è®¡ç®—ç€è‰²æ–¹æ¡ˆæ•°æ—¶ï¼Œæˆ‘ä»¬åªå…³å¿ƒå¤§å°ä¸€å®šçš„å¾ªç¯æœ‰å¤šå°‘ä¸ªï¼Œå› æ­¤ä¸€ä¸ªç½®æ¢ç¾¤å¯ä»¥è¢«ä¸€ä¸ªç”Ÿæˆå‡½æ•°ä»£æ›¿ã€‚</p><p>è¯¥æ–¹æ³•çš„ä¼˜åŠ¿åœ¨äºå¯ä»¥é™å®šé¢œè‰²çš„ä¸ªæ•°ã€‚</p><h2 id="ä¹ é¢˜"><a href="#ä¹ é¢˜" class="headerlink" title="ä¹ é¢˜"></a>ä¹ é¢˜</h2><h4 id="1-ã€æ¨¡æ¿ã€‘Polya-å®šç†"><a href="#1-ã€æ¨¡æ¿ã€‘Polya-å®šç†" class="headerlink" title="1.ã€æ¨¡æ¿ã€‘Polya å®šç†"></a><a href="https://www.luogu.com.cn/problem/P4980">1.ã€æ¨¡æ¿ã€‘Polya å®šç†</a></h4><p>æœ‰ $n$ ç§ç½®æ¢ï¼Œå³æ—‹è½¬ $[1,n]$ æ¬¡ï¼ˆè¿™é‡Œå°† $0$ å½’ä¸º $n$ æ–¹ä¾¿è®¡ç®—ï¼‰ã€‚</p><p>å¯¹äºæ—‹è½¬ $k$ æ¬¡çš„ï¼Œå…¶ä¸åŠ¨ç‚¹ä¸ªæ•°ä¸º $n^{\gcd(n,k)}$ã€‚æ‰€ä»¥ç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">\begin{align}\frac{1}{n} \sum_{k=1}^{n} n^{\gcd(n,k)} &= \frac{1}{n} \sum_{d|n} n^d \sum_{k=1}^{n} [\gcd(n,k)=d] \\&= \sum_{d|n} n^d \varphi(\frac{n}{d})\end{align}</script><p>å•ç‚¹æ±‚ $\varphi$ï¼Œæ—¶é—´å¤æ‚åº¦ $O(n\sqrt{n}\log n)$ï¼ˆå¯ä»¥é€šè¿‡é¢„å¤„ç†å°† $\log n$ å»æ‰ï¼‰ã€‚</p><h4 id="2-JSOI2012-çˆ±ä¹‹é¡¹é“¾"><a href="#2-JSOI2012-çˆ±ä¹‹é¡¹é“¾" class="headerlink" title="2.[JSOI2012] çˆ±ä¹‹é¡¹é“¾"></a><a href="https://www.luogu.com.cn/problem/P5233">2.[JSOI2012] çˆ±ä¹‹é¡¹é“¾</a></h4><p><del>æ¬é¢˜äººçš„ id æç¤ºäº†æ­¤é¢˜çš„åšæ³•ã€‚</del></p><p>æ±‚ä¸€ä¸ªæˆ’æŒ‡çš„æ–¹æ¡ˆæ•°åŒä¸Šï¼Œè®°æ–¹æ¡ˆæ•°ä¸º $k$ã€‚è€ƒè™‘å®¹æ–¥ï¼Œç­”æ¡ˆä¸º</p><script type="math/tex; mode=display">\begin{align}\sum_{i=0}^{n-2} (-1)^{i} k(k-1)^{n-1-i} &= (-1)^{n-1} k \sum_{i=1}^{n-1} (1-k)^{i} \\&= (-1)^{n-1} k \frac{(1-k)^{n}-(1-k)}{-k} \\&= (k-1)^{n} + (-1)^{n} (k-1)\end{align}</script><p>$n=1$ è¦ç‰¹åˆ¤ï¼Ÿ</p><h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p>ç»„åˆæ•°å­¦ï¼ˆç¬¬äº”ç‰ˆï¼‰</p>]]></content>
      
      
      <categories>
          
          <category> notes </category>
          
      </categories>
      
      
    </entry>
    
    
  
  
</search>
